{
  "{\"filename\":\"/Users/dtr/gooee/REACTOR/tests/propagation.test.js\",\"env\":{},\"retainLines\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"presets\":[],\"plugins\":[[[],null]],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"minified\":false,\"sourceRoot\":\"/Users/dtr/gooee/REACTOR/tests\",\"babelrc\":true,\"sourceType\":\"module\",\"moduleIds\":false,\"passPerPreset\":false}:6.14.0": {
    "metadata": {
      "usedHelpers": [
        "asyncToGenerator"
      ],
      "marked": [],
      "modules": {
        "imports": [],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      }
    },
    "options": {
      "filename": "/Users/dtr/gooee/REACTOR/tests/propagation.test.js",
      "filenameRelative": "/Users/dtr/gooee/REACTOR/tests/propagation.test.js",
      "env": {},
      "retainLines": false,
      "highlightCode": true,
      "suppressDeprecationMessages": false,
      "presets": [],
      "plugins": [
        [
          [],
          null
        ]
      ],
      "ignore": [],
      "code": true,
      "metadata": true,
      "ast": false,
      "comments": true,
      "compact": "auto",
      "minified": false,
      "sourceMaps": "both",
      "sourceMapTarget": "propagation.test.js",
      "sourceFileName": "propagation.test.js",
      "sourceRoot": "/Users/dtr/gooee/REACTOR/tests",
      "babelrc": false,
      "sourceType": "module",
      "moduleRoot": "/Users/dtr/gooee/REACTOR/tests",
      "moduleIds": false,
      "passPerPreset": false,
      "basename": "propagation.test"
    },
    "ignored": false,
    "code": "'use strict';\n\nlet createProject = (() => {\n    var _ref = _asyncToGenerator(function* () {\n        let project = yield operator.project().create({\n            'name': `${ PREFIX } Project`\n        });\n\n        log('Project', 'created', project);\n        return operator.project(project.id);\n    });\n\n    return function createProject() {\n        return _ref.apply(this, arguments);\n    };\n})();\n\nlet createApp = (() => {\n    var _ref2 = _asyncToGenerator(function* (project) {\n        let app = yield project.application().create({\n            'name': `${ PREFIX } Application`,\n            'socialNetworks': {}\n        });\n\n        log('Application', 'created', app);\n        return new EVT.App(app.appApiKey);\n    });\n\n    return function createApp(_x) {\n        return _ref2.apply(this, arguments);\n    };\n})();\n\nlet fetchProject = (() => {\n    var _ref3 = _asyncToGenerator(function* (settings) {\n        let project = yield operator.project(settings.projectId).read();\n\n        log('Project', 'fetched', project);\n        return operator.project(settings.projectId);\n    });\n\n    return function fetchProject(_x2) {\n        return _ref3.apply(this, arguments);\n    };\n})();\n\nlet fetchApp = (() => {\n    var _ref4 = _asyncToGenerator(function* (settings) {\n        let app = yield operator.project(settings.projectId).application(settings.applicationId).read();\n\n        log('Application', 'fetched', app);\n        return new EVT.App(app.appApiKey);\n    });\n\n    return function fetchApp(_x3) {\n        return _ref4.apply(this, arguments);\n    };\n})();\n\nlet createUser = (() => {\n    var _ref5 = _asyncToGenerator(function* (app) {\n        let user = yield app.appUser().create({ anonymous: true });\n        log('User', 'created', user);\n        return new EVT.User(user, app);\n    });\n\n    return function createUser(_x4) {\n        return _ref5.apply(this, arguments);\n    };\n})();\n\nlet createCollection = (() => {\n    var _ref6 = _asyncToGenerator(function* (user) {\n        let collection = yield user.collection().create({\n            'name': `${ PREFIX } Collection`\n        });\n\n        log('Collection', 'created', collection);\n        return collection;\n    });\n\n    return function createCollection(_x5) {\n        return _ref6.apply(this, arguments);\n    };\n})();\n\nlet createThng = (() => {\n    var _ref7 = _asyncToGenerator(function* (user, rules, properties) {\n        let thng = yield user.thng().create({\n            'name': `${ PREFIX } Thng`,\n            'properties': _.assign(properties, rules)\n        });\n\n        log('Thng', 'created', thng);\n        return user.thng(thng.id);\n    });\n\n    return function createThng(_x6, _x7, _x8) {\n        return _ref7.apply(this, arguments);\n    };\n})();\n\nlet createActionTypes = (() => {\n    var _ref8 = _asyncToGenerator(function* (names) {\n        let actionTypes = Promise.all(names.map((() => {\n            var _ref9 = _asyncToGenerator(function* (name) {\n                try {\n                    let actionType = yield operator.actionType().create({ name });\n\n                    log('ActionType', 'created', actionType);\n                } catch (error) {\n                    if (error.status !== 409) console.error(JSON.stringify(error));\n                }\n            });\n\n            return function (_x10) {\n                return _ref9.apply(this, arguments);\n            };\n        })()));\n    });\n\n    return function createActionTypes(_x9) {\n        return _ref8.apply(this, arguments);\n    };\n})();\n\nlet readReactorStatus = (() => {\n    var _ref10 = _asyncToGenerator(function* (appData) {\n        console.log(`Getting the REACTOR status for App '${ appData.name }' with ID '${ appData.id }'...`);\n\n        let status = yield request.get({\n            url: `https://api.evrythng.com/${ appData.resource.path }/reactorScript/status`,\n            headers: {\n                'Accept': 'application/json',\n                'Authorization': settings.operatorKey\n            }\n        });\n\n        console.log(`REACTOR status: ${ status }`);\n        return status;\n    });\n\n    return function readReactorStatus(_x11) {\n        return _ref10.apply(this, arguments);\n    };\n})();\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { return step(\"next\", value); }, function (err) { return step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nlet _ = require('lodash');\nlet EVT = require('evrythng-extended');\nlet fs = require('fs');\nlet request = require('request-promise');\nlet test = require('blue-tape');\n\nlet BASE_DIR = `${ __dirname }/..`;\nlet PREFIX = 'REACTOR';\n\nlet settings = require(`${ BASE_DIR }/uploadSettings.json`);\n\nlet operator = new EVT.Operator(settings.operatorKey);\n\nfunction getSampleRule() {\n    let rule = JSON.parse(fs.readFileSync(`${ BASE_DIR }/tests/shared/rules-sample-1.json`, 'utf8'));\n    rule.name = `${ PREFIX } Rule`;\n    return rule;\n}\n\nfunction log(objectType, verb, obj) {\n    console.log(`${ objectType } '${ obj.name }' ${ verb } with ID '${ obj.id }'`);\n}\n\ntest('REACTOR', (() => {\n    var _ref11 = _asyncToGenerator(function* (t) {\n        //let project = await createProject(operator)\n        //let app = await createApp(project)\n        let project = yield fetchProject(settings);\n        let app = yield fetchApp(settings);\n        let user = yield createUser(app);\n        let collection = yield createCollection(user);\n        yield createActionTypes(['_dim', '_on', '_off']);\n\n        let rule = getSampleRule();\n        rule.conditions = [{\n            'variable': 'occupancy_detected',\n            'operator': '=',\n            'value': true,\n            'logical_operator': 'and'\n        }, {\n            'variable': 'ambient_light',\n            'operator': '>',\n            'value': 10,\n            'logical_operator': null\n        }];\n        rule.operations = [{\n            'collections': [collection.id],\n            'actions': [{\n                'name': '_off'\n            }, {\n                'name': '_dim',\n                'parameters': {\n                    'value': 1\n                }\n            }]\n        }];\n\n        let rules = { '__rule__7828728700101': rule };\n\n        let properties = {\n            'occupancy_detected': false,\n            'ambient_light': 9\n        };\n\n        let thng = yield createThng(user, rules, properties);\n\n        let props = yield thng.property('ambient_light').update(11);\n        let ambient_light = props[0].value;\n        t.equal(ambient_light, 11);\n\n        props = yield thng.property('occupancy_detected').update(true);\n        let occupancy_detected = props[0].value;\n        t.equal(occupancy_detected, true);\n\n        let actions = yield operator.action('all').read();\n    });\n\n    return function (_x12) {\n        return _ref11.apply(this, arguments);\n    };\n})());\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInByb3BhZ2F0aW9uLnRlc3QuanMiXSwibmFtZXMiOlsicHJvamVjdCIsIm9wZXJhdG9yIiwiY3JlYXRlIiwiUFJFRklYIiwibG9nIiwiaWQiLCJjcmVhdGVQcm9qZWN0IiwiYXBwIiwiYXBwbGljYXRpb24iLCJFVlQiLCJBcHAiLCJhcHBBcGlLZXkiLCJjcmVhdGVBcHAiLCJzZXR0aW5ncyIsInByb2plY3RJZCIsInJlYWQiLCJmZXRjaFByb2plY3QiLCJhcHBsaWNhdGlvbklkIiwiZmV0Y2hBcHAiLCJ1c2VyIiwiYXBwVXNlciIsImFub255bW91cyIsIlVzZXIiLCJjcmVhdGVVc2VyIiwiY29sbGVjdGlvbiIsImNyZWF0ZUNvbGxlY3Rpb24iLCJydWxlcyIsInByb3BlcnRpZXMiLCJ0aG5nIiwiXyIsImFzc2lnbiIsImNyZWF0ZVRobmciLCJuYW1lcyIsImFjdGlvblR5cGVzIiwiUHJvbWlzZSIsImFsbCIsIm1hcCIsIm5hbWUiLCJhY3Rpb25UeXBlIiwiZXJyb3IiLCJzdGF0dXMiLCJjb25zb2xlIiwiSlNPTiIsInN0cmluZ2lmeSIsImNyZWF0ZUFjdGlvblR5cGVzIiwiYXBwRGF0YSIsInJlcXVlc3QiLCJnZXQiLCJ1cmwiLCJyZXNvdXJjZSIsInBhdGgiLCJoZWFkZXJzIiwib3BlcmF0b3JLZXkiLCJyZWFkUmVhY3RvclN0YXR1cyIsInJlcXVpcmUiLCJmcyIsInRlc3QiLCJCQVNFX0RJUiIsIl9fZGlybmFtZSIsIk9wZXJhdG9yIiwiZ2V0U2FtcGxlUnVsZSIsInJ1bGUiLCJwYXJzZSIsInJlYWRGaWxlU3luYyIsIm9iamVjdFR5cGUiLCJ2ZXJiIiwib2JqIiwidCIsImNvbmRpdGlvbnMiLCJvcGVyYXRpb25zIiwicHJvcHMiLCJwcm9wZXJ0eSIsInVwZGF0ZSIsImFtYmllbnRfbGlnaHQiLCJ2YWx1ZSIsImVxdWFsIiwib2NjdXBhbmN5X2RldGVjdGVkIiwiYWN0aW9ucyIsImFjdGlvbiJdLCJtYXBwaW5ncyI6IkFBQUE7OztpQ0F3QkEsYUFBZ0M7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N0MsV0FBV25CLEVBREEsQ0FEbkI7QUFJSSx1QkFBVyxDQUNQO0FBQ0ksd0JBQVE7QUFEWixhQURPLEVBSVA7QUFDSSx3QkFBUSxNQURaO0FBRUksOEJBQWM7QUFDViw2QkFBUztBQURDO0FBRmxCLGFBSk87QUFKZixTQURjLENBQWxCOztBQW1CQSxZQUFJcUIsUUFBUSxFQUFFLHlCQUF5Qm1DLElBQTNCLEVBQVo7O0FBRUEsWUFBSWxDLGFBQWE7QUFDYixrQ0FBc0IsS0FEVDtBQUViLDZCQUFpQjtBQUZKLFNBQWpCOztBQUtBLFlBQUlDLE9BQU8sTUFBTUcsV0FBV1osSUFBWCxFQUFpQk8sS0FBakIsRUFBd0JDLFVBQXhCLENBQWpCOztBQUVBLFlBQUkyQyxRQUFRLE1BQU0xQyxLQUFLMkMsUUFBTCxDQUFjLGVBQWQsRUFBK0JDLE1BQS9CLENBQXNDLEVBQXRDLENBQWxCO0FBQ0EsWUFBSUMsZ0JBQWdCSCxNQUFNLENBQU4sRUFBU0ksS0FBN0I7QUFDQVAsVUFBRVEsS0FBRixDQUFRRixhQUFSLEVBQXVCLEVBQXZCOztBQUVBSCxnQkFBUSxNQUFNMUMsS0FBSzJDLFFBQUwsQ0FBYyxvQkFBZCxFQUFvQ0MsTUFBcEMsQ0FBMkMsSUFBM0MsQ0FBZDtBQUNBLFlBQUlJLHFCQUFxQk4sTUFBTSxDQUFOLEVBQVNJLEtBQWxDO0FBQ0FQLFVBQUVRLEtBQUYsQ0FBUUMsa0JBQVIsRUFBNEIsSUFBNUI7O0FBRUEsWUFBSUMsVUFBVSxNQUFNNUUsU0FBUzZFLE1BQVQsQ0FBZ0IsS0FBaEIsRUFBdUIvRCxJQUF2QixFQUFwQjtBQUNILEtBN0REOztBQUFBO0FBQUE7QUFBQTtBQUFBIiwiZmlsZSI6InByb3BhZ2F0aW9uLnRlc3QuanMiLCJzb3VyY2VSb290IjoiL1VzZXJzL2R0ci9nb29lZS9SRUFDVE9SL3Rlc3RzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnXG5sZXQgXyA9IHJlcXVpcmUoJ2xvZGFzaCcpXG5sZXQgRVZUID0gcmVxdWlyZSgnZXZyeXRobmctZXh0ZW5kZWQnKVxubGV0IGZzID0gcmVxdWlyZSgnZnMnKVxubGV0IHJlcXVlc3QgPSByZXF1aXJlKCdyZXF1ZXN0LXByb21pc2UnKVxubGV0IHRlc3QgPSByZXF1aXJlKCdibHVlLXRhcGUnKVxuXG5sZXQgQkFTRV9ESVIgPSBgJHtfX2Rpcm5hbWV9Ly4uYFxubGV0IFBSRUZJWCA9ICdSRUFDVE9SJ1xuXG5sZXQgc2V0dGluZ3MgPSByZXF1aXJlKGAke0JBU0VfRElSfS91cGxvYWRTZXR0aW5ncy5qc29uYClcblxubGV0IG9wZXJhdG9yID0gbmV3IEVWVC5PcGVyYXRvcihzZXR0aW5ncy5vcGVyYXRvcktleSlcblxuZnVuY3Rpb24gZ2V0U2FtcGxlUnVsZSAoKSB7XG4gICAgbGV0IHJ1bGUgPSBKU09OLnBhcnNlKGZzLnJlYWRGaWxlU3luYyhgJHtCQVNFX0RJUn0vdGVzdHMvc2hhcmVkL3J1bGVzLXNhbXBsZS0xLmpzb25gLCAndXRmOCcpKVxuICAgIHJ1bGUubmFtZSA9IGAke1BSRUZJWH0gUnVsZWBcbiAgICByZXR1cm4gcnVsZVxufVxuXG5mdW5jdGlvbiBsb2cgKG9iamVjdFR5cGUsIHZlcmIsIG9iaikge1xuICAgIGNvbnNvbGUubG9nKGAke29iamVjdFR5cGV9ICcke29iai5uYW1lfScgJHt2ZXJifSB3aXRoIElEICcke29iai5pZH0nYClcbn1cblxuYXN5bmMgZnVuY3Rpb24gY3JlYXRlUHJvamVjdCAoKSB7XG4gICAgbGV0IHByb2plY3QgPSBhd2FpdCBvcGVyYXRvci5wcm9qZWN0KCkuY3JlYXRlKHtcbiAgICAgICAgJ25hbWUnOiBgJHtQUkVGSVh9IFByb2plY3RgXG4gICAgfSlcblxuICAgIGxvZygnUHJvamVjdCcsICdjcmVhdGVkJywgcHJvamVjdClcbiAgICByZXR1cm4gb3BlcmF0b3IucHJvamVjdChwcm9qZWN0LmlkKVxufVxuXG5hc3luYyBmdW5jdGlvbiBjcmVhdGVBcHAgKHByb2plY3QpIHtcbiAgICBsZXQgYXBwID0gYXdhaXQgcHJvamVjdC5hcHBsaWNhdGlvbigpLmNyZWF0ZSh7XG4gICAgICAgICduYW1lJzogYCR7UFJFRklYfSBBcHBsaWNhdGlvbmAsXG4gICAgICAgICdzb2NpYWxOZXR3b3Jrcyc6IHt9LFxuICAgIH0pXG5cbiAgICBsb2coJ0FwcGxpY2F0aW9uJywgJ2NyZWF0ZWQnLCBhcHApXG4gICAgcmV0dXJuIG5ldyBFVlQuQXBwKGFwcC5hcHBBcGlLZXkpXG59XG5cbmFzeW5jIGZ1bmN0aW9uIGZldGNoUHJvamVjdCAoc2V0dGluZ3MpIHtcbiAgICBsZXQgcHJvamVjdCA9IGF3YWl0IG9wZXJhdG9yXG4gICAgICAgIC5wcm9qZWN0KHNldHRpbmdzLnByb2plY3RJZClcbiAgICAgICAgLnJlYWQoKVxuXG4gICAgbG9nKCdQcm9qZWN0JywgJ2ZldGNoZWQnLCBwcm9qZWN0KVxuICAgIHJldHVybiBvcGVyYXRvci5wcm9qZWN0KHNldHRpbmdzLnByb2plY3RJZClcbn1cblxuYXN5bmMgZnVuY3Rpb24gZmV0Y2hBcHAgKHNldHRpbmdzKSB7XG4gICAgbGV0IGFwcCA9IGF3YWl0IG9wZXJhdG9yXG4gICAgICAgIC5wcm9qZWN0KHNldHRpbmdzLnByb2plY3RJZClcbiAgICAgICAgLmFwcGxpY2F0aW9uKHNldHRpbmdzLmFwcGxpY2F0aW9uSWQpXG4gICAgICAgIC5yZWFkKClcblxuICAgIGxvZygnQXBwbGljYXRpb24nLCAnZmV0Y2hlZCcsIGFwcClcbiAgICByZXR1cm4gbmV3IEVWVC5BcHAoYXBwLmFwcEFwaUtleSlcbn1cblxuYXN5bmMgZnVuY3Rpb24gY3JlYXRlVXNlciAoYXBwKSB7XG4gICAgbGV0IHVzZXIgPSBhd2FpdCBhcHAuYXBwVXNlcigpLmNyZWF0ZSh7IGFub255bW91czogdHJ1ZSB9KVxuICAgIGxvZygnVXNlcicsICdjcmVhdGVkJywgdXNlcilcbiAgICByZXR1cm4gbmV3IEVWVC5Vc2VyKHVzZXIsIGFwcClcbn1cblxuYXN5bmMgZnVuY3Rpb24gY3JlYXRlQ29sbGVjdGlvbiAodXNlcikge1xuICAgIGxldCBjb2xsZWN0aW9uID0gYXdhaXQgdXNlci5jb2xsZWN0aW9uKCkuY3JlYXRlKHtcbiAgICAgICAgJ25hbWUnOiBgJHtQUkVGSVh9IENvbGxlY3Rpb25gLFxuICAgIH0pXG5cbiAgICBsb2coJ0NvbGxlY3Rpb24nLCAnY3JlYXRlZCcsIGNvbGxlY3Rpb24pXG4gICAgcmV0dXJuIGNvbGxlY3Rpb25cbn1cblxuYXN5bmMgZnVuY3Rpb24gY3JlYXRlVGhuZyAodXNlciwgcnVsZXMsIHByb3BlcnRpZXMpIHtcbiAgICBsZXQgdGhuZyA9IGF3YWl0IHVzZXIudGhuZygpLmNyZWF0ZSh7XG4gICAgICAgICduYW1lJzogYCR7UFJFRklYfSBUaG5nYCxcbiAgICAgICAgJ3Byb3BlcnRpZXMnOiBfLmFzc2lnbihwcm9wZXJ0aWVzLCBydWxlcyksXG4gICAgfSlcblxuICAgIGxvZygnVGhuZycsICdjcmVhdGVkJywgdGhuZylcbiAgICByZXR1cm4gdXNlci50aG5nKHRobmcuaWQpXG59XG5cbmFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUFjdGlvblR5cGVzIChuYW1lcykge1xuICAgIGxldCBhY3Rpb25UeXBlcyA9IFByb21pc2UuYWxsKG5hbWVzLm1hcChhc3luYyAobmFtZSkgPT4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgbGV0IGFjdGlvblR5cGUgPSBhd2FpdCBvcGVyYXRvci5hY3Rpb25UeXBlKCkuY3JlYXRlKHsgbmFtZSB9KVxuXG4gICAgICAgICAgICBsb2coJ0FjdGlvblR5cGUnLCAnY3JlYXRlZCcsIGFjdGlvblR5cGUpXG5cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGlmIChlcnJvci5zdGF0dXMgIT09IDQwOSlcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKEpTT04uc3RyaW5naWZ5KGVycm9yKSlcbiAgICAgICAgfVxuICAgIH0pKVxufVxuXG5hc3luYyBmdW5jdGlvbiByZWFkUmVhY3RvclN0YXR1cyAoYXBwRGF0YSkge1xuICAgIGNvbnNvbGUubG9nKFxuICAgICAgICBgR2V0dGluZyB0aGUgUkVBQ1RPUiBzdGF0dXMgZm9yIEFwcCAnJHthcHBEYXRhLm5hbWV9JyB3aXRoIElEICcke2FwcERhdGEuaWR9Jy4uLmApXG5cbiAgICBsZXQgc3RhdHVzID0gYXdhaXQgcmVxdWVzdC5nZXQoe1xuICAgICAgICB1cmw6IGBodHRwczovL2FwaS5ldnJ5dGhuZy5jb20vJHthcHBEYXRhLnJlc291cmNlLnBhdGh9L3JlYWN0b3JTY3JpcHQvc3RhdHVzYCxcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgJ0FjY2VwdCc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgICdBdXRob3JpemF0aW9uJzogc2V0dGluZ3Mub3BlcmF0b3JLZXksXG4gICAgICAgIH1cbiAgICB9KVxuXG4gICAgY29uc29sZS5sb2coYFJFQUNUT1Igc3RhdHVzOiAke3N0YXR1c31gKVxuICAgIHJldHVybiBzdGF0dXNcbn1cblxudGVzdCgnUkVBQ1RPUicsIGFzeW5jICh0KSA9PiB7XG4gICAgLy9sZXQgcHJvamVjdCA9IGF3YWl0IGNyZWF0ZVByb2plY3Qob3BlcmF0b3IpXG4gICAgLy9sZXQgYXBwID0gYXdhaXQgY3JlYXRlQXBwKHByb2plY3QpXG4gICAgbGV0IHByb2plY3QgPSBhd2FpdCBmZXRjaFByb2plY3Qoc2V0dGluZ3MpXG4gICAgbGV0IGFwcCA9IGF3YWl0IGZldGNoQXBwKHNldHRpbmdzKVxuICAgIGxldCB1c2VyID0gYXdhaXQgY3JlYXRlVXNlcihhcHApXG4gICAgbGV0IGNvbGxlY3Rpb24gPSBhd2FpdCBjcmVhdGVDb2xsZWN0aW9uKHVzZXIpXG4gICAgYXdhaXQgY3JlYXRlQWN0aW9uVHlwZXMoWydfZGltJywgJ19vbicsICdfb2ZmJ10pXG5cbiAgICBsZXQgcnVsZSA9IGdldFNhbXBsZVJ1bGUoKVxuICAgIHJ1bGUuY29uZGl0aW9ucyA9IFtcbiAgICAgICAge1xuICAgICAgICAgICAgJ3ZhcmlhYmxlJzogJ29jY3VwYW5jeV9kZXRlY3RlZCcsXG4gICAgICAgICAgICAnb3BlcmF0b3InOiAnPScsXG4gICAgICAgICAgICAndmFsdWUnOiB0cnVlLFxuICAgICAgICAgICAgJ2xvZ2ljYWxfb3BlcmF0b3InOiAnYW5kJyxcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgJ3ZhcmlhYmxlJzogJ2FtYmllbnRfbGlnaHQnLFxuICAgICAgICAgICAgJ29wZXJhdG9yJzogJz4nLFxuICAgICAgICAgICAgJ3ZhbHVlJzogMTAsXG4gICAgICAgICAgICAnbG9naWNhbF9vcGVyYXRvcic6IG51bGwsXG4gICAgICAgIH0sXG4gICAgXVxuICAgIHJ1bGUub3BlcmF0aW9ucyA9IFtcbiAgICAgICAge1xuICAgICAgICAgICAgJ2NvbGxlY3Rpb25zJzogW1xuICAgICAgICAgICAgICAgIGNvbGxlY3Rpb24uaWRcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAnYWN0aW9ucyc6IFtcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICduYW1lJzogJ19vZmYnXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICduYW1lJzogJ19kaW0nLFxuICAgICAgICAgICAgICAgICAgICAncGFyYW1ldGVycyc6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICd2YWx1ZSc6IDFcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF1cbiAgICAgICAgfVxuICAgIF1cblxuICAgIGxldCBydWxlcyA9IHsgJ19fcnVsZV9fNzgyODcyODcwMDEwMSc6IHJ1bGUgfVxuXG4gICAgbGV0IHByb3BlcnRpZXMgPSB7XG4gICAgICAgICdvY2N1cGFuY3lfZGV0ZWN0ZWQnOiBmYWxzZSxcbiAgICAgICAgJ2FtYmllbnRfbGlnaHQnOiA5LFxuICAgIH1cblxuICAgIGxldCB0aG5nID0gYXdhaXQgY3JlYXRlVGhuZyh1c2VyLCBydWxlcywgcHJvcGVydGllcylcblxuICAgIGxldCBwcm9wcyA9IGF3YWl0IHRobmcucHJvcGVydHkoJ2FtYmllbnRfbGlnaHQnKS51cGRhdGUoMTEpXG4gICAgbGV0IGFtYmllbnRfbGlnaHQgPSBwcm9wc1swXS52YWx1ZVxuICAgIHQuZXF1YWwoYW1iaWVudF9saWdodCwgMTEpXG5cbiAgICBwcm9wcyA9IGF3YWl0IHRobmcucHJvcGVydHkoJ29jY3VwYW5jeV9kZXRlY3RlZCcpLnVwZGF0ZSh0cnVlKVxuICAgIGxldCBvY2N1cGFuY3lfZGV0ZWN0ZWQgPSBwcm9wc1swXS52YWx1ZVxuICAgIHQuZXF1YWwob2NjdXBhbmN5X2RldGVjdGVkLCB0cnVlKVxuXG4gICAgbGV0IGFjdGlvbnMgPSBhd2FpdCBvcGVyYXRvci5hY3Rpb24oJ2FsbCcpLnJlYWQoKVxufSlcbiJdfQ==",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "propagation.test.js"
      ],
      "names": [
        "project",
        "operator",
        "create",
        "PREFIX",
        "log",
        "id",
        "createProject",
        "app",
        "application",
        "EVT",
        "App",
        "appApiKey",
        "createApp",
        "settings",
        "projectId",
        "read",
        "fetchProject",
        "applicationId",
        "fetchApp",
        "user",
        "appUser",
        "anonymous",
        "User",
        "createUser",
        "collection",
        "createCollection",
        "rules",
        "properties",
        "thng",
        "_",
        "assign",
        "createThng",
        "names",
        "actionTypes",
        "Promise",
        "all",
        "map",
        "name",
        "actionType",
        "error",
        "status",
        "console",
        "JSON",
        "stringify",
        "createActionTypes",
        "appData",
        "request",
        "get",
        "url",
        "resource",
        "path",
        "headers",
        "operatorKey",
        "readReactorStatus",
        "require",
        "fs",
        "test",
        "BASE_DIR",
        "__dirname",
        "Operator",
        "getSampleRule",
        "rule",
        "parse",
        "readFileSync",
        "objectType",
        "verb",
        "obj",
        "t",
        "conditions",
        "operations",
        "props",
        "property",
        "update",
        "ambient_light",
        "value",
        "equal",
        "occupancy_detected",
        "actions",
        "action"
      ],
      "mappings": "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",
      "file": "propagation.test.js",
      "sourceRoot": "/Users/dtr/gooee/REACTOR/tests",
      "sourcesContent": [
        "'use strict'\nlet _ = require('lodash')\nlet EVT = require('evrythng-extended')\nlet fs = require('fs')\nlet request = require('request-promise')\nlet test = require('blue-tape')\n\nlet BASE_DIR = `${__dirname}/..`\nlet PREFIX = 'REACTOR'\n\nlet settings = require(`${BASE_DIR}/uploadSettings.json`)\n\nlet operator = new EVT.Operator(settings.operatorKey)\n\nfunction getSampleRule () {\n    let rule = JSON.parse(fs.readFileSync(`${BASE_DIR}/tests/shared/rules-sample-1.json`, 'utf8'))\n    rule.name = `${PREFIX} Rule`\n    return rule\n}\n\nfunction log (objectType, verb, obj) {\n    console.log(`${objectType} '${obj.name}' ${verb} with ID '${obj.id}'`)\n}\n\nasync function createProject () {\n    let project = await operator.project().create({\n        'name': `${PREFIX} Project`\n    })\n\n    log('Project', 'created', project)\n    return operator.project(project.id)\n}\n\nasync function createApp (project) {\n    let app = await project.application().create({\n        'name': `${PREFIX} Application`,\n        'socialNetworks': {},\n    })\n\n    log('Application', 'created', app)\n    return new EVT.App(app.appApiKey)\n}\n\nasync function fetchProject (settings) {\n    let project = await operator\n        .project(settings.projectId)\n        .read()\n\n    log('Project', 'fetched', project)\n    return operator.project(settings.projectId)\n}\n\nasync function fetchApp (settings) {\n    let app = await operator\n        .project(settings.projectId)\n        .application(settings.applicationId)\n        .read()\n\n    log('Application', 'fetched', app)\n    return new EVT.App(app.appApiKey)\n}\n\nasync function createUser (app) {\n    let user = await app.appUser().create({ anonymous: true })\n    log('User', 'created', user)\n    return new EVT.User(user, app)\n}\n\nasync function createCollection (user) {\n    let collection = await user.collection().create({\n        'name': `${PREFIX} Collection`,\n    })\n\n    log('Collection', 'created', collection)\n    return collection\n}\n\nasync function createThng (user, rules, properties) {\n    let thng = await user.thng().create({\n        'name': `${PREFIX} Thng`,\n        'properties': _.assign(properties, rules),\n    })\n\n    log('Thng', 'created', thng)\n    return user.thng(thng.id)\n}\n\nasync function createActionTypes (names) {\n    let actionTypes = Promise.all(names.map(async (name) => {\n        try {\n            let actionType = await operator.actionType().create({ name })\n\n            log('ActionType', 'created', actionType)\n\n        } catch (error) {\n            if (error.status !== 409)\n                console.error(JSON.stringify(error))\n        }\n    }))\n}\n\nasync function readReactorStatus (appData) {\n    console.log(\n        `Getting the REACTOR status for App '${appData.name}' with ID '${appData.id}'...`)\n\n    let status = await request.get({\n        url: `https://api.evrythng.com/${appData.resource.path}/reactorScript/status`,\n        headers: {\n            'Accept': 'application/json',\n            'Authorization': settings.operatorKey,\n        }\n    })\n\n    console.log(`REACTOR status: ${status}`)\n    return status\n}\n\ntest('REACTOR', async (t) => {\n    //let project = await createProject(operator)\n    //let app = await createApp(project)\n    let project = await fetchProject(settings)\n    let app = await fetchApp(settings)\n    let user = await createUser(app)\n    let collection = await createCollection(user)\n    await createActionTypes(['_dim', '_on', '_off'])\n\n    let rule = getSampleRule()\n    rule.conditions = [\n        {\n            'variable': 'occupancy_detected',\n            'operator': '=',\n            'value': true,\n            'logical_operator': 'and',\n        },\n        {\n            'variable': 'ambient_light',\n            'operator': '>',\n            'value': 10,\n            'logical_operator': null,\n        },\n    ]\n    rule.operations = [\n        {\n            'collections': [\n                collection.id\n            ],\n            'actions': [\n                {\n                    'name': '_off'\n                },\n                {\n                    'name': '_dim',\n                    'parameters': {\n                        'value': 1\n                    }\n                }\n            ]\n        }\n    ]\n\n    let rules = { '__rule__7828728700101': rule }\n\n    let properties = {\n        'occupancy_detected': false,\n        'ambient_light': 9,\n    }\n\n    let thng = await createThng(user, rules, properties)\n\n    let props = await thng.property('ambient_light').update(11)\n    let ambient_light = props[0].value\n    t.equal(ambient_light, 11)\n\n    props = await thng.property('occupancy_detected').update(true)\n    let occupancy_detected = props[0].value\n    t.equal(occupancy_detected, true)\n\n    let actions = await operator.action('all').read()\n})\n"
      ]
    },
    "mtime": 1472579343000
  },
  "{\"filename\":\"/Users/dtr/gooee/REACTOR/tests/integration.test.js\",\"env\":{},\"retainLines\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"presets\":[],\"plugins\":[[[],null]],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"minified\":false,\"sourceRoot\":\"/Users/dtr/gooee/REACTOR/tests\",\"babelrc\":true,\"sourceType\":\"module\",\"moduleIds\":false,\"passPerPreset\":false}:6.14.0": {
    "metadata": {
      "usedHelpers": [
        "asyncToGenerator"
      ],
      "marked": [],
      "modules": {
        "imports": [],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      }
    },
    "options": {
      "filename": "/Users/dtr/gooee/REACTOR/tests/integration.test.js",
      "filenameRelative": "/Users/dtr/gooee/REACTOR/tests/integration.test.js",
      "env": {},
      "retainLines": false,
      "highlightCode": true,
      "suppressDeprecationMessages": false,
      "presets": [],
      "plugins": [
        [
          [],
          null
        ]
      ],
      "ignore": [],
      "code": true,
      "metadata": true,
      "ast": false,
      "comments": true,
      "compact": "auto",
      "minified": false,
      "sourceMaps": "both",
      "sourceMapTarget": "integration.test.js",
      "sourceFileName": "integration.test.js",
      "sourceRoot": "/Users/dtr/gooee/REACTOR/tests",
      "babelrc": false,
      "sourceType": "module",
      "moduleRoot": "/Users/dtr/gooee/REACTOR/tests",
      "moduleIds": false,
      "passPerPreset": false,
      "basename": "integration.test"
    },
    "ignored": false,
    "code": "'use strict';\n\nlet createProject = (() => {\n    var _ref = _asyncToGenerator(function* () {\n        let project = yield operator.project().create({\n            'name': `${ PREFIX } Project`\n        });\n\n        log('Project', 'created', project);\n        return operator.project(project.id);\n    });\n\n    return function createProject() {\n        return _ref.apply(this, arguments);\n    };\n})();\n\nlet createApp = (() => {\n    var _ref2 = _asyncToGenerator(function* (project) {\n        let app = yield project.application().create({\n            'name': `${ PREFIX } Application`,\n            'socialNetworks': {}\n        });\n\n        log('Application', 'created', app);\n        return new EVT.App(app.appApiKey);\n    });\n\n    return function createApp(_x) {\n        return _ref2.apply(this, arguments);\n    };\n})();\n\nlet fetchProject = (() => {\n    var _ref3 = _asyncToGenerator(function* (settings) {\n        let project = yield operator.project(settings.projectId).read();\n\n        log('Project', 'fetched', project);\n        return operator.project(settings.projectId);\n    });\n\n    return function fetchProject(_x2) {\n        return _ref3.apply(this, arguments);\n    };\n})();\n\nlet fetchApp = (() => {\n    var _ref4 = _asyncToGenerator(function* (settings) {\n        let app = yield operator.project(settings.projectId).application(settings.applicationId).read();\n\n        log('Application', 'fetched', app);\n        return new EVT.App(app.appApiKey);\n    });\n\n    return function fetchApp(_x3) {\n        return _ref4.apply(this, arguments);\n    };\n})();\n\nlet createUser = (() => {\n    var _ref5 = _asyncToGenerator(function* (app) {\n        let user = yield app.appUser().create({ anonymous: true });\n        log('User', 'created', user);\n        return new EVT.User(user, app);\n    });\n\n    return function createUser(_x4) {\n        return _ref5.apply(this, arguments);\n    };\n})();\n\nlet createCollection = (() => {\n    var _ref6 = _asyncToGenerator(function* (user) {\n        let collection = yield user.collection().create({\n            'name': `${ PREFIX } Collection`\n        });\n\n        log('Collection', 'created', collection);\n        return collection;\n    });\n\n    return function createCollection(_x5) {\n        return _ref6.apply(this, arguments);\n    };\n})();\n\nlet createThng = (() => {\n    var _ref7 = _asyncToGenerator(function* (user, rules, properties) {\n        let thng = yield user.thng().create({\n            'name': `${ PREFIX } Thng`,\n            'properties': _.assign(properties, rules)\n        });\n\n        log('Thng', 'created', thng);\n        return user.thng(thng.id);\n    });\n\n    return function createThng(_x6, _x7, _x8) {\n        return _ref7.apply(this, arguments);\n    };\n})();\n\nlet createActionTypes = (() => {\n    var _ref8 = _asyncToGenerator(function* (names) {\n        let actionTypes = Promise.all(names.map((() => {\n            var _ref9 = _asyncToGenerator(function* (name) {\n                try {\n                    let actionType = yield operator.actionType().create({ name });\n\n                    log('ActionType', 'created', actionType);\n                } catch (error) {\n                    if (error.status !== 409) console.error(JSON.stringify(error));\n                }\n            });\n\n            return function (_x10) {\n                return _ref9.apply(this, arguments);\n            };\n        })()));\n    });\n\n    return function createActionTypes(_x9) {\n        return _ref8.apply(this, arguments);\n    };\n})();\n\nlet readReactorStatus = (() => {\n    var _ref10 = _asyncToGenerator(function* (appData) {\n        console.log(`Getting the REACTOR status for App '${ appData.name }' with ID '${ appData.id }'...`);\n\n        let status = yield request.get({\n            url: `https://api.evrythng.com/${ appData.resource.path }/reactorScript/status`,\n            headers: {\n                'Accept': 'application/json',\n                'Authorization': settings.operatorKey\n            }\n        });\n\n        console.log(`REACTOR status: ${ status }`);\n        return status;\n    });\n\n    return function readReactorStatus(_x11) {\n        return _ref10.apply(this, arguments);\n    };\n})();\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { return step(\"next\", value); }, function (err) { return step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nlet _ = require('lodash');\nlet EVT = require('evrythng-extended');\nlet fs = require('fs');\nlet request = require('request-promise');\nlet test = require('blue-tape');\n\nlet BASE_DIR = `${ __dirname }/..`;\nlet PREFIX = 'REACTOR';\n\nlet settings = require(`${ BASE_DIR }/uploadSettings.json`);\n\nlet operator = new EVT.Operator(settings.operatorKey);\n\nfunction getSampleRule() {\n    let rule = JSON.parse(fs.readFileSync(`${ BASE_DIR }/tests/shared/rules-sample-1.json`, 'utf8'));\n    rule.name = `${ PREFIX } Rule`;\n    return rule;\n}\n\nfunction log(objectType, verb, obj) {\n    console.log(`${ objectType } '${ obj.name }' ${ verb } with ID '${ obj.id }'`);\n}\n\ntest('REACTOR', (() => {\n    var _ref11 = _asyncToGenerator(function* (t) {\n        //let project = await createProject(operator)\n        //let app = await createApp(project)\n        let project = yield fetchProject(settings);\n        let app = yield fetchApp(settings);\n        let user = yield createUser(app);\n        let collection = yield createCollection(user);\n        yield createActionTypes(['_dim', '_on', '_off']);\n\n        let rule = getSampleRule();\n        rule.conditions = [{\n            'variable': 'occupancy_detected',\n            'operator': '=',\n            'value': true,\n            'logical_operator': 'and'\n        }, {\n            'variable': 'ambient_light',\n            'operator': '>',\n            'value': 10,\n            'logical_operator': null\n        }];\n        rule.operations = [{\n            'collections': [collection.id],\n            'actions': [{\n                'name': '_off'\n            }, {\n                'name': '_dim',\n                'parameters': {\n                    'value': 1\n                }\n            }]\n        }];\n\n        let rules = { '__rule__7828728700101': rule };\n\n        let properties = {\n            'occupancy_detected': false,\n            'ambient_light': 9\n        };\n\n        let thng = yield createThng(user, rules, properties);\n\n        let props = yield thng.property('ambient_light').update(11);\n        let ambient_light = props[0].value;\n        t.equal(ambient_light, 11);\n\n        props = yield thng.property('occupancy_detected').update(true);\n        let occupancy_detected = props[0].value;\n        t.equal(occupancy_detected, true);\n\n        let actions = yield operator.action('all').read();\n    });\n\n    return function (_x12) {\n        return _ref11.apply(this, arguments);\n    };\n})());\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImludGVncmF0aW9uLnRlc3QuanMiXSwibmFtZXMiOlsicHJvamVjdCIsIm9wZXJhdG9yIiwiY3JlYXRlIiwiUFJFRklYIiwibG9nIiwiaWQiLCJjcmVhdGVQcm9qZWN0IiwiYXBwIiwiYXBwbGljYXRpb24iLCJFVlQiLCJBcHAiLCJhcHBBcGlLZXkiLCJjcmVhdGVBcHAiLCJzZXR0aW5ncyIsInByb2plY3RJZCIsInJlYWQiLCJmZXRjaFByb2plY3QiLCJhcHBsaWNhdGlvbklkIiwiZmV0Y2hBcHAiLCJ1c2VyIiwiYXBwVXNlciIsImFub255bW91cyIsIlVzZXIiLCJjcmVhdGVVc2VyIiwiY29sbGVjdGlvbiIsImNyZWF0ZUNvbGxlY3Rpb24iLCJydWxlcyIsInByb3BlcnRpZXMiLCJ0aG5nIiwiXyIsImFzc2lnbiIsImNyZWF0ZVRobmciLCJuYW1lcyIsImFjdGlvblR5cGVzIiwiUHJvbWlzZSIsImFsbCIsIm1hcCIsIm5hbWUiLCJhY3Rpb25UeXBlIiwiZXJyb3IiLCJzdGF0dXMiLCJjb25zb2xlIiwiSlNPTiIsInN0cmluZ2lmeSIsImNyZWF0ZUFjdGlvblR5cGVzIiwiYXBwRGF0YSIsInJlcXVlc3QiLCJnZXQiLCJ1cmwiLCJyZXNvdXJjZSIsInBhdGgiLCJoZWFkZXJzIiwib3BlcmF0b3JLZXkiLCJyZWFkUmVhY3RvclN0YXR1cyIsInJlcXVpcmUiLCJmcyIsInRlc3QiLCJCQVNFX0RJUiIsIl9fZGlybmFtZSIsIk9wZXJhdG9yIiwiZ2V0U2FtcGxlUnVsZSIsInJ1bGUiLCJwYXJzZSIsInJlYWRGaWxlU3luYyIsIm9iamVjdFR5cGUiLCJ2ZXJiIiwib2JqIiwidCIsImNvbmRpdGlvbnMiLCJvcGVyYXRpb25zIiwicHJvcHMiLCJwcm9wZXJ0eSIsInVwZGF0ZSIsImFtYmllbnRfbGlnaHQiLCJ2YWx1ZSIsImVxdWFsIiwib2NjdXBhbmN5X2RldGVjdGVkIiwiYWN0aW9ucyIsImFjdGlvbiJdLCJtYXBwaW5ncyI6IkFBQUE7OztpQ0F3QkEsYUFBZ0M7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N0MsV0FBV25CLEVBREEsQ0FEbkI7QUFJSSx1QkFBVyxDQUNQO0FBQ0ksd0JBQVE7QUFEWixhQURPLEVBSVA7QUFDSSx3QkFBUSxNQURaO0FBRUksOEJBQWM7QUFDViw2QkFBUztBQURDO0FBRmxCLGFBSk87QUFKZixTQURjLENBQWxCOztBQW1CQSxZQUFJcUIsUUFBUSxFQUFFLHlCQUF5Qm1DLElBQTNCLEVBQVo7O0FBRUEsWUFBSWxDLGFBQWE7QUFDYixrQ0FBc0IsS0FEVDtBQUViLDZCQUFpQjtBQUZKLFNBQWpCOztBQUtBLFlBQUlDLE9BQU8sTUFBTUcsV0FBV1osSUFBWCxFQUFpQk8sS0FBakIsRUFBd0JDLFVBQXhCLENBQWpCOztBQUVBLFlBQUkyQyxRQUFRLE1BQU0xQyxLQUFLMkMsUUFBTCxDQUFjLGVBQWQsRUFBK0JDLE1BQS9CLENBQXNDLEVBQXRDLENBQWxCO0FBQ0EsWUFBSUMsZ0JBQWdCSCxNQUFNLENBQU4sRUFBU0ksS0FBN0I7QUFDQVAsVUFBRVEsS0FBRixDQUFRRixhQUFSLEVBQXVCLEVBQXZCOztBQUVBSCxnQkFBUSxNQUFNMUMsS0FBSzJDLFFBQUwsQ0FBYyxvQkFBZCxFQUFvQ0MsTUFBcEMsQ0FBMkMsSUFBM0MsQ0FBZDtBQUNBLFlBQUlJLHFCQUFxQk4sTUFBTSxDQUFOLEVBQVNJLEtBQWxDO0FBQ0FQLFVBQUVRLEtBQUYsQ0FBUUMsa0JBQVIsRUFBNEIsSUFBNUI7O0FBRUEsWUFBSUMsVUFBVSxNQUFNNUUsU0FBUzZFLE1BQVQsQ0FBZ0IsS0FBaEIsRUFBdUIvRCxJQUF2QixFQUFwQjtBQUNILEtBN0REOztBQUFBO0FBQUE7QUFBQTtBQUFBIiwiZmlsZSI6ImludGVncmF0aW9uLnRlc3QuanMiLCJzb3VyY2VSb290IjoiL1VzZXJzL2R0ci9nb29lZS9SRUFDVE9SL3Rlc3RzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnXG5sZXQgXyA9IHJlcXVpcmUoJ2xvZGFzaCcpXG5sZXQgRVZUID0gcmVxdWlyZSgnZXZyeXRobmctZXh0ZW5kZWQnKVxubGV0IGZzID0gcmVxdWlyZSgnZnMnKVxubGV0IHJlcXVlc3QgPSByZXF1aXJlKCdyZXF1ZXN0LXByb21pc2UnKVxubGV0IHRlc3QgPSByZXF1aXJlKCdibHVlLXRhcGUnKVxuXG5sZXQgQkFTRV9ESVIgPSBgJHtfX2Rpcm5hbWV9Ly4uYFxubGV0IFBSRUZJWCA9ICdSRUFDVE9SJ1xuXG5sZXQgc2V0dGluZ3MgPSByZXF1aXJlKGAke0JBU0VfRElSfS91cGxvYWRTZXR0aW5ncy5qc29uYClcblxubGV0IG9wZXJhdG9yID0gbmV3IEVWVC5PcGVyYXRvcihzZXR0aW5ncy5vcGVyYXRvcktleSlcblxuZnVuY3Rpb24gZ2V0U2FtcGxlUnVsZSAoKSB7XG4gICAgbGV0IHJ1bGUgPSBKU09OLnBhcnNlKGZzLnJlYWRGaWxlU3luYyhgJHtCQVNFX0RJUn0vdGVzdHMvc2hhcmVkL3J1bGVzLXNhbXBsZS0xLmpzb25gLCAndXRmOCcpKVxuICAgIHJ1bGUubmFtZSA9IGAke1BSRUZJWH0gUnVsZWBcbiAgICByZXR1cm4gcnVsZVxufVxuXG5mdW5jdGlvbiBsb2cgKG9iamVjdFR5cGUsIHZlcmIsIG9iaikge1xuICAgIGNvbnNvbGUubG9nKGAke29iamVjdFR5cGV9ICcke29iai5uYW1lfScgJHt2ZXJifSB3aXRoIElEICcke29iai5pZH0nYClcbn1cblxuYXN5bmMgZnVuY3Rpb24gY3JlYXRlUHJvamVjdCAoKSB7XG4gICAgbGV0IHByb2plY3QgPSBhd2FpdCBvcGVyYXRvci5wcm9qZWN0KCkuY3JlYXRlKHtcbiAgICAgICAgJ25hbWUnOiBgJHtQUkVGSVh9IFByb2plY3RgXG4gICAgfSlcblxuICAgIGxvZygnUHJvamVjdCcsICdjcmVhdGVkJywgcHJvamVjdClcbiAgICByZXR1cm4gb3BlcmF0b3IucHJvamVjdChwcm9qZWN0LmlkKVxufVxuXG5hc3luYyBmdW5jdGlvbiBjcmVhdGVBcHAgKHByb2plY3QpIHtcbiAgICBsZXQgYXBwID0gYXdhaXQgcHJvamVjdC5hcHBsaWNhdGlvbigpLmNyZWF0ZSh7XG4gICAgICAgICduYW1lJzogYCR7UFJFRklYfSBBcHBsaWNhdGlvbmAsXG4gICAgICAgICdzb2NpYWxOZXR3b3Jrcyc6IHt9LFxuICAgIH0pXG5cbiAgICBsb2coJ0FwcGxpY2F0aW9uJywgJ2NyZWF0ZWQnLCBhcHApXG4gICAgcmV0dXJuIG5ldyBFVlQuQXBwKGFwcC5hcHBBcGlLZXkpXG59XG5cbmFzeW5jIGZ1bmN0aW9uIGZldGNoUHJvamVjdCAoc2V0dGluZ3MpIHtcbiAgICBsZXQgcHJvamVjdCA9IGF3YWl0IG9wZXJhdG9yXG4gICAgICAgIC5wcm9qZWN0KHNldHRpbmdzLnByb2plY3RJZClcbiAgICAgICAgLnJlYWQoKVxuXG4gICAgbG9nKCdQcm9qZWN0JywgJ2ZldGNoZWQnLCBwcm9qZWN0KVxuICAgIHJldHVybiBvcGVyYXRvci5wcm9qZWN0KHNldHRpbmdzLnByb2plY3RJZClcbn1cblxuYXN5bmMgZnVuY3Rpb24gZmV0Y2hBcHAgKHNldHRpbmdzKSB7XG4gICAgbGV0IGFwcCA9IGF3YWl0IG9wZXJhdG9yXG4gICAgICAgIC5wcm9qZWN0KHNldHRpbmdzLnByb2plY3RJZClcbiAgICAgICAgLmFwcGxpY2F0aW9uKHNldHRpbmdzLmFwcGxpY2F0aW9uSWQpXG4gICAgICAgIC5yZWFkKClcblxuICAgIGxvZygnQXBwbGljYXRpb24nLCAnZmV0Y2hlZCcsIGFwcClcbiAgICByZXR1cm4gbmV3IEVWVC5BcHAoYXBwLmFwcEFwaUtleSlcbn1cblxuYXN5bmMgZnVuY3Rpb24gY3JlYXRlVXNlciAoYXBwKSB7XG4gICAgbGV0IHVzZXIgPSBhd2FpdCBhcHAuYXBwVXNlcigpLmNyZWF0ZSh7IGFub255bW91czogdHJ1ZSB9KVxuICAgIGxvZygnVXNlcicsICdjcmVhdGVkJywgdXNlcilcbiAgICByZXR1cm4gbmV3IEVWVC5Vc2VyKHVzZXIsIGFwcClcbn1cblxuYXN5bmMgZnVuY3Rpb24gY3JlYXRlQ29sbGVjdGlvbiAodXNlcikge1xuICAgIGxldCBjb2xsZWN0aW9uID0gYXdhaXQgdXNlci5jb2xsZWN0aW9uKCkuY3JlYXRlKHtcbiAgICAgICAgJ25hbWUnOiBgJHtQUkVGSVh9IENvbGxlY3Rpb25gLFxuICAgIH0pXG5cbiAgICBsb2coJ0NvbGxlY3Rpb24nLCAnY3JlYXRlZCcsIGNvbGxlY3Rpb24pXG4gICAgcmV0dXJuIGNvbGxlY3Rpb25cbn1cblxuYXN5bmMgZnVuY3Rpb24gY3JlYXRlVGhuZyAodXNlciwgcnVsZXMsIHByb3BlcnRpZXMpIHtcbiAgICBsZXQgdGhuZyA9IGF3YWl0IHVzZXIudGhuZygpLmNyZWF0ZSh7XG4gICAgICAgICduYW1lJzogYCR7UFJFRklYfSBUaG5nYCxcbiAgICAgICAgJ3Byb3BlcnRpZXMnOiBfLmFzc2lnbihwcm9wZXJ0aWVzLCBydWxlcyksXG4gICAgfSlcblxuICAgIGxvZygnVGhuZycsICdjcmVhdGVkJywgdGhuZylcbiAgICByZXR1cm4gdXNlci50aG5nKHRobmcuaWQpXG59XG5cbmFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUFjdGlvblR5cGVzIChuYW1lcykge1xuICAgIGxldCBhY3Rpb25UeXBlcyA9IFByb21pc2UuYWxsKG5hbWVzLm1hcChhc3luYyAobmFtZSkgPT4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgbGV0IGFjdGlvblR5cGUgPSBhd2FpdCBvcGVyYXRvci5hY3Rpb25UeXBlKCkuY3JlYXRlKHsgbmFtZSB9KVxuXG4gICAgICAgICAgICBsb2coJ0FjdGlvblR5cGUnLCAnY3JlYXRlZCcsIGFjdGlvblR5cGUpXG5cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGlmIChlcnJvci5zdGF0dXMgIT09IDQwOSlcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKEpTT04uc3RyaW5naWZ5KGVycm9yKSlcbiAgICAgICAgfVxuICAgIH0pKVxufVxuXG5hc3luYyBmdW5jdGlvbiByZWFkUmVhY3RvclN0YXR1cyAoYXBwRGF0YSkge1xuICAgIGNvbnNvbGUubG9nKFxuICAgICAgICBgR2V0dGluZyB0aGUgUkVBQ1RPUiBzdGF0dXMgZm9yIEFwcCAnJHthcHBEYXRhLm5hbWV9JyB3aXRoIElEICcke2FwcERhdGEuaWR9Jy4uLmApXG5cbiAgICBsZXQgc3RhdHVzID0gYXdhaXQgcmVxdWVzdC5nZXQoe1xuICAgICAgICB1cmw6IGBodHRwczovL2FwaS5ldnJ5dGhuZy5jb20vJHthcHBEYXRhLnJlc291cmNlLnBhdGh9L3JlYWN0b3JTY3JpcHQvc3RhdHVzYCxcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgJ0FjY2VwdCc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgICdBdXRob3JpemF0aW9uJzogc2V0dGluZ3Mub3BlcmF0b3JLZXksXG4gICAgICAgIH1cbiAgICB9KVxuXG4gICAgY29uc29sZS5sb2coYFJFQUNUT1Igc3RhdHVzOiAke3N0YXR1c31gKVxuICAgIHJldHVybiBzdGF0dXNcbn1cblxudGVzdCgnUkVBQ1RPUicsIGFzeW5jICh0KSA9PiB7XG4gICAgLy9sZXQgcHJvamVjdCA9IGF3YWl0IGNyZWF0ZVByb2plY3Qob3BlcmF0b3IpXG4gICAgLy9sZXQgYXBwID0gYXdhaXQgY3JlYXRlQXBwKHByb2plY3QpXG4gICAgbGV0IHByb2plY3QgPSBhd2FpdCBmZXRjaFByb2plY3Qoc2V0dGluZ3MpXG4gICAgbGV0IGFwcCA9IGF3YWl0IGZldGNoQXBwKHNldHRpbmdzKVxuICAgIGxldCB1c2VyID0gYXdhaXQgY3JlYXRlVXNlcihhcHApXG4gICAgbGV0IGNvbGxlY3Rpb24gPSBhd2FpdCBjcmVhdGVDb2xsZWN0aW9uKHVzZXIpXG4gICAgYXdhaXQgY3JlYXRlQWN0aW9uVHlwZXMoWydfZGltJywgJ19vbicsICdfb2ZmJ10pXG5cbiAgICBsZXQgcnVsZSA9IGdldFNhbXBsZVJ1bGUoKVxuICAgIHJ1bGUuY29uZGl0aW9ucyA9IFtcbiAgICAgICAge1xuICAgICAgICAgICAgJ3ZhcmlhYmxlJzogJ29jY3VwYW5jeV9kZXRlY3RlZCcsXG4gICAgICAgICAgICAnb3BlcmF0b3InOiAnPScsXG4gICAgICAgICAgICAndmFsdWUnOiB0cnVlLFxuICAgICAgICAgICAgJ2xvZ2ljYWxfb3BlcmF0b3InOiAnYW5kJyxcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgJ3ZhcmlhYmxlJzogJ2FtYmllbnRfbGlnaHQnLFxuICAgICAgICAgICAgJ29wZXJhdG9yJzogJz4nLFxuICAgICAgICAgICAgJ3ZhbHVlJzogMTAsXG4gICAgICAgICAgICAnbG9naWNhbF9vcGVyYXRvcic6IG51bGwsXG4gICAgICAgIH0sXG4gICAgXVxuICAgIHJ1bGUub3BlcmF0aW9ucyA9IFtcbiAgICAgICAge1xuICAgICAgICAgICAgJ2NvbGxlY3Rpb25zJzogW1xuICAgICAgICAgICAgICAgIGNvbGxlY3Rpb24uaWRcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAnYWN0aW9ucyc6IFtcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICduYW1lJzogJ19vZmYnXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICduYW1lJzogJ19kaW0nLFxuICAgICAgICAgICAgICAgICAgICAncGFyYW1ldGVycyc6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICd2YWx1ZSc6IDFcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF1cbiAgICAgICAgfVxuICAgIF1cblxuICAgIGxldCBydWxlcyA9IHsgJ19fcnVsZV9fNzgyODcyODcwMDEwMSc6IHJ1bGUgfVxuXG4gICAgbGV0IHByb3BlcnRpZXMgPSB7XG4gICAgICAgICdvY2N1cGFuY3lfZGV0ZWN0ZWQnOiBmYWxzZSxcbiAgICAgICAgJ2FtYmllbnRfbGlnaHQnOiA5LFxuICAgIH1cblxuICAgIGxldCB0aG5nID0gYXdhaXQgY3JlYXRlVGhuZyh1c2VyLCBydWxlcywgcHJvcGVydGllcylcblxuICAgIGxldCBwcm9wcyA9IGF3YWl0IHRobmcucHJvcGVydHkoJ2FtYmllbnRfbGlnaHQnKS51cGRhdGUoMTEpXG4gICAgbGV0IGFtYmllbnRfbGlnaHQgPSBwcm9wc1swXS52YWx1ZVxuICAgIHQuZXF1YWwoYW1iaWVudF9saWdodCwgMTEpXG5cbiAgICBwcm9wcyA9IGF3YWl0IHRobmcucHJvcGVydHkoJ29jY3VwYW5jeV9kZXRlY3RlZCcpLnVwZGF0ZSh0cnVlKVxuICAgIGxldCBvY2N1cGFuY3lfZGV0ZWN0ZWQgPSBwcm9wc1swXS52YWx1ZVxuICAgIHQuZXF1YWwob2NjdXBhbmN5X2RldGVjdGVkLCB0cnVlKVxuXG4gICAgbGV0IGFjdGlvbnMgPSBhd2FpdCBvcGVyYXRvci5hY3Rpb24oJ2FsbCcpLnJlYWQoKVxufSlcbiJdfQ==",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "integration.test.js"
      ],
      "names": [
        "project",
        "operator",
        "create",
        "PREFIX",
        "log",
        "id",
        "createProject",
        "app",
        "application",
        "EVT",
        "App",
        "appApiKey",
        "createApp",
        "settings",
        "projectId",
        "read",
        "fetchProject",
        "applicationId",
        "fetchApp",
        "user",
        "appUser",
        "anonymous",
        "User",
        "createUser",
        "collection",
        "createCollection",
        "rules",
        "properties",
        "thng",
        "_",
        "assign",
        "createThng",
        "names",
        "actionTypes",
        "Promise",
        "all",
        "map",
        "name",
        "actionType",
        "error",
        "status",
        "console",
        "JSON",
        "stringify",
        "createActionTypes",
        "appData",
        "request",
        "get",
        "url",
        "resource",
        "path",
        "headers",
        "operatorKey",
        "readReactorStatus",
        "require",
        "fs",
        "test",
        "BASE_DIR",
        "__dirname",
        "Operator",
        "getSampleRule",
        "rule",
        "parse",
        "readFileSync",
        "objectType",
        "verb",
        "obj",
        "t",
        "conditions",
        "operations",
        "props",
        "property",
        "update",
        "ambient_light",
        "value",
        "equal",
        "occupancy_detected",
        "actions",
        "action"
      ],
      "mappings": "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",
      "file": "integration.test.js",
      "sourceRoot": "/Users/dtr/gooee/REACTOR/tests",
      "sourcesContent": [
        "'use strict'\nlet _ = require('lodash')\nlet EVT = require('evrythng-extended')\nlet fs = require('fs')\nlet request = require('request-promise')\nlet test = require('blue-tape')\n\nlet BASE_DIR = `${__dirname}/..`\nlet PREFIX = 'REACTOR'\n\nlet settings = require(`${BASE_DIR}/uploadSettings.json`)\n\nlet operator = new EVT.Operator(settings.operatorKey)\n\nfunction getSampleRule () {\n    let rule = JSON.parse(fs.readFileSync(`${BASE_DIR}/tests/shared/rules-sample-1.json`, 'utf8'))\n    rule.name = `${PREFIX} Rule`\n    return rule\n}\n\nfunction log (objectType, verb, obj) {\n    console.log(`${objectType} '${obj.name}' ${verb} with ID '${obj.id}'`)\n}\n\nasync function createProject () {\n    let project = await operator.project().create({\n        'name': `${PREFIX} Project`\n    })\n\n    log('Project', 'created', project)\n    return operator.project(project.id)\n}\n\nasync function createApp (project) {\n    let app = await project.application().create({\n        'name': `${PREFIX} Application`,\n        'socialNetworks': {},\n    })\n\n    log('Application', 'created', app)\n    return new EVT.App(app.appApiKey)\n}\n\nasync function fetchProject (settings) {\n    let project = await operator\n        .project(settings.projectId)\n        .read()\n\n    log('Project', 'fetched', project)\n    return operator.project(settings.projectId)\n}\n\nasync function fetchApp (settings) {\n    let app = await operator\n        .project(settings.projectId)\n        .application(settings.applicationId)\n        .read()\n\n    log('Application', 'fetched', app)\n    return new EVT.App(app.appApiKey)\n}\n\nasync function createUser (app) {\n    let user = await app.appUser().create({ anonymous: true })\n    log('User', 'created', user)\n    return new EVT.User(user, app)\n}\n\nasync function createCollection (user) {\n    let collection = await user.collection().create({\n        'name': `${PREFIX} Collection`,\n    })\n\n    log('Collection', 'created', collection)\n    return collection\n}\n\nasync function createThng (user, rules, properties) {\n    let thng = await user.thng().create({\n        'name': `${PREFIX} Thng`,\n        'properties': _.assign(properties, rules),\n    })\n\n    log('Thng', 'created', thng)\n    return user.thng(thng.id)\n}\n\nasync function createActionTypes (names) {\n    let actionTypes = Promise.all(names.map(async (name) => {\n        try {\n            let actionType = await operator.actionType().create({ name })\n\n            log('ActionType', 'created', actionType)\n\n        } catch (error) {\n            if (error.status !== 409)\n                console.error(JSON.stringify(error))\n        }\n    }))\n}\n\nasync function readReactorStatus (appData) {\n    console.log(\n        `Getting the REACTOR status for App '${appData.name}' with ID '${appData.id}'...`)\n\n    let status = await request.get({\n        url: `https://api.evrythng.com/${appData.resource.path}/reactorScript/status`,\n        headers: {\n            'Accept': 'application/json',\n            'Authorization': settings.operatorKey,\n        }\n    })\n\n    console.log(`REACTOR status: ${status}`)\n    return status\n}\n\ntest('REACTOR', async (t) => {\n    //let project = await createProject(operator)\n    //let app = await createApp(project)\n    let project = await fetchProject(settings)\n    let app = await fetchApp(settings)\n    let user = await createUser(app)\n    let collection = await createCollection(user)\n    await createActionTypes(['_dim', '_on', '_off'])\n\n    let rule = getSampleRule()\n    rule.conditions = [\n        {\n            'variable': 'occupancy_detected',\n            'operator': '=',\n            'value': true,\n            'logical_operator': 'and',\n        },\n        {\n            'variable': 'ambient_light',\n            'operator': '>',\n            'value': 10,\n            'logical_operator': null,\n        },\n    ]\n    rule.operations = [\n        {\n            'collections': [\n                collection.id\n            ],\n            'actions': [\n                {\n                    'name': '_off'\n                },\n                {\n                    'name': '_dim',\n                    'parameters': {\n                        'value': 1\n                    }\n                }\n            ]\n        }\n    ]\n\n    let rules = { '__rule__7828728700101': rule }\n\n    let properties = {\n        'occupancy_detected': false,\n        'ambient_light': 9,\n    }\n\n    let thng = await createThng(user, rules, properties)\n\n    let props = await thng.property('ambient_light').update(11)\n    let ambient_light = props[0].value\n    t.equal(ambient_light, 11)\n\n    props = await thng.property('occupancy_detected').update(true)\n    let occupancy_detected = props[0].value\n    t.equal(occupancy_detected, true)\n\n    let actions = await operator.action('all').read()\n})\n"
      ]
    },
    "mtime": 1472579343000
  },
  "{\"filename\":\"/Users/dtr/gooee/REACTOR/tests/integration.test.js\",\"env\":{},\"retainLines\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"presets\":[],\"plugins\":[[[],null],[[],null]],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"minified\":false,\"sourceRoot\":\"/Users/dtr/gooee/REACTOR/tests\",\"babelrc\":true,\"sourceType\":\"module\",\"moduleIds\":false,\"passPerPreset\":false}:6.14.0": {
    "metadata": {
      "usedHelpers": [
        "asyncToGenerator"
      ],
      "marked": [],
      "modules": {
        "imports": [],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      }
    },
    "options": {
      "filename": "/Users/dtr/gooee/REACTOR/tests/integration.test.js",
      "filenameRelative": "/Users/dtr/gooee/REACTOR/tests/integration.test.js",
      "env": {},
      "retainLines": false,
      "highlightCode": true,
      "suppressDeprecationMessages": false,
      "presets": [],
      "plugins": [
        [
          [],
          null
        ],
        [
          [],
          null
        ]
      ],
      "ignore": [],
      "code": true,
      "metadata": true,
      "ast": false,
      "comments": true,
      "compact": "auto",
      "minified": false,
      "sourceMaps": "both",
      "sourceMapTarget": "integration.test.js",
      "sourceFileName": "integration.test.js",
      "sourceRoot": "/Users/dtr/gooee/REACTOR/tests",
      "babelrc": false,
      "sourceType": "module",
      "moduleRoot": "/Users/dtr/gooee/REACTOR/tests",
      "moduleIds": false,
      "passPerPreset": false,
      "basename": "integration.test"
    },
    "ignored": false,
    "code": "'use strict';\n\nlet createProject = (() => {\n    var _ref = _asyncToGenerator(function* () {\n        let project = yield operator.project().create({\n            'name': `${ PREFIX } Project`\n        });\n\n        log('Project', 'created', project);\n        return operator.project(project.id);\n    });\n\n    return function createProject() {\n        return _ref.apply(this, arguments);\n    };\n})();\n\nlet createApp = (() => {\n    var _ref2 = _asyncToGenerator(function* (project) {\n        let app = yield project.application().create({\n            'name': `${ PREFIX } Application`,\n            'socialNetworks': {}\n        });\n\n        log('Application', 'created', app);\n        return new EVT.App(app.appApiKey);\n    });\n\n    return function createApp(_x) {\n        return _ref2.apply(this, arguments);\n    };\n})();\n\nlet fetchProject = (() => {\n    var _ref3 = _asyncToGenerator(function* (settings) {\n        let project = yield operator.project(settings.projectId).read();\n\n        log('Project', 'fetched', project);\n        return operator.project(settings.projectId);\n    });\n\n    return function fetchProject(_x2) {\n        return _ref3.apply(this, arguments);\n    };\n})();\n\nlet fetchApp = (() => {\n    var _ref4 = _asyncToGenerator(function* (settings) {\n        let app = yield operator.project(settings.projectId).application(settings.applicationId).read();\n\n        log('Application', 'fetched', app);\n        return new EVT.App(app.appApiKey);\n    });\n\n    return function fetchApp(_x3) {\n        return _ref4.apply(this, arguments);\n    };\n})();\n\nlet createUser = (() => {\n    var _ref5 = _asyncToGenerator(function* (app) {\n        let user = yield app.appUser().create({ anonymous: true });\n        log('User', 'created', user);\n        return new EVT.User(user, app);\n    });\n\n    return function createUser(_x4) {\n        return _ref5.apply(this, arguments);\n    };\n})();\n\nlet createCollection = (() => {\n    var _ref6 = _asyncToGenerator(function* (user) {\n        let collection = yield user.collection().create({\n            'name': `${ PREFIX } Collection`\n        });\n\n        log('Collection', 'created', collection);\n        return collection;\n    });\n\n    return function createCollection(_x5) {\n        return _ref6.apply(this, arguments);\n    };\n})();\n\nlet createThng = (() => {\n    var _ref7 = _asyncToGenerator(function* (user, rules, properties) {\n        let thng = yield user.thng().create({\n            'name': `${ PREFIX } Thng`,\n            'properties': _.assign(properties, rules)\n        });\n\n        log('Thng', 'created', thng);\n        return user.thng(thng.id);\n    });\n\n    return function createThng(_x6, _x7, _x8) {\n        return _ref7.apply(this, arguments);\n    };\n})();\n\nlet createActionTypes = (() => {\n    var _ref8 = _asyncToGenerator(function* (names) {\n        let actionTypes = Promise.all(names.map((() => {\n            var _ref9 = _asyncToGenerator(function* (name) {\n                try {\n                    let actionType = yield operator.actionType().create({ name });\n                    // TODO: rescope action types\n\n                    log('ActionType', 'created', actionType);\n                } catch (error) {\n                    if (error.status !== 409) console.error(JSON.stringify(error));\n                }\n            });\n\n            return function (_x10) {\n                return _ref9.apply(this, arguments);\n            };\n        })()));\n    });\n\n    return function createActionTypes(_x9) {\n        return _ref8.apply(this, arguments);\n    };\n})();\n\nlet readReactorStatus = (() => {\n    var _ref10 = _asyncToGenerator(function* (appData) {\n        console.log(`Getting the REACTOR status for App '${ appData.name }' with ID '${ appData.id }'...`);\n\n        let status = yield request.get({\n            url: `https://api.evrythng.com/${ appData.resource.path }/reactorScript/status`,\n            headers: {\n                'Accept': 'application/json',\n                'Authorization': settings.operatorKey\n            }\n        });\n\n        console.log(`REACTOR status: ${ status }`);\n        return status;\n    });\n\n    return function readReactorStatus(_x11) {\n        return _ref10.apply(this, arguments);\n    };\n})();\n\nlet deleteAllActions = (() => {\n    var _ref11 = _asyncToGenerator(function* (user) {\n        yield user.action('all').read().then(function (actions) {\n\n            return Promise.all(_.map(actions, function (action) {\n                return operator.action(action.type, action.id).delete();\n            })).catch(function (error) {\n                console.log(`Error deleting Actions: ${ JSON.stringify(error, null, 2) }`);\n            });\n        });\n\n        console.log('All Actions deleted');\n    });\n\n    return function deleteAllActions(_x12) {\n        return _ref11.apply(this, arguments);\n    };\n})();\n\nlet setupFixtures = (() => {\n    var _ref12 = _asyncToGenerator(function* () {\n        //let project = await createProject(operator)\n        //let app = await createApp(project)\n        let project = yield fetchProject(settings);\n        let app = yield fetchApp(settings);\n        let user = yield createUser(app);\n        yield deleteAllActions(user);\n        let collection = yield createCollection(user);\n        yield createActionTypes(['_dim', '_on', '_off']);\n\n        return { project, app, user, collection };\n    });\n\n    return function setupFixtures() {\n        return _ref12.apply(this, arguments);\n    };\n})();\n\nlet tearDown = (() => {\n    var _ref13 = _asyncToGenerator(function* (fixtures) {\n        yield deleteAllActions(fixtures.user);\n    });\n\n    return function tearDown(_x13) {\n        return _ref13.apply(this, arguments);\n    };\n})();\n\nlet test1 = (() => {\n    var _ref14 = _asyncToGenerator(function* (t) {\n        var _ref15 = yield setupFixtures();\n\n        let project = _ref15.project;\n        let app = _ref15.app;\n        let user = _ref15.user;\n        let collection = _ref15.collection;\n\n        let rule = getSampleRule();\n        rule.conditions = [{\n            'variable': 'occupancy_detected',\n            'operator': '=',\n            'value': true,\n            'logical_operator': 'and'\n        }, {\n            'variable': 'ambient_light',\n            'operator': '>',\n            'value': 10,\n            'logical_operator': null\n        }];\n        rule.operations = [{\n            'collections': [collection.id],\n            'actions': [{\n                'name': '_off'\n            }, {\n                'name': '_dim',\n                'parameters': {\n                    'value': 1\n                }\n            }]\n        }];\n\n        let rules = { '__rule__7828728700101': rule };\n\n        let properties = {\n            'occupancy_detected': false,\n            'ambient_light': 9\n        };\n\n        let actions = yield user.action('all').read();\n        t.equal(actions.length, 0);\n\n        let thng = yield createThng(user, rules, properties);\n\n        sleep.sleep(1);\n        actions = yield user.action('all').read();\n        t.equal(actions.length, 0);\n\n        let props = yield thng.property('ambient_light').update(11);\n        let ambient_light = props[0].value;\n        t.equal(ambient_light, 11);\n\n        props = yield thng.property('occupancy_detected').update(true);\n        let occupancy_detected = props[0].value;\n        t.equal(occupancy_detected, true);\n\n        sleep.sleep(1);\n\n        actions = yield user.action('all').read();\n\n        t.equal(actions.length, 2);\n\n        yield tearDown({ user });\n    });\n\n    return function test1(_x14) {\n        return _ref14.apply(this, arguments);\n    };\n})();\n\nlet test2 = (() => {\n    var _ref16 = _asyncToGenerator(function* (t) {\n        var _ref17 = yield setupFixtures();\n\n        let project = _ref17.project;\n        let app = _ref17.app;\n        let user = _ref17.user;\n        let collection = _ref17.collection;\n\n        let rule = getSampleRule();\n        let today = moment.utc().format('ddd').toLowerCase();\n        console.log(today);\n        rule.conditions = [{\n            'variable': 'day_of_week',\n            'operator': '=',\n            'value': [today],\n            'logical_operator': 'and'\n        }, {\n            'variable': 'occupancy_detected',\n            'operator': '=',\n            'value': false,\n            'logical_operator': null\n        }];\n        rule.operations = [{\n            'collections': [collection.id],\n            'actions': [{\n                'name': '_dim',\n                'parameters': {\n                    'value': 5\n                }\n            }]\n        }];\n\n        let rules = { '__rule__7828728700101': rule };\n\n        let properties = {\n            'occupancy_detected': false,\n            'colour_temperature': 3\n        };\n\n        let actions = yield user.action('all').read();\n        t.equal(actions.length, 0);\n\n        let thng = yield createThng(user, rules, properties);\n\n        sleep.sleep(1);\n        actions = yield user.action('all').read();\n        t.equal(actions.length, 1);\n        t.equal(actions[0].type, '_dim');\n        t.equal(actions[0].customFields.value, 5);\n\n        // This update should, since we've waited.\n        let props = yield thng.property('colour_temperature').update(4);\n        let colour_temperature = props[0].value;\n        t.equal(colour_temperature, 4);\n\n        sleep.sleep(1);\n        actions = yield user.action('all').read();\n        t.equal(actions.length, 2);\n\n        yield tearDown({ user });\n    });\n\n    return function test2(_x15) {\n        return _ref16.apply(this, arguments);\n    };\n})();\n\nlet test3 = (() => {\n    var _ref18 = _asyncToGenerator(function* (t) {\n        var _ref19 = yield setupFixtures();\n\n        let project = _ref19.project;\n        let app = _ref19.app;\n        let user = _ref19.user;\n        let collection = _ref19.collection;\n\n        let rule = getSampleRule();\n        let soon = moment.utc().add(5, 'seconds').format('HH:mm:ss');\n        rule.conditions = [{\n            'variable': 'time_of_day',\n            'operator': '>',\n            'value': soon,\n            'logical_operator': null\n        }];\n        rule.operations = [{\n            'collections': [collection.id],\n            'actions': [{\n                'name': '_on'\n            }]\n        }];\n\n        let rules = { '__rule__7828728700101': rule };\n\n        let properties = {\n            'ambient_light': 1\n        };\n\n        let actions = yield user.action('all').read();\n        t.equal(actions.length, 0);\n\n        let thng = yield createThng(user, rules, properties);\n\n        sleep.sleep(1);\n        actions = yield user.action('all').read();\n        t.equal(actions.length, 0);\n\n        // This update shouldn't trigger an action, since it's not time yet.\n        let props = yield thng.property('ambient_light').update(2);\n        let ambient_light = props[0].value;\n        t.equal(ambient_light, 2);\n\n        sleep.sleep(1);\n        actions = yield user.action('all').read();\n        t.equal(actions.length, 0);\n\n        sleep.sleep(3);\n\n        // This update should, since we've waited.\n        props = yield thng.property('ambient_light').update(3);\n        ambient_light = props[0].value;\n        t.equal(ambient_light, 3);\n\n        sleep.sleep(1);\n        actions = yield user.action('all').read();\n        t.equal(actions.length, 1);\n        t.equal(actions.length, 1);\n        t.equal(actions[0].type, '_on');\n\n        yield tearDown({ user });\n    });\n\n    return function test3(_x16) {\n        return _ref18.apply(this, arguments);\n    };\n})();\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { return step(\"next\", value); }, function (err) { return step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nlet _ = require('lodash');\nlet EVT = require('evrythng-extended');\nlet fs = require('fs');\nlet moment = require('moment');\nlet request = require('request-promise');\nlet sleep = require('sleep');\nlet test = require('blue-tape');\n\nlet BASE_DIR = `${ __dirname }/..`;\nlet PREFIX = 'REACTOR';\n\nlet settings = require(`${ BASE_DIR }/uploadSettings.json`);\n\nlet operator = new EVT.Operator(settings.operatorKey);\n\nfunction getSampleRule() {\n    let rule = JSON.parse(fs.readFileSync(`${ BASE_DIR }/tests/shared/rules-sample-1.json`, 'utf8'));\n    rule.name = `${ PREFIX } Rule`;\n    return rule;\n}\n\nfunction log(objectType, verb, obj) {\n    console.log(`${ objectType } '${ obj.name }' ${ verb } with ID '${ obj.id }'`);\n}\n\ntest('Integration tests', (() => {\n    var _ref20 = _asyncToGenerator(function* (t) {\n        yield test1(t);\n        yield test2(t);\n        yield test3(t);\n    });\n\n    return function (_x17) {\n        return _ref20.apply(this, arguments);\n    };\n})());\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImludGVncmF0aW9uLnRlc3QuanMiXSwibmFtZXMiOlsicHJvamVjdCIsIm9wZXJhdG9yIiwiY3JlYXRlIiwiUFJFRklYIiwibG9nIiwiaWQiLCJjcmVhdGVQcm9qZWN0IiwiYXBwIiwiYXBwbGljYXRpb24iLCJFVlQiLCJBcHAiLCJhcHBBcGlLZXkiLCJjcmVhdGVBcHAiLCJzZXR0aW5ncyIsInByb2plY3RJZCIsInJlYWQiLCJmZXRjaFByb2plY3QiLCJhcHBsaWNhdGlvbklkIiwiZmV0Y2hBcHAiLCJ1c2VyIiwiYXBwVXNlciIsImFub255bW91cyIsIlVzZXIiLCJjcmVhdGVVc2VyIiwiY29sbGVjdGlvbiIsImNyZWF0ZUNvbGxlY3Rpb24iLCJydWxlcyIsInByb3BlcnRpZXMiLCJ0aG5nIiwiXyIsImFzc2lnbiIsImNyZWF0ZVRobmciLCJuYW1lcyIsImFjdGlvblR5cGVzIiwiUHJvbWlzZSIsImFsbCIsIm1hcCIsIm5hbWUiLCJhY3Rpb25UeXBlIiwiZXJyb3IiLCJzdGF0dXMiLCJjb25zb2xlIiwiSlNPTiIsInN0cmluZ2lmeSIsImNyZWF0ZUFjdGlvblR5cGVzIiwiYXBwRGF0YSIsInJlcXVlc3QiLCJnZXQiLCJ1cmwiLCJyZXNvdXJjZSIsInBhdGgiLCJoZWFkZXJzIiwib3BlcmF0b3JLZXkiLCJyZWFkUmVhY3RvclN0YXR1cyIsImFjdGlvbiIsInRoZW4iLCJhY3Rpb25zIiwidHlwZSIsImRlbGV0ZSIsImNhdGNoIiwiZGVsZXRlQWxsQWN0aW9ucyIsInNldHVwRml4dHVyZXMiLCJmaXh0dXJlcyIsInRlYXJEb3duIiwidCIsInJ1bGUiLCJnZXRTYW1wbGVSdWxlIiwiY29uZGl0aW9ucyIsIm9wZXJhdGlvbnMiLCJlcXVhbCIsImxlbmd0aCIsInNsZWVwIiwicHJvcHMiLCJwcm9wZXJ0eSIsInVwZGF0ZSIsImFtYmllbnRfbGlnaHQiLCJ2YWx1ZSIsIm9jY3VwYW5jeV9kZXRlY3RlZCIsInRlc3QxIiwidG9kYXkiLCJtb21lbnQiLCJ1dGMiLCJmb3JtYXQiLCJ0b0xvd2VyQ2FzZSIsImN1c3RvbUZpZWxkcyIsImNvbG91cl90ZW1wZXJhdHVyZSIsInRlc3QyIiwic29vbiIsImFkZCIsInRlc3QzIiwicmVxdWlyZSIsImZzIiwidGVzdCIsIkJBU0VfRElSIiwiX19kaXJuYW1lIiwiT3BlcmF0b3IiLCJwYXJzZSIsInJlYWRGaWxlU3luYyIsIm9iamVjdFR5cGUiLCJ2ZXJiIiwib2JqIl0sIm1hcHBpbmdzIjoiQUFBQTs7O2lDQTBCQSxhQUFnQztBQUM1QixZQUFJQSxVQUFVLE1BQU1DLFNBQVNELE9BQVQsR0FBbUJFLE1BQW5CLENBQTBCO0FBQzFDLG9CQUFTLElBQUVDLE1BQU87QUFEd0IsU0FBMUIsQ0FBcEI7O0FBSUFDLFlBQUksU0FBSixFQUFlLFNBQWYsRUFBMEJKLE9BQTFCO0FBQ0EsZUFBT0MsU0FBU0QsT0FBVCxDQUFpQkEsUUFBUUssRUFBekIsQ0FBUDtBQUNILEs7O29CQVBjQyxhOzs7Ozs7a0NBU2YsV0FBMEJOLE9BQTFCLEVBQW1DO0FBQy9CLFlBQUlPLE1BQU0sTUFBTVAsUUFBUVEsV0FBUixHQUFzQk4sTUFBdEIsQ0FBNkI7QUFDekMsb0JBQVMsSUFBRUMsTUFBTyxlQUR1QjtBQUV6Qyw4QkFBa0I7QUFGdUIsU0FBN0IsQ0FBaEI7O0FBS0FDLFlBQUksYUFBSixFQUFtQixTQUFuQixFQUE4QkcsR0FBOUI7QUFDQSxlQUFPLElBQUlFLElBQUlDLEdBQVIsQ0FBWUgsSUFBSUksU0FBaEIsQ0FBUDtBQUNILEs7O29CQVJjQyxTOzs7Ozs7a0NBVWYsV0FBNkJDLFFBQTdCLEVBQXVDO0FBQ25DLFlBQUliLFVBQVUsTUFBTUMsU0FDZkQsT0FEZSxDQUNQYSxTQUFTQyxTQURGLEVBRWZDLElBRmUsRUFBcEI7O0FBSUFYLFlBQUksU0FBSixFQUFlLFNBQWYsRUFBMEJKLE9BQTFCO0FBQ0EsZUFBT0MsU0FBU0QsT0FBVCxDQUFpQmEsU0FBU0MsU0FBMUIsQ0FBUDtBQUNILEs7O29CQVBjRSxZOzs7Ozs7a0NBU2YsV0FBeUJILFFBQXpCLEVB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T0FBSThELElBQUssZUFBWUMsSUFBSS9GLEVBQUcsSUFBbkU7QUFDSDs7QUF3VUR1RixLQUFLLG1CQUFMO0FBQUEsbUNBQTBCLFdBQU81QixDQUFQLEVBQWE7QUFDbkMsY0FBTWMsTUFBTWQsQ0FBTixDQUFOO0FBQ0EsY0FBTXNCLE1BQU10QixDQUFOLENBQU47QUFDQSxjQUFNeUIsTUFBTXpCLENBQU4sQ0FBTjtBQUNILEtBSkQ7O0FBQUE7QUFBQTtBQUFBO0FBQUEiLCJmaWxlIjoiaW50ZWdyYXRpb24udGVzdC5qcyIsInNvdXJjZVJvb3QiOiIvVXNlcnMvZHRyL2dvb2VlL1JFQUNUT1IvdGVzdHMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCdcbmxldCBfID0gcmVxdWlyZSgnbG9kYXNoJylcbmxldCBFVlQgPSByZXF1aXJlKCdldnJ5dGhuZy1leHRlbmRlZCcpXG5sZXQgZnMgPSByZXF1aXJlKCdmcycpXG5sZXQgbW9tZW50ID0gcmVxdWlyZSgnbW9tZW50JylcbmxldCByZXF1ZXN0ID0gcmVxdWlyZSgncmVxdWVzdC1wcm9taXNlJylcbmxldCBzbGVlcCA9IHJlcXVpcmUoJ3NsZWVwJylcbmxldCB0ZXN0ID0gcmVxdWlyZSgnYmx1ZS10YXBlJylcblxubGV0IEJBU0VfRElSID0gYCR7X19kaXJuYW1lfS8uLmBcbmxldCBQUkVGSVggPSAnUkVBQ1RPUidcblxubGV0IHNldHRpbmdzID0gcmVxdWlyZShgJHtCQVNFX0RJUn0vdXBsb2FkU2V0dGluZ3MuanNvbmApXG5cbmxldCBvcGVyYXRvciA9IG5ldyBFVlQuT3BlcmF0b3Ioc2V0dGluZ3Mub3BlcmF0b3JLZXkpXG5cbmZ1bmN0aW9uIGdldFNhbXBsZVJ1bGUgKCkge1xuICAgIGxldCBydWxlID0gSlNPTi5wYXJzZShmcy5yZWFkRmlsZVN5bmMoYCR7QkFTRV9ESVJ9L3Rlc3RzL3NoYXJlZC9ydWxlcy1zYW1wbGUtMS5qc29uYCwgJ3V0ZjgnKSlcbiAgICBydWxlLm5hbWUgPSBgJHtQUkVGSVh9IFJ1bGVgXG4gICAgcmV0dXJuIHJ1bGVcbn1cblxuZnVuY3Rpb24gbG9nIChvYmplY3RUeXBlLCB2ZXJiLCBvYmopIHtcbiAgICBjb25zb2xlLmxvZyhgJHtvYmplY3RUeXBlfSAnJHtvYmoubmFtZX0nICR7dmVyYn0gd2l0aCBJRCAnJHtvYmouaWR9J2ApXG59XG5cbmFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVByb2plY3QgKCkge1xuICAgIGxldCBwcm9qZWN0ID0gYXdhaXQgb3BlcmF0b3IucHJvamVjdCgpLmNyZWF0ZSh7XG4gICAgICAgICduYW1lJzogYCR7UFJFRklYfSBQcm9qZWN0YFxuICAgIH0pXG5cbiAgICBsb2coJ1Byb2plY3QnLCAnY3JlYXRlZCcsIHByb2plY3QpXG4gICAgcmV0dXJuIG9wZXJhdG9yLnByb2plY3QocHJvamVjdC5pZClcbn1cblxuYXN5bmMgZnVuY3Rpb24gY3JlYXRlQXBwIChwcm9qZWN0KSB7XG4gICAgbGV0IGFwcCA9IGF3YWl0IHByb2plY3QuYXBwbGljYXRpb24oKS5jcmVhdGUoe1xuICAgICAgICAnbmFtZSc6IGAke1BSRUZJWH0gQXBwbGljYXRpb25gLFxuICAgICAgICAnc29jaWFsTmV0d29ya3MnOiB7fSxcbiAgICB9KVxuXG4gICAgbG9nKCdBcHBsaWNhdGlvbicsICdjcmVhdGVkJywgYXBwKVxuICAgIHJldHVybiBuZXcgRVZULkFwcChhcHAuYXBwQXBpS2V5KVxufVxuXG5hc3luYyBmdW5jdGlvbiBmZXRjaFByb2plY3QgKHNldHRpbmdzKSB7XG4gICAgbGV0IHByb2plY3QgPSBhd2FpdCBvcGVyYXRvclxuICAgICAgICAucHJvamVjdChzZXR0aW5ncy5wcm9qZWN0SWQpXG4gICAgICAgIC5yZWFkKClcblxuICAgIGxvZygnUHJvamVjdCcsICdmZXRjaGVkJywgcHJvamVjdClcbiAgICByZXR1cm4gb3BlcmF0b3IucHJvamVjdChzZXR0aW5ncy5wcm9qZWN0SWQpXG59XG5cbmFzeW5jIGZ1bmN0aW9uIGZldGNoQXBwIChzZXR0aW5ncykge1xuICAgIGxldCBhcHAgPSBhd2FpdCBvcGVyYXRvclxuICAgICAgICAucHJvamVjdChzZXR0aW5ncy5wcm9qZWN0SWQpXG4gICAgICAgIC5hcHBsaWNhdGlvbihzZXR0aW5ncy5hcHBsaWNhdGlvbklkKVxuICAgICAgICAucmVhZCgpXG5cbiAgICBsb2coJ0FwcGxpY2F0aW9uJywgJ2ZldGNoZWQnLCBhcHApXG4gICAgcmV0dXJuIG5ldyBFVlQuQXBwKGFwcC5hcHBBcGlLZXkpXG59XG5cbmFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVVzZXIgKGFwcCkge1xuICAgIGxldCB1c2VyID0gYXdhaXQgYXBwLmFwcFVzZXIoKS5jcmVhdGUoeyBhbm9ueW1vdXM6IHRydWUgfSlcbiAgICBsb2coJ1VzZXInLCAnY3JlYXRlZCcsIHVzZXIpXG4gICAgcmV0dXJuIG5ldyBFVlQuVXNlcih1c2VyLCBhcHApXG59XG5cbmFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUNvbGxlY3Rpb24gKHVzZXIpIHtcbiAgICBsZXQgY29sbGVjdGlvbiA9IGF3YWl0IHVzZXIuY29sbGVjdGlvbigpLmNyZWF0ZSh7XG4gICAgICAgICduYW1lJzogYCR7UFJFRklYfSBDb2xsZWN0aW9uYCxcbiAgICB9KVxuXG4gICAgbG9nKCdDb2xsZWN0aW9uJywgJ2NyZWF0ZWQnLCBjb2xsZWN0aW9uKVxuICAgIHJldHVybiBjb2xsZWN0aW9uXG59XG5cbmFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVRobmcgKHVzZXIsIHJ1bGVzLCBwcm9wZXJ0aWVzKSB7XG4gICAgbGV0IHRobmcgPSBhd2FpdCB1c2VyLnRobmcoKS5jcmVhdGUoe1xuICAgICAgICAnbmFtZSc6IGAke1BSRUZJWH0gVGhuZ2AsXG4gICAgICAgICdwcm9wZXJ0aWVzJzogXy5hc3NpZ24ocHJvcGVydGllcywgcnVsZXMpLFxuICAgIH0pXG5cbiAgICBsb2coJ1RobmcnLCAnY3JlYXRlZCcsIHRobmcpXG4gICAgcmV0dXJuIHVzZXIudGhuZyh0aG5nLmlkKVxufVxuXG5hc3luYyBmdW5jdGlvbiBjcmVhdGVBY3Rpb25UeXBlcyAobmFtZXMpIHtcbiAgICBsZXQgYWN0aW9uVHlwZXMgPSBQcm9taXNlLmFsbChuYW1lcy5tYXAoYXN5bmMgKG5hbWUpID0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGxldCBhY3Rpb25UeXBlID0gYXdhaXQgb3BlcmF0b3IuYWN0aW9uVHlwZSgpLmNyZWF0ZSh7IG5hbWUgfSlcbiAgICAgICAgICAgIC8vIFRPRE86IHJlc2NvcGUgYWN0aW9uIHR5cGVzXG5cbiAgICAgICAgICAgIGxvZygnQWN0aW9uVHlwZScsICdjcmVhdGVkJywgYWN0aW9uVHlwZSlcblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgaWYgKGVycm9yLnN0YXR1cyAhPT0gNDA5KVxuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoSlNPTi5zdHJpbmdpZnkoZXJyb3IpKVxuICAgICAgICB9XG4gICAgfSkpXG59XG5cbmFzeW5jIGZ1bmN0aW9uIHJlYWRSZWFjdG9yU3RhdHVzIChhcHBEYXRhKSB7XG4gICAgY29uc29sZS5sb2coXG4gICAgICAgIGBHZXR0aW5nIHRoZSBSRUFDVE9SIHN0YXR1cyBmb3IgQXBwICcke2FwcERhdGEubmFtZX0nIHdpdGggSUQgJyR7YXBwRGF0YS5pZH0nLi4uYClcblxuICAgIGxldCBzdGF0dXMgPSBhd2FpdCByZXF1ZXN0LmdldCh7XG4gICAgICAgIHVybDogYGh0dHBzOi8vYXBpLmV2cnl0aG5nLmNvbS8ke2FwcERhdGEucmVzb3VyY2UucGF0aH0vcmVhY3RvclNjcmlwdC9zdGF0dXNgLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAnQWNjZXB0JzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiBzZXR0aW5ncy5vcGVyYXRvcktleSxcbiAgICAgICAgfVxuICAgIH0pXG5cbiAgICBjb25zb2xlLmxvZyhgUkVBQ1RPUiBzdGF0dXM6ICR7c3RhdHVzfWApXG4gICAgcmV0dXJuIHN0YXR1c1xufVxuXG5hc3luYyBmdW5jdGlvbiBkZWxldGVBbGxBY3Rpb25zICh1c2VyKSB7XG4gICAgYXdhaXQgdXNlci5hY3Rpb24oJ2FsbCcpLnJlYWQoKS50aGVuKChhY3Rpb25zKSA9PiB7XG5cbiAgICAgICAgcmV0dXJuIFByb21pc2UuYWxsKF8ubWFwKGFjdGlvbnMsIChhY3Rpb24pID0+IHtcbiAgICAgICAgICAgIHJldHVybiBvcGVyYXRvci5hY3Rpb24oYWN0aW9uLnR5cGUsIGFjdGlvbi5pZCkuZGVsZXRlKClcblxuICAgICAgICB9KSkuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhgRXJyb3IgZGVsZXRpbmcgQWN0aW9uczogJHtKU09OLnN0cmluZ2lmeShlcnJvciwgbnVsbCwgMil9YClcbiAgICAgICAgfSlcbiAgICB9KVxuXG4gICAgY29uc29sZS5sb2coJ0FsbCBBY3Rpb25zIGRlbGV0ZWQnKVxufVxuXG5hc3luYyBmdW5jdGlvbiBzZXR1cEZpeHR1cmVzICgpIHtcbiAgICAvL2xldCBwcm9qZWN0ID0gYXdhaXQgY3JlYXRlUHJvamVjdChvcGVyYXRvcilcbiAgICAvL2xldCBhcHAgPSBhd2FpdCBjcmVhdGVBcHAocHJvamVjdClcbiAgICBsZXQgcHJvamVjdCA9IGF3YWl0IGZldGNoUHJvamVjdChzZXR0aW5ncylcbiAgICBsZXQgYXBwID0gYXdhaXQgZmV0Y2hBcHAoc2V0dGluZ3MpXG4gICAgbGV0IHVzZXIgPSBhd2FpdCBjcmVhdGVVc2VyKGFwcClcbiAgICBhd2FpdCBkZWxldGVBbGxBY3Rpb25zKHVzZXIpXG4gICAgbGV0IGNvbGxlY3Rpb24gPSBhd2FpdCBjcmVhdGVDb2xsZWN0aW9uKHVzZXIpXG4gICAgYXdhaXQgY3JlYXRlQWN0aW9uVHlwZXMoWydfZGltJywgJ19vbicsICdfb2ZmJ10pXG5cbiAgICByZXR1cm4geyBwcm9qZWN0LCBhcHAsIHVzZXIsIGNvbGxlY3Rpb24gfVxufVxuXG5hc3luYyBmdW5jdGlvbiB0ZWFyRG93biAoZml4dHVyZXMpIHtcbiAgICBhd2FpdCBkZWxldGVBbGxBY3Rpb25zKGZpeHR1cmVzLnVzZXIpXG59XG5cbmFzeW5jIGZ1bmN0aW9uIHRlc3QxICh0KSB7XG4gICAgbGV0IHsgcHJvamVjdCwgYXBwLCB1c2VyLCBjb2xsZWN0aW9uIH0gPSBhd2FpdCBzZXR1cEZpeHR1cmVzKClcbiAgICBsZXQgcnVsZSA9IGdldFNhbXBsZVJ1bGUoKVxuICAgIHJ1bGUuY29uZGl0aW9ucyA9IFtcbiAgICAgICAge1xuICAgICAgICAgICAgJ3ZhcmlhYmxlJzogJ29jY3VwYW5jeV9kZXRlY3RlZCcsXG4gICAgICAgICAgICAnb3BlcmF0b3InOiAnPScsXG4gICAgICAgICAgICAndmFsdWUnOiB0cnVlLFxuICAgICAgICAgICAgJ2xvZ2ljYWxfb3BlcmF0b3InOiAnYW5kJyxcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgJ3ZhcmlhYmxlJzogJ2FtYmllbnRfbGlnaHQnLFxuICAgICAgICAgICAgJ29wZXJhdG9yJzogJz4nLFxuICAgICAgICAgICAgJ3ZhbHVlJzogMTAsXG4gICAgICAgICAgICAnbG9naWNhbF9vcGVyYXRvcic6IG51bGwsXG4gICAgICAgIH0sXG4gICAgXVxuICAgIHJ1bGUub3BlcmF0aW9ucyA9IFtcbiAgICAgICAge1xuICAgICAgICAgICAgJ2NvbGxlY3Rpb25zJzogW1xuICAgICAgICAgICAgICAgIGNvbGxlY3Rpb24uaWRcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAnYWN0aW9ucyc6IFtcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICduYW1lJzogJ19vZmYnXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICduYW1lJzogJ19kaW0nLFxuICAgICAgICAgICAgICAgICAgICAncGFyYW1ldGVycyc6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICd2YWx1ZSc6IDFcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF1cbiAgICAgICAgfVxuICAgIF1cblxuICAgIGxldCBydWxlcyA9IHsgJ19fcnVsZV9fNzgyODcyODcwMDEwMSc6IHJ1bGUgfVxuXG4gICAgbGV0IHByb3BlcnRpZXMgPSB7XG4gICAgICAgICdvY2N1cGFuY3lfZGV0ZWN0ZWQnOiBmYWxzZSxcbiAgICAgICAgJ2FtYmllbnRfbGlnaHQnOiA5LFxuICAgIH1cblxuICAgIGxldCBhY3Rpb25zID0gYXdhaXQgdXNlci5hY3Rpb24oJ2FsbCcpLnJlYWQoKVxuICAgIHQuZXF1YWwoYWN0aW9ucy5sZW5ndGgsIDApXG5cbiAgICBsZXQgdGhuZyA9IGF3YWl0IGNyZWF0ZVRobmcodXNlciwgcnVsZXMsIHByb3BlcnRpZXMpXG5cbiAgICBzbGVlcC5zbGVlcCgxKVxuICAgIGFjdGlvbnMgPSBhd2FpdCB1c2VyLmFjdGlvbignYWxsJykucmVhZCgpXG4gICAgdC5lcXVhbChhY3Rpb25zLmxlbmd0aCwgMClcblxuICAgIGxldCBwcm9wcyA9IGF3YWl0IHRobmcucHJvcGVydHkoJ2FtYmllbnRfbGlnaHQnKS51cGRhdGUoMTEpXG4gICAgbGV0IGFtYmllbnRfbGlnaHQgPSBwcm9wc1swXS52YWx1ZVxuICAgIHQuZXF1YWwoYW1iaWVudF9saWdodCwgMTEpXG5cbiAgICBwcm9wcyA9IGF3YWl0IHRobmcucHJvcGVydHkoJ29jY3VwYW5jeV9kZXRlY3RlZCcpLnVwZGF0ZSh0cnVlKVxuICAgIGxldCBvY2N1cGFuY3lfZGV0ZWN0ZWQgPSBwcm9wc1swXS52YWx1ZVxuICAgIHQuZXF1YWwob2NjdXBhbmN5X2RldGVjdGVkLCB0cnVlKVxuXG4gICAgc2xlZXAuc2xlZXAoMSlcblxuICAgIGFjdGlvbnMgPSBhd2FpdCB1c2VyLmFjdGlvbignYWxsJykucmVhZCgpXG5cbiAgICB0LmVxdWFsKGFjdGlvbnMubGVuZ3RoLCAyKVxuXG4gICAgYXdhaXQgdGVhckRvd24oeyB1c2VyIH0pXG59XG5cbmFzeW5jIGZ1bmN0aW9uIHRlc3QyICh0KSB7XG4gICAgbGV0IHsgcHJvamVjdCwgYXBwLCB1c2VyLCBjb2xsZWN0aW9uIH0gPSBhd2FpdCBzZXR1cEZpeHR1cmVzKClcbiAgICBsZXQgcnVsZSA9IGdldFNhbXBsZVJ1bGUoKVxuICAgIGxldCB0b2RheSA9IG1vbWVudC51dGMoKS5mb3JtYXQoJ2RkZCcpLnRvTG93ZXJDYXNlKClcbiAgICBjb25zb2xlLmxvZyh0b2RheSlcbiAgICBydWxlLmNvbmRpdGlvbnMgPSBbXG4gICAgICAgIHtcbiAgICAgICAgICAgICd2YXJpYWJsZSc6ICdkYXlfb2Zfd2VlaycsXG4gICAgICAgICAgICAnb3BlcmF0b3InOiAnPScsXG4gICAgICAgICAgICAndmFsdWUnOiBbXG4gICAgICAgICAgICAgICAgdG9kYXlcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAnbG9naWNhbF9vcGVyYXRvcic6ICdhbmQnLFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICAndmFyaWFibGUnOiAnb2NjdXBhbmN5X2RldGVjdGVkJyxcbiAgICAgICAgICAgICdvcGVyYXRvcic6ICc9JyxcbiAgICAgICAgICAgICd2YWx1ZSc6IGZhbHNlLFxuICAgICAgICAgICAgJ2xvZ2ljYWxfb3BlcmF0b3InOiBudWxsLFxuICAgICAgICB9LFxuICAgIF1cbiAgICBydWxlLm9wZXJhdGlvbnMgPSBbXG4gICAgICAgIHtcbiAgICAgICAgICAgICdjb2xsZWN0aW9ucyc6IFtcbiAgICAgICAgICAgICAgICBjb2xsZWN0aW9uLmlkXG4gICAgICAgICAgICBdLFxuICAgICAgICAgICAgJ2FjdGlvbnMnOiBbXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAnbmFtZSc6ICdfZGltJyxcbiAgICAgICAgICAgICAgICAgICAgJ3BhcmFtZXRlcnMnOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAndmFsdWUnOiA1XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgXVxuICAgICAgICB9XG4gICAgXVxuXG4gICAgbGV0IHJ1bGVzID0geyAnX19ydWxlX183ODI4NzI4NzAwMTAxJzogcnVsZSB9XG5cbiAgICBsZXQgcHJvcGVydGllcyA9IHtcbiAgICAgICAgJ29jY3VwYW5jeV9kZXRlY3RlZCc6IGZhbHNlLFxuICAgICAgICAnY29sb3VyX3RlbXBlcmF0dXJlJzogMyxcbiAgICB9XG5cbiAgICBsZXQgYWN0aW9ucyA9IGF3YWl0IHVzZXIuYWN0aW9uKCdhbGwnKS5yZWFkKClcbiAgICB0LmVxdWFsKGFjdGlvbnMubGVuZ3RoLCAwKVxuXG4gICAgbGV0IHRobmcgPSBhd2FpdCBjcmVhdGVUaG5nKHVzZXIsIHJ1bGVzLCBwcm9wZXJ0aWVzKVxuXG4gICAgc2xlZXAuc2xlZXAoMSlcbiAgICBhY3Rpb25zID0gYXdhaXQgdXNlci5hY3Rpb24oJ2FsbCcpLnJlYWQoKVxuICAgIHQuZXF1YWwoYWN0aW9ucy5sZW5ndGgsIDEpXG4gICAgdC5lcXVhbChhY3Rpb25zWzBdLnR5cGUsICdfZGltJylcbiAgICB0LmVxdWFsKGFjdGlvbnNbMF0uY3VzdG9tRmllbGRzLnZhbHVlLCA1KVxuXG4gICAgLy8gVGhpcyB1cGRhdGUgc2hvdWxkLCBzaW5jZSB3ZSd2ZSB3YWl0ZWQuXG4gICAgbGV0IHByb3BzID0gYXdhaXQgdGhuZy5wcm9wZXJ0eSgnY29sb3VyX3RlbXBlcmF0dXJlJykudXBkYXRlKDQpXG4gICAgbGV0IGNvbG91cl90ZW1wZXJhdHVyZSA9IHByb3BzWzBdLnZhbHVlXG4gICAgdC5lcXVhbChjb2xvdXJfdGVtcGVyYXR1cmUsIDQpXG5cbiAgICBzbGVlcC5zbGVlcCgxKVxuICAgIGFjdGlvbnMgPSBhd2FpdCB1c2VyLmFjdGlvbignYWxsJykucmVhZCgpXG4gICAgdC5lcXVhbChhY3Rpb25zLmxlbmd0aCwgMilcblxuICAgIGF3YWl0IHRlYXJEb3duKHsgdXNlciB9KVxufVxuICAgIFxuYXN5bmMgZnVuY3Rpb24gdGVzdDMgKHQpIHtcbiAgICBsZXQgeyBwcm9qZWN0LCBhcHAsIHVzZXIsIGNvbGxlY3Rpb24gfSA9IGF3YWl0IHNldHVwRml4dHVyZXMoKVxuICAgIGxldCBydWxlID0gZ2V0U2FtcGxlUnVsZSgpXG4gICAgbGV0IHNvb24gPSBtb21lbnQudXRjKCkuYWRkKDUsICdzZWNvbmRzJykuZm9ybWF0KCdISDptbTpzcycpXG4gICAgcnVsZS5jb25kaXRpb25zID0gW1xuICAgICAgICB7XG4gICAgICAgICAgICAndmFyaWFibGUnOiAndGltZV9vZl9kYXknLFxuICAgICAgICAgICAgJ29wZXJhdG9yJzogJz4nLFxuICAgICAgICAgICAgJ3ZhbHVlJzogc29vbixcbiAgICAgICAgICAgICdsb2dpY2FsX29wZXJhdG9yJzogbnVsbCxcbiAgICAgICAgfSxcbiAgICBdXG4gICAgcnVsZS5vcGVyYXRpb25zID0gW1xuICAgICAgICB7XG4gICAgICAgICAgICAnY29sbGVjdGlvbnMnOiBbXG4gICAgICAgICAgICAgICAgY29sbGVjdGlvbi5pZFxuICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICdhY3Rpb25zJzogW1xuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgJ25hbWUnOiAnX29uJ1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBdXG4gICAgICAgIH1cbiAgICBdXG5cbiAgICBsZXQgcnVsZXMgPSB7ICdfX3J1bGVfXzc4Mjg3Mjg3MDAxMDEnOiBydWxlIH1cblxuICAgIGxldCBwcm9wZXJ0aWVzID0ge1xuICAgICAgICAnYW1iaWVudF9saWdodCc6IDEsXG4gICAgfVxuXG4gICAgbGV0IGFjdGlvbnMgPSBhd2FpdCB1c2VyLmFjdGlvbignYWxsJykucmVhZCgpXG4gICAgdC5lcXVhbChhY3Rpb25zLmxlbmd0aCwgMClcblxuICAgIGxldCB0aG5nID0gYXdhaXQgY3JlYXRlVGhuZyh1c2VyLCBydWxlcywgcHJvcGVydGllcylcblxuICAgIHNsZWVwLnNsZWVwKDEpXG4gICAgYWN0aW9ucyA9IGF3YWl0IHVzZXIuYWN0aW9uKCdhbGwnKS5yZWFkKClcbiAgICB0LmVxdWFsKGFjdGlvbnMubGVuZ3RoLCAwKVxuXG4gICAgLy8gVGhpcyB1cGRhdGUgc2hvdWxkbid0IHRyaWdnZXIgYW4gYWN0aW9uLCBzaW5jZSBpdCdzIG5vdCB0aW1lIHlldC5cbiAgICBsZXQgcHJvcHMgPSBhd2FpdCB0aG5nLnByb3BlcnR5KCdhbWJpZW50X2xpZ2h0JykudXBkYXRlKDIpXG4gICAgbGV0IGFtYmllbnRfbGlnaHQgPSBwcm9wc1swXS52YWx1ZVxuICAgIHQuZXF1YWwoYW1iaWVudF9saWdodCwgMilcblxuICAgIHNsZWVwLnNsZWVwKDEpXG4gICAgYWN0aW9ucyA9IGF3YWl0IHVzZXIuYWN0aW9uKCdhbGwnKS5yZWFkKClcbiAgICB0LmVxdWFsKGFjdGlvbnMubGVuZ3RoLCAwKVxuXG4gICAgc2xlZXAuc2xlZXAoMylcblxuICAgIC8vIFRoaXMgdXBkYXRlIHNob3VsZCwgc2luY2Ugd2UndmUgd2FpdGVkLlxuICAgIHByb3BzID0gYXdhaXQgdGhuZy5wcm9wZXJ0eSgnYW1iaWVudF9saWdodCcpLnVwZGF0ZSgzKVxuICAgIGFtYmllbnRfbGlnaHQgPSBwcm9wc1swXS52YWx1ZVxuICAgIHQuZXF1YWwoYW1iaWVudF9saWdodCwgMylcblxuICAgIHNsZWVwLnNsZWVwKDEpXG4gICAgYWN0aW9ucyA9IGF3YWl0IHVzZXIuYWN0aW9uKCdhbGwnKS5yZWFkKClcbiAgICB0LmVxdWFsKGFjdGlvbnMubGVuZ3RoLCAxKVxuICAgIHQuZXF1YWwoYWN0aW9ucy5sZW5ndGgsIDEpXG4gICAgdC5lcXVhbChhY3Rpb25zWzBdLnR5cGUsICdfb24nKVxuXG4gICAgYXdhaXQgdGVhckRvd24oeyB1c2VyIH0pXG59XG5cbnRlc3QoJ0ludGVncmF0aW9uIHRlc3RzJywgYXN5bmMgKHQpID0+IHtcbiAgICBhd2FpdCB0ZXN0MSh0KVxuICAgIGF3YWl0IHRlc3QyKHQpXG4gICAgYXdhaXQgdGVzdDModClcbn0pXG4iXX0=",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "integration.test.js"
      ],
      "names": [
        "project",
        "operator",
        "create",
        "PREFIX",
        "log",
        "id",
        "createProject",
        "app",
        "application",
        "EVT",
        "App",
        "appApiKey",
        "createApp",
        "settings",
        "projectId",
        "read",
        "fetchProject",
        "applicationId",
        "fetchApp",
        "user",
        "appUser",
        "anonymous",
        "User",
        "createUser",
        "collection",
        "createCollection",
        "rules",
        "properties",
        "thng",
        "_",
        "assign",
        "createThng",
        "names",
        "actionTypes",
        "Promise",
        "all",
        "map",
        "name",
        "actionType",
        "error",
        "status",
        "console",
        "JSON",
        "stringify",
        "createActionTypes",
        "appData",
        "request",
        "get",
        "url",
        "resource",
        "path",
        "headers",
        "operatorKey",
        "readReactorStatus",
        "action",
        "then",
        "actions",
        "type",
        "delete",
        "catch",
        "deleteAllActions",
        "setupFixtures",
        "fixtures",
        "tearDown",
        "t",
        "rule",
        "getSampleRule",
        "conditions",
        "operations",
        "equal",
        "length",
        "sleep",
        "props",
        "property",
        "update",
        "ambient_light",
        "value",
        "occupancy_detected",
        "test1",
        "today",
        "moment",
        "utc",
        "format",
        "toLowerCase",
        "customFields",
        "colour_temperature",
        "test2",
        "soon",
        "add",
        "test3",
        "require",
        "fs",
        "test",
        "BASE_DIR",
        "__dirname",
        "Operator",
        "parse",
        "readFileSync",
        "objectType",
        "verb",
        "obj"
      ],
      "mappings": "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",
      "file": "integration.test.js",
      "sourceRoot": "/Users/dtr/gooee/REACTOR/tests",
      "sourcesContent": [
        "'use strict'\nlet _ = require('lodash')\nlet EVT = require('evrythng-extended')\nlet fs = require('fs')\nlet moment = require('moment')\nlet request = require('request-promise')\nlet sleep = require('sleep')\nlet test = require('blue-tape')\n\nlet BASE_DIR = `${__dirname}/..`\nlet PREFIX = 'REACTOR'\n\nlet settings = require(`${BASE_DIR}/uploadSettings.json`)\n\nlet operator = new EVT.Operator(settings.operatorKey)\n\nfunction getSampleRule () {\n    let rule = JSON.parse(fs.readFileSync(`${BASE_DIR}/tests/shared/rules-sample-1.json`, 'utf8'))\n    rule.name = `${PREFIX} Rule`\n    return rule\n}\n\nfunction log (objectType, verb, obj) {\n    console.log(`${objectType} '${obj.name}' ${verb} with ID '${obj.id}'`)\n}\n\nasync function createProject () {\n    let project = await operator.project().create({\n        'name': `${PREFIX} Project`\n    })\n\n    log('Project', 'created', project)\n    return operator.project(project.id)\n}\n\nasync function createApp (project) {\n    let app = await project.application().create({\n        'name': `${PREFIX} Application`,\n        'socialNetworks': {},\n    })\n\n    log('Application', 'created', app)\n    return new EVT.App(app.appApiKey)\n}\n\nasync function fetchProject (settings) {\n    let project = await operator\n        .project(settings.projectId)\n        .read()\n\n    log('Project', 'fetched', project)\n    return operator.project(settings.projectId)\n}\n\nasync function fetchApp (settings) {\n    let app = await operator\n        .project(settings.projectId)\n        .application(settings.applicationId)\n        .read()\n\n    log('Application', 'fetched', app)\n    return new EVT.App(app.appApiKey)\n}\n\nasync function createUser (app) {\n    let user = await app.appUser().create({ anonymous: true })\n    log('User', 'created', user)\n    return new EVT.User(user, app)\n}\n\nasync function createCollection (user) {\n    let collection = await user.collection().create({\n        'name': `${PREFIX} Collection`,\n    })\n\n    log('Collection', 'created', collection)\n    return collection\n}\n\nasync function createThng (user, rules, properties) {\n    let thng = await user.thng().create({\n        'name': `${PREFIX} Thng`,\n        'properties': _.assign(properties, rules),\n    })\n\n    log('Thng', 'created', thng)\n    return user.thng(thng.id)\n}\n\nasync function createActionTypes (names) {\n    let actionTypes = Promise.all(names.map(async (name) => {\n        try {\n            let actionType = await operator.actionType().create({ name })\n            // TODO: rescope action types\n\n            log('ActionType', 'created', actionType)\n\n        } catch (error) {\n            if (error.status !== 409)\n                console.error(JSON.stringify(error))\n        }\n    }))\n}\n\nasync function readReactorStatus (appData) {\n    console.log(\n        `Getting the REACTOR status for App '${appData.name}' with ID '${appData.id}'...`)\n\n    let status = await request.get({\n        url: `https://api.evrythng.com/${appData.resource.path}/reactorScript/status`,\n        headers: {\n            'Accept': 'application/json',\n            'Authorization': settings.operatorKey,\n        }\n    })\n\n    console.log(`REACTOR status: ${status}`)\n    return status\n}\n\nasync function deleteAllActions (user) {\n    await user.action('all').read().then((actions) => {\n\n        return Promise.all(_.map(actions, (action) => {\n            return operator.action(action.type, action.id).delete()\n\n        })).catch((error) => {\n            console.log(`Error deleting Actions: ${JSON.stringify(error, null, 2)}`)\n        })\n    })\n\n    console.log('All Actions deleted')\n}\n\nasync function setupFixtures () {\n    //let project = await createProject(operator)\n    //let app = await createApp(project)\n    let project = await fetchProject(settings)\n    let app = await fetchApp(settings)\n    let user = await createUser(app)\n    await deleteAllActions(user)\n    let collection = await createCollection(user)\n    await createActionTypes(['_dim', '_on', '_off'])\n\n    return { project, app, user, collection }\n}\n\nasync function tearDown (fixtures) {\n    await deleteAllActions(fixtures.user)\n}\n\nasync function test1 (t) {\n    let { project, app, user, collection } = await setupFixtures()\n    let rule = getSampleRule()\n    rule.conditions = [\n        {\n            'variable': 'occupancy_detected',\n            'operator': '=',\n            'value': true,\n            'logical_operator': 'and',\n        },\n        {\n            'variable': 'ambient_light',\n            'operator': '>',\n            'value': 10,\n            'logical_operator': null,\n        },\n    ]\n    rule.operations = [\n        {\n            'collections': [\n                collection.id\n            ],\n            'actions': [\n                {\n                    'name': '_off'\n                },\n                {\n                    'name': '_dim',\n                    'parameters': {\n                        'value': 1\n                    }\n                }\n            ]\n        }\n    ]\n\n    let rules = { '__rule__7828728700101': rule }\n\n    let properties = {\n        'occupancy_detected': false,\n        'ambient_light': 9,\n    }\n\n    let actions = await user.action('all').read()\n    t.equal(actions.length, 0)\n\n    let thng = await createThng(user, rules, properties)\n\n    sleep.sleep(1)\n    actions = await user.action('all').read()\n    t.equal(actions.length, 0)\n\n    let props = await thng.property('ambient_light').update(11)\n    let ambient_light = props[0].value\n    t.equal(ambient_light, 11)\n\n    props = await thng.property('occupancy_detected').update(true)\n    let occupancy_detected = props[0].value\n    t.equal(occupancy_detected, true)\n\n    sleep.sleep(1)\n\n    actions = await user.action('all').read()\n\n    t.equal(actions.length, 2)\n\n    await tearDown({ user })\n}\n\nasync function test2 (t) {\n    let { project, app, user, collection } = await setupFixtures()\n    let rule = getSampleRule()\n    let today = moment.utc().format('ddd').toLowerCase()\n    console.log(today)\n    rule.conditions = [\n        {\n            'variable': 'day_of_week',\n            'operator': '=',\n            'value': [\n                today\n            ],\n            'logical_operator': 'and',\n        },\n        {\n            'variable': 'occupancy_detected',\n            'operator': '=',\n            'value': false,\n            'logical_operator': null,\n        },\n    ]\n    rule.operations = [\n        {\n            'collections': [\n                collection.id\n            ],\n            'actions': [\n                {\n                    'name': '_dim',\n                    'parameters': {\n                        'value': 5\n                    }\n                },\n            ]\n        }\n    ]\n\n    let rules = { '__rule__7828728700101': rule }\n\n    let properties = {\n        'occupancy_detected': false,\n        'colour_temperature': 3,\n    }\n\n    let actions = await user.action('all').read()\n    t.equal(actions.length, 0)\n\n    let thng = await createThng(user, rules, properties)\n\n    sleep.sleep(1)\n    actions = await user.action('all').read()\n    t.equal(actions.length, 1)\n    t.equal(actions[0].type, '_dim')\n    t.equal(actions[0].customFields.value, 5)\n\n    // This update should, since we've waited.\n    let props = await thng.property('colour_temperature').update(4)\n    let colour_temperature = props[0].value\n    t.equal(colour_temperature, 4)\n\n    sleep.sleep(1)\n    actions = await user.action('all').read()\n    t.equal(actions.length, 2)\n\n    await tearDown({ user })\n}\n    \nasync function test3 (t) {\n    let { project, app, user, collection } = await setupFixtures()\n    let rule = getSampleRule()\n    let soon = moment.utc().add(5, 'seconds').format('HH:mm:ss')\n    rule.conditions = [\n        {\n            'variable': 'time_of_day',\n            'operator': '>',\n            'value': soon,\n            'logical_operator': null,\n        },\n    ]\n    rule.operations = [\n        {\n            'collections': [\n                collection.id\n            ],\n            'actions': [\n                {\n                    'name': '_on'\n                },\n            ]\n        }\n    ]\n\n    let rules = { '__rule__7828728700101': rule }\n\n    let properties = {\n        'ambient_light': 1,\n    }\n\n    let actions = await user.action('all').read()\n    t.equal(actions.length, 0)\n\n    let thng = await createThng(user, rules, properties)\n\n    sleep.sleep(1)\n    actions = await user.action('all').read()\n    t.equal(actions.length, 0)\n\n    // This update shouldn't trigger an action, since it's not time yet.\n    let props = await thng.property('ambient_light').update(2)\n    let ambient_light = props[0].value\n    t.equal(ambient_light, 2)\n\n    sleep.sleep(1)\n    actions = await user.action('all').read()\n    t.equal(actions.length, 0)\n\n    sleep.sleep(3)\n\n    // This update should, since we've waited.\n    props = await thng.property('ambient_light').update(3)\n    ambient_light = props[0].value\n    t.equal(ambient_light, 3)\n\n    sleep.sleep(1)\n    actions = await user.action('all').read()\n    t.equal(actions.length, 1)\n    t.equal(actions.length, 1)\n    t.equal(actions[0].type, '_on')\n\n    await tearDown({ user })\n}\n\ntest('Integration tests', async (t) => {\n    await test1(t)\n    await test2(t)\n    await test3(t)\n})\n"
      ]
    },
    "mtime": 1472655423000
  },
  "{\"filename\":\"/Users/dtr/gooee/REACTOR/scripts/integration.js\",\"env\":{},\"retainLines\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"presets\":[],\"plugins\":[[[],null],[[],null]],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"minified\":false,\"sourceRoot\":\"/Users/dtr/gooee/REACTOR/scripts\",\"babelrc\":true,\"sourceType\":\"module\",\"moduleIds\":false,\"passPerPreset\":false}:6.14.0": {
    "metadata": {
      "usedHelpers": [
        "asyncToGenerator"
      ],
      "marked": [],
      "modules": {
        "imports": [],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      }
    },
    "options": {
      "filename": "/Users/dtr/gooee/REACTOR/scripts/integration.js",
      "filenameRelative": "/Users/dtr/gooee/REACTOR/scripts/integration.js",
      "env": {},
      "retainLines": false,
      "highlightCode": true,
      "suppressDeprecationMessages": false,
      "presets": [],
      "plugins": [
        [
          [],
          null
        ],
        [
          [],
          null
        ]
      ],
      "ignore": [],
      "code": true,
      "metadata": true,
      "ast": false,
      "comments": true,
      "compact": "auto",
      "minified": false,
      "sourceMaps": "both",
      "sourceMapTarget": "integration.js",
      "sourceFileName": "integration.js",
      "sourceRoot": "/Users/dtr/gooee/REACTOR/scripts",
      "babelrc": false,
      "sourceType": "module",
      "moduleRoot": "/Users/dtr/gooee/REACTOR/scripts",
      "moduleIds": false,
      "passPerPreset": false,
      "basename": "integration"
    },
    "ignored": false,
    "code": "'use strict';\n\nlet fetchProject = (() => {\n    var _ref = _asyncToGenerator(function* (settings) {\n        let project = yield operator.project(settings.projectId).read();\n\n        log('Project', 'fetched', project);\n        return operator.project(settings.projectId);\n    });\n\n    return function fetchProject(_x) {\n        return _ref.apply(this, arguments);\n    };\n})();\n\nlet fetchApp = (() => {\n    var _ref2 = _asyncToGenerator(function* (settings) {\n        let app = yield operator.project(settings.projectId).application(settings.applicationId).read();\n\n        log('Application', 'fetched', app);\n        return new EVT.App(app.appApiKey);\n    });\n\n    return function fetchApp(_x2) {\n        return _ref2.apply(this, arguments);\n    };\n})();\n\nlet createUser = (() => {\n    var _ref3 = _asyncToGenerator(function* (app) {\n        let user = yield app.appUser().create({ anonymous: true });\n        log('User', 'created', user);\n        return new EVT.User(user, app);\n    });\n\n    return function createUser(_x3) {\n        return _ref3.apply(this, arguments);\n    };\n})();\n\nlet createCollection = (() => {\n    var _ref4 = _asyncToGenerator(function* (user) {\n        let collection = yield user.collection().create({\n            'name': `${ PREFIX } Collection`\n        });\n\n        log('Collection', 'created', collection);\n        return collection;\n    });\n\n    return function createCollection(_x4) {\n        return _ref4.apply(this, arguments);\n    };\n})();\n\nlet createThng = (() => {\n    var _ref5 = _asyncToGenerator(function* (user, rules, properties) {\n        let thng = yield user.thng().create({\n            'name': `${ PREFIX } Thng`,\n            'properties': _.assign(properties, rules)\n        });\n\n        log('Thng', 'created', thng);\n        return user.thng(thng.id);\n    });\n\n    return function createThng(_x5, _x6, _x7) {\n        return _ref5.apply(this, arguments);\n    };\n})();\n\nlet createActionTypes = (() => {\n    var _ref6 = _asyncToGenerator(function* (names) {\n        return Promise.all(names.map((() => {\n            var _ref7 = _asyncToGenerator(function* (name) {\n                try {\n                    let actionType = yield operator.actionType().create({ name });\n                    // TODO: rescope action types\n\n                    log('ActionType', 'created', actionType);\n                    return actionType;\n                } catch (error) {\n                    if (error.status !== 409) console.error(JSON.stringify(error));\n                }\n            });\n\n            return function (_x9) {\n                return _ref7.apply(this, arguments);\n            };\n        })()));\n    });\n\n    return function createActionTypes(_x8) {\n        return _ref6.apply(this, arguments);\n    };\n})();\n\nlet deleteAllActions = (() => {\n    var _ref8 = _asyncToGenerator(function* (user) {\n        yield user.action('all').read().then(function (actions) {\n\n            return Promise.all(_.map(actions, function (action) {\n                return operator.action(action.type, action.id).delete();\n            })).catch(function (error) {\n                console.log(`Error deleting Actions: ${ JSON.stringify(error, null, 2) }`);\n            });\n        });\n\n        console.log('All Actions deleted');\n    });\n\n    return function deleteAllActions(_x10) {\n        return _ref8.apply(this, arguments);\n    };\n})();\n\nlet setupFixtures = (() => {\n    var _ref9 = _asyncToGenerator(function* () {\n        let project = yield fetchProject(settings);\n        let app = yield fetchApp(settings);\n        let user = yield createUser(app);\n        yield deleteAllActions(user);\n        let collection = yield createCollection(user);\n        yield createActionTypes(['_dim', '_on', '_off']);\n\n        return { project, app, user, collection };\n    });\n\n    return function setupFixtures() {\n        return _ref9.apply(this, arguments);\n    };\n})();\n\nlet tearDown = (() => {\n    var _ref10 = _asyncToGenerator(function* (fixtures) {\n        yield deleteAllActions(fixtures.user);\n    });\n\n    return function tearDown(_x11) {\n        return _ref10.apply(this, arguments);\n    };\n})();\n\nlet test1 = (() => {\n    var _ref11 = _asyncToGenerator(function* (t) {\n        var _ref12 = yield setupFixtures();\n\n        let user = _ref12.user;\n        let collection = _ref12.collection;\n\n        let rule = getSampleRule();\n        rule.conditions = [{\n            'variable': 'occupancy_detected',\n            'operator': '=',\n            'value': true,\n            'logical_operator': 'and'\n        }, {\n            'variable': 'ambient_light',\n            'operator': '>',\n            'value': 10,\n            'logical_operator': null\n        }];\n        rule.operations = [{\n            'collections': [collection.id],\n            'actions': [{\n                'name': '_off'\n            }, {\n                'name': '_dim',\n                'parameters': {\n                    'value': 1\n                }\n            }]\n        }];\n\n        let rules = { '__rule__7828728700101': rule };\n\n        let properties = {\n            'occupancy_detected': false,\n            'ambient_light': 9\n        };\n\n        let actions = yield user.action('all').read();\n        t.equal(actions.length, 0);\n\n        let thng = yield createThng(user, rules, properties);\n\n        sleep.sleep(1);\n        actions = yield user.action('all').read();\n        t.equal(actions.length, 0);\n\n        let props = yield thng.property('ambient_light').update(11);\n        let ambient_light = props[0].value;\n        t.equal(ambient_light, 11);\n\n        props = yield thng.property('occupancy_detected').update(true);\n        let occupancy_detected = props[0].value;\n        t.equal(occupancy_detected, true);\n\n        sleep.sleep(1);\n\n        actions = yield user.action('all').read();\n\n        t.equal(actions.length, 2);\n\n        yield tearDown({ user });\n    });\n\n    return function test1(_x12) {\n        return _ref11.apply(this, arguments);\n    };\n})();\n\nlet test2 = (() => {\n    var _ref13 = _asyncToGenerator(function* (t) {\n        var _ref14 = yield setupFixtures();\n\n        let user = _ref14.user;\n        let collection = _ref14.collection;\n\n        let rule = getSampleRule();\n        let today = moment.utc().format('ddd').toLowerCase();\n        console.log(today);\n        rule.conditions = [{\n            'variable': 'day_of_week',\n            'operator': '=',\n            'value': [today],\n            'logical_operator': 'and'\n        }, {\n            'variable': 'occupancy_detected',\n            'operator': '=',\n            'value': false,\n            'logical_operator': null\n        }];\n        rule.operations = [{\n            'collections': [collection.id],\n            'actions': [{\n                'name': '_dim',\n                'parameters': {\n                    'value': 5\n                }\n            }]\n        }];\n\n        let rules = { '__rule__7828728700101': rule };\n\n        let properties = {\n            'occupancy_detected': false,\n            'colour_temperature': 3\n        };\n\n        let actions = yield user.action('all').read();\n        t.equal(actions.length, 0);\n\n        let thng = yield createThng(user, rules, properties);\n\n        sleep.sleep(1);\n        actions = yield user.action('all').read();\n        t.equal(actions.length, 1);\n        t.equal(actions[0].type, '_dim');\n        t.equal(actions[0].customFields.value, 5);\n\n        // This update should, since we've waited.\n        let props = yield thng.property('colour_temperature').update(4);\n        let colour_temperature = props[0].value;\n        t.equal(colour_temperature, 4);\n\n        sleep.sleep(1);\n        actions = yield user.action('all').read();\n        t.equal(actions.length, 2);\n\n        yield tearDown({ user });\n    });\n\n    return function test2(_x13) {\n        return _ref13.apply(this, arguments);\n    };\n})();\n\nlet test3 = (() => {\n    var _ref15 = _asyncToGenerator(function* (t) {\n        var _ref16 = yield setupFixtures();\n\n        let user = _ref16.user;\n        let collection = _ref16.collection;\n\n        let rule = getSampleRule();\n        let soon = moment.utc().add(5, 'seconds').format('HH:mm:ss');\n        rule.conditions = [{\n            'variable': 'time_of_day',\n            'operator': '>',\n            'value': soon,\n            'logical_operator': null\n        }];\n        rule.operations = [{\n            'collections': [collection.id],\n            'actions': [{\n                'name': '_on'\n            }]\n        }];\n\n        let rules = { '__rule__7828728700101': rule };\n\n        let properties = {\n            'ambient_light': 1\n        };\n\n        let actions = yield user.action('all').read();\n        t.equal(actions.length, 0);\n\n        let thng = yield createThng(user, rules, properties);\n\n        sleep.sleep(1);\n        actions = yield user.action('all').read();\n        t.equal(actions.length, 0);\n\n        // This update shouldn't trigger an action, since it's not time yet.\n        let props = yield thng.property('ambient_light').update(2);\n        let ambient_light = props[0].value;\n        t.equal(ambient_light, 2);\n\n        sleep.sleep(1);\n        actions = yield user.action('all').read();\n        t.equal(actions.length, 0);\n\n        sleep.sleep(3);\n\n        // This update should, since we've waited.\n        props = yield thng.property('ambient_light').update(3);\n        ambient_light = props[0].value;\n        t.equal(ambient_light, 3);\n\n        sleep.sleep(1);\n        actions = yield user.action('all').read();\n        t.equal(actions.length, 1);\n        t.equal(actions.length, 1);\n        t.equal(actions[0].type, '_on');\n\n        yield tearDown({ user });\n    });\n\n    return function test3(_x14) {\n        return _ref15.apply(this, arguments);\n    };\n})();\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { return step(\"next\", value); }, function (err) { return step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nlet _ = require('lodash');\nlet EVT = require('evrythng-extended');\nlet fs = require('fs');\nlet moment = require('moment');\nlet sleep = require('sleep');\nlet test = require('blue-tape');\n\nlet BASE_DIR = `${ __dirname }/..`;\nlet PREFIX = 'REACTOR';\n\nlet settings = require(`${ BASE_DIR }/uploadSettings.json`);\n\nlet operator = new EVT.Operator(settings.operatorKey);\n\nfunction getSampleRule() {\n    let rule = JSON.parse(fs.readFileSync(`${ BASE_DIR }/tests/shared/rules-sample-1.json`, 'utf8'));\n    rule.name = `${ PREFIX } Rule`;\n    return rule;\n}\n\nfunction log(objectType, verb, obj) {\n    console.log(`${ objectType } '${ obj.name }' ${ verb } with ID '${ obj.id }'`);\n}\n\ntest('Integration tests', (() => {\n    var _ref17 = _asyncToGenerator(function* (t) {\n        console.log('###############################################################');\n        console.log('1. MAKE SURE THE REACTOR IS FINISHED UPLOADING.');\n        console.log('2. MAKE SURE THE VALUES IN `uploadSettings.json` ARE CORRECT.');\n        console.log('3. IF THE TESTS FAIL, RUN THEM A FEW MORE TIMES. IT MAY HAVE');\n        console.log('   BEEN A CONNECTION/TIMING ISSUE.');\n        console.log('###############################################################');\n        yield test1(t);\n        yield test2(t);\n        yield test3(t);\n    });\n\n    return function (_x15) {\n        return _ref17.apply(this, arguments);\n    };\n})());\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImludGVncmF0aW9uLmpzIl0sIm5hbWVzIjpbInNldHRpbmdzIiwicHJvamVjdCIsIm9wZXJhdG9yIiwicHJvamVjdElkIiwicmVhZCIsImxvZyIsImZldGNoUHJvamVjdCIsImFwcCIsImFwcGxpY2F0aW9uIiwiYXBwbGljYXRpb25JZCIsIkVWVCIsIkFwcCIsImFwcEFwaUtleSIsImZldGNoQXBwIiwidXNlciIsImFwcFVzZXIiLCJjcmVhdGUiLCJhbm9ueW1vdXMiLCJVc2VyIiwiY3JlYXRlVXNlciIsImNvbGxlY3Rpb24iLCJQUkVGSVgiLCJjcmVhdGVDb2xsZWN0aW9uIiwicnVsZXMiLCJwcm9wZXJ0aWVzIiwidGhuZyIsIl8iLCJhc3NpZ24iLCJpZCIsImNyZWF0ZVRobmciLCJuYW1lcyIsIlByb21pc2UiLCJhbGwiLCJtYXAiLCJuYW1lIiwiYWN0aW9uVHlwZSIsImVycm9yIiwic3RhdHVzIiwiY29uc29sZSIsIkpTT04iLCJzdHJpbmdpZnkiLCJjcmVhdGVBY3Rpb25UeXBlcyIsImFjdGlvbiIsInRoZW4iLCJhY3Rpb25zIiwidHlwZSIsImRlbGV0ZSIsImNhdGNoIiwiZGVsZXRlQWxsQWN0aW9ucyIsInNldHVwRml4dHVyZXMiLCJmaXh0dXJlcyIsInRlYXJEb3duIiwidCIsInJ1bGUiLCJnZXRTYW1wbGVSdWxlIiwiY29uZGl0aW9ucyIsIm9wZXJhdGlvbnMiLCJlcXVhbCIsImxlbmd0aCIsInNsZWVwIiwicHJvcHMiLCJwcm9wZXJ0eSIsInVwZGF0ZSIsImFtYmllbnRfbGlnaHQiLCJ2YWx1ZSIsIm9jY3VwYW5jeV9kZXRlY3RlZCIsInRlc3QxIiwidG9kYXkiLCJtb21lbnQiLCJ1dGMiLCJmb3JtYXQiLCJ0b0xvd2VyQ2FzZSIsImN1c3RvbUZpZWxkcyIsImNvbG91cl90ZW1wZXJhdHVyZSIsInRlc3QyIiwic29vbiIsImFkZCIsInRlc3QzIiwicmVxdWlyZSIsImZzIiwidGVzdCIsIkJBU0VfRElSIiwiX19kaXJuYW1lIiwiT3BlcmF0b3IiLCJvcGVyYXRvcktleSIsInBhcnNlIiwicmVhZEZpbGVTeW5jIiwib2JqZWN0VHlwZSIsInZlcmIiLCJvYmoiXSwibWFwcGluZ3MiOiJBQUFBOzs7aUNBeUJBLFdBQTZCQSxRQUE3QixFQUF1QztBQUNuQyxZQUFJQyxVQUFVLE1BQU1DLFNBQ2ZELE9BRGUsQ0FDUEQsU0FBU0csU0FERixFQUVmQyxJQUZlLEVBQXBCOztBQUlBQyxZQUFJLFNBQUosRUFBZSxTQUFmLEVBQTBCSixPQUExQjtBQUNBLGVBQU9DLFNBQVNELE9BQVQsQ0FBaUJELFNBQVNHLFNBQTFCLENBQVA7QUFDSCxLOztvQkFQY0csWTs7Ozs7O2tDQVNmLFdBQXlCTixRQUF6QixFQUFtQztBQUMvQixZQUFJTyxNQUFNLE1BQU1MLFNBQ1hELE9BRFcsQ0FDSEQsU0FBU0csU0FETixFQUVYSyxXQUZXLENBRUNSLFNBQVNTLGFBRlYsRUFHWEwsSUFIVyxFQUFoQjs7QUFLQUMsWUFBSSxhQUFKLEVBQW1CLFNBQW5CLEVBQThCRSxHQUE5QjtBQUNBLGVBQU8sSUFBSUcsSUFBSUMsR0FBUixDQUFZSixJQUFJSyxTQUFoQixDQUFQO0FBQ0gsSzs7b0JBUmNDLFE7Ozs7OztrQ0FVZixXQUEyQk4sR0FBM0IsRUFBZ0M7QUFDNUIsWUFBSU8sT0FBTyxNQUFNUCxJQUFJUSxPQUFKLEdBQWNDLE1BQWQsQ0FBcUIsRUFBRUMsV0FBVyxJQUFiLEVBQXJCLENBQWpCO0FBQ0FaLFlBQUksTUFBSixFQUFZLFNBQVosRUFBdUJTLElBQXZCO0FBQ0EsZUFBTyxJQUFJSixJQUFJUSxJQUFSLENBQWFKLElBQWIsRUFBbUJQLEdBQW5CLENBQVA7QUFDSCxLOztvQkFKY1ksVTs7Ozs7O2tDQU1mLFdBQWlDTCxJQUFqQyxFQUF1QztBQUNuQyxZQUFJTSxhQUFhLE1BQU1OLEtBQUtNLFVBQUwsR0FBa0JKLE1BQWxCLENBQXlCO0FBQzVDLG9CQUFTLElBQUVLLE1BQU87QUFEMEIsU0FBekIsQ0FBdkI7O0FBSUFoQixZQUFJLFlBQUosRUFBa0IsU0FBbEIsRUFBNkJlLFVB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QUFSLENBQVksaUVBQVo7QUFDQSxjQUFNNkQsTUFBTWQsQ0FBTixDQUFOO0FBQ0EsY0FBTXNCLE1BQU10QixDQUFOLENBQU47QUFDQSxjQUFNeUIsTUFBTXpCLENBQU4sQ0FBTjtBQUNILEtBVkQ7O0FBQUE7QUFBQTtBQUFBO0FBQUEiLCJmaWxlIjoiaW50ZWdyYXRpb24uanMiLCJzb3VyY2VSb290IjoiL1VzZXJzL2R0ci9nb29lZS9SRUFDVE9SL3NjcmlwdHMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCdcbmxldCBfID0gcmVxdWlyZSgnbG9kYXNoJylcbmxldCBFVlQgPSByZXF1aXJlKCdldnJ5dGhuZy1leHRlbmRlZCcpXG5sZXQgZnMgPSByZXF1aXJlKCdmcycpXG5sZXQgbW9tZW50ID0gcmVxdWlyZSgnbW9tZW50JylcbmxldCBzbGVlcCA9IHJlcXVpcmUoJ3NsZWVwJylcbmxldCB0ZXN0ID0gcmVxdWlyZSgnYmx1ZS10YXBlJylcblxubGV0IEJBU0VfRElSID0gYCR7X19kaXJuYW1lfS8uLmBcbmxldCBQUkVGSVggPSAnUkVBQ1RPUidcblxubGV0IHNldHRpbmdzID0gcmVxdWlyZShgJHtCQVNFX0RJUn0vdXBsb2FkU2V0dGluZ3MuanNvbmApXG5cbmxldCBvcGVyYXRvciA9IG5ldyBFVlQuT3BlcmF0b3Ioc2V0dGluZ3Mub3BlcmF0b3JLZXkpXG5cbmZ1bmN0aW9uIGdldFNhbXBsZVJ1bGUgKCkge1xuICAgIGxldCBydWxlID0gSlNPTi5wYXJzZShmcy5yZWFkRmlsZVN5bmMoYCR7QkFTRV9ESVJ9L3Rlc3RzL3NoYXJlZC9ydWxlcy1zYW1wbGUtMS5qc29uYCwgJ3V0ZjgnKSlcbiAgICBydWxlLm5hbWUgPSBgJHtQUkVGSVh9IFJ1bGVgXG4gICAgcmV0dXJuIHJ1bGVcbn1cblxuZnVuY3Rpb24gbG9nIChvYmplY3RUeXBlLCB2ZXJiLCBvYmopIHtcbiAgICBjb25zb2xlLmxvZyhgJHtvYmplY3RUeXBlfSAnJHtvYmoubmFtZX0nICR7dmVyYn0gd2l0aCBJRCAnJHtvYmouaWR9J2ApXG59XG5cbmFzeW5jIGZ1bmN0aW9uIGZldGNoUHJvamVjdCAoc2V0dGluZ3MpIHtcbiAgICBsZXQgcHJvamVjdCA9IGF3YWl0IG9wZXJhdG9yXG4gICAgICAgIC5wcm9qZWN0KHNldHRpbmdzLnByb2plY3RJZClcbiAgICAgICAgLnJlYWQoKVxuXG4gICAgbG9nKCdQcm9qZWN0JywgJ2ZldGNoZWQnLCBwcm9qZWN0KVxuICAgIHJldHVybiBvcGVyYXRvci5wcm9qZWN0KHNldHRpbmdzLnByb2plY3RJZClcbn1cblxuYXN5bmMgZnVuY3Rpb24gZmV0Y2hBcHAgKHNldHRpbmdzKSB7XG4gICAgbGV0IGFwcCA9IGF3YWl0IG9wZXJhdG9yXG4gICAgICAgIC5wcm9qZWN0KHNldHRpbmdzLnByb2plY3RJZClcbiAgICAgICAgLmFwcGxpY2F0aW9uKHNldHRpbmdzLmFwcGxpY2F0aW9uSWQpXG4gICAgICAgIC5yZWFkKClcblxuICAgIGxvZygnQXBwbGljYXRpb24nLCAnZmV0Y2hlZCcsIGFwcClcbiAgICByZXR1cm4gbmV3IEVWVC5BcHAoYXBwLmFwcEFwaUtleSlcbn1cblxuYXN5bmMgZnVuY3Rpb24gY3JlYXRlVXNlciAoYXBwKSB7XG4gICAgbGV0IHVzZXIgPSBhd2FpdCBhcHAuYXBwVXNlcigpLmNyZWF0ZSh7IGFub255bW91czogdHJ1ZSB9KVxuICAgIGxvZygnVXNlcicsICdjcmVhdGVkJywgdXNlcilcbiAgICByZXR1cm4gbmV3IEVWVC5Vc2VyKHVzZXIsIGFwcClcbn1cblxuYXN5bmMgZnVuY3Rpb24gY3JlYXRlQ29sbGVjdGlvbiAodXNlcikge1xuICAgIGxldCBjb2xsZWN0aW9uID0gYXdhaXQgdXNlci5jb2xsZWN0aW9uKCkuY3JlYXRlKHtcbiAgICAgICAgJ25hbWUnOiBgJHtQUkVGSVh9IENvbGxlY3Rpb25gLFxuICAgIH0pXG5cbiAgICBsb2coJ0NvbGxlY3Rpb24nLCAnY3JlYXRlZCcsIGNvbGxlY3Rpb24pXG4gICAgcmV0dXJuIGNvbGxlY3Rpb25cbn1cblxuYXN5bmMgZnVuY3Rpb24gY3JlYXRlVGhuZyAodXNlciwgcnVsZXMsIHByb3BlcnRpZXMpIHtcbiAgICBsZXQgdGhuZyA9IGF3YWl0IHVzZXIudGhuZygpLmNyZWF0ZSh7XG4gICAgICAgICduYW1lJzogYCR7UFJFRklYfSBUaG5nYCxcbiAgICAgICAgJ3Byb3BlcnRpZXMnOiBfLmFzc2lnbihwcm9wZXJ0aWVzLCBydWxlcyksXG4gICAgfSlcblxuICAgIGxvZygnVGhuZycsICdjcmVhdGVkJywgdGhuZylcbiAgICByZXR1cm4gdXNlci50aG5nKHRobmcuaWQpXG59XG5cbmFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUFjdGlvblR5cGVzIChuYW1lcykge1xuICAgIHJldHVybiBQcm9taXNlLmFsbChuYW1lcy5tYXAoYXN5bmMgKG5hbWUpID0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGxldCBhY3Rpb25UeXBlID0gYXdhaXQgb3BlcmF0b3IuYWN0aW9uVHlwZSgpLmNyZWF0ZSh7IG5hbWUgfSlcbiAgICAgICAgICAgIC8vIFRPRE86IHJlc2NvcGUgYWN0aW9uIHR5cGVzXG5cbiAgICAgICAgICAgIGxvZygnQWN0aW9uVHlwZScsICdjcmVhdGVkJywgYWN0aW9uVHlwZSlcbiAgICAgICAgICAgIHJldHVybiBhY3Rpb25UeXBlXG5cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGlmIChlcnJvci5zdGF0dXMgIT09IDQwOSlcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKEpTT04uc3RyaW5naWZ5KGVycm9yKSlcbiAgICAgICAgfVxuICAgIH0pKVxufVxuXG5hc3luYyBmdW5jdGlvbiBkZWxldGVBbGxBY3Rpb25zICh1c2VyKSB7XG4gICAgYXdhaXQgdXNlci5hY3Rpb24oJ2FsbCcpLnJlYWQoKS50aGVuKChhY3Rpb25zKSA9PiB7XG5cbiAgICAgICAgcmV0dXJuIFByb21pc2UuYWxsKF8ubWFwKGFjdGlvbnMsIChhY3Rpb24pID0+IHtcbiAgICAgICAgICAgIHJldHVybiBvcGVyYXRvci5hY3Rpb24oYWN0aW9uLnR5cGUsIGFjdGlvbi5pZCkuZGVsZXRlKClcblxuICAgICAgICB9KSkuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhgRXJyb3IgZGVsZXRpbmcgQWN0aW9uczogJHtKU09OLnN0cmluZ2lmeShlcnJvciwgbnVsbCwgMil9YClcbiAgICAgICAgfSlcbiAgICB9KVxuXG4gICAgY29uc29sZS5sb2coJ0FsbCBBY3Rpb25zIGRlbGV0ZWQnKVxufVxuXG5hc3luYyBmdW5jdGlvbiBzZXR1cEZpeHR1cmVzICgpIHtcbiAgICBsZXQgcHJvamVjdCA9IGF3YWl0IGZldGNoUHJvamVjdChzZXR0aW5ncylcbiAgICBsZXQgYXBwID0gYXdhaXQgZmV0Y2hBcHAoc2V0dGluZ3MpXG4gICAgbGV0IHVzZXIgPSBhd2FpdCBjcmVhdGVVc2VyKGFwcClcbiAgICBhd2FpdCBkZWxldGVBbGxBY3Rpb25zKHVzZXIpXG4gICAgbGV0IGNvbGxlY3Rpb24gPSBhd2FpdCBjcmVhdGVDb2xsZWN0aW9uKHVzZXIpXG4gICAgYXdhaXQgY3JlYXRlQWN0aW9uVHlwZXMoWydfZGltJywgJ19vbicsICdfb2ZmJ10pXG5cbiAgICByZXR1cm4geyBwcm9qZWN0LCBhcHAsIHVzZXIsIGNvbGxlY3Rpb24gfVxufVxuXG5hc3luYyBmdW5jdGlvbiB0ZWFyRG93biAoZml4dHVyZXMpIHtcbiAgICBhd2FpdCBkZWxldGVBbGxBY3Rpb25zKGZpeHR1cmVzLnVzZXIpXG59XG5cbmFzeW5jIGZ1bmN0aW9uIHRlc3QxICh0KSB7XG4gICAgbGV0IHsgdXNlciwgY29sbGVjdGlvbiB9ID0gYXdhaXQgc2V0dXBGaXh0dXJlcygpXG4gICAgbGV0IHJ1bGUgPSBnZXRTYW1wbGVSdWxlKClcbiAgICBydWxlLmNvbmRpdGlvbnMgPSBbXG4gICAgICAgIHtcbiAgICAgICAgICAgICd2YXJpYWJsZSc6ICdvY2N1cGFuY3lfZGV0ZWN0ZWQnLFxuICAgICAgICAgICAgJ29wZXJhdG9yJzogJz0nLFxuICAgICAgICAgICAgJ3ZhbHVlJzogdHJ1ZSxcbiAgICAgICAgICAgICdsb2dpY2FsX29wZXJhdG9yJzogJ2FuZCcsXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgICd2YXJpYWJsZSc6ICdhbWJpZW50X2xpZ2h0JyxcbiAgICAgICAgICAgICdvcGVyYXRvcic6ICc+JyxcbiAgICAgICAgICAgICd2YWx1ZSc6IDEwLFxuICAgICAgICAgICAgJ2xvZ2ljYWxfb3BlcmF0b3InOiBudWxsLFxuICAgICAgICB9LFxuICAgIF1cbiAgICBydWxlLm9wZXJhdGlvbnMgPSBbXG4gICAgICAgIHtcbiAgICAgICAgICAgICdjb2xsZWN0aW9ucyc6IFtcbiAgICAgICAgICAgICAgICBjb2xsZWN0aW9uLmlkXG4gICAgICAgICAgICBdLFxuICAgICAgICAgICAgJ2FjdGlvbnMnOiBbXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAnbmFtZSc6ICdfb2ZmJ1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAnbmFtZSc6ICdfZGltJyxcbiAgICAgICAgICAgICAgICAgICAgJ3BhcmFtZXRlcnMnOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAndmFsdWUnOiAxXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBdXG4gICAgICAgIH1cbiAgICBdXG5cbiAgICBsZXQgcnVsZXMgPSB7ICdfX3J1bGVfXzc4Mjg3Mjg3MDAxMDEnOiBydWxlIH1cblxuICAgIGxldCBwcm9wZXJ0aWVzID0ge1xuICAgICAgICAnb2NjdXBhbmN5X2RldGVjdGVkJzogZmFsc2UsXG4gICAgICAgICdhbWJpZW50X2xpZ2h0JzogOSxcbiAgICB9XG5cbiAgICBsZXQgYWN0aW9ucyA9IGF3YWl0IHVzZXIuYWN0aW9uKCdhbGwnKS5yZWFkKClcbiAgICB0LmVxdWFsKGFjdGlvbnMubGVuZ3RoLCAwKVxuXG4gICAgbGV0IHRobmcgPSBhd2FpdCBjcmVhdGVUaG5nKHVzZXIsIHJ1bGVzLCBwcm9wZXJ0aWVzKVxuXG4gICAgc2xlZXAuc2xlZXAoMSlcbiAgICBhY3Rpb25zID0gYXdhaXQgdXNlci5hY3Rpb24oJ2FsbCcpLnJlYWQoKVxuICAgIHQuZXF1YWwoYWN0aW9ucy5sZW5ndGgsIDApXG5cbiAgICBsZXQgcHJvcHMgPSBhd2FpdCB0aG5nLnByb3BlcnR5KCdhbWJpZW50X2xpZ2h0JykudXBkYXRlKDExKVxuICAgIGxldCBhbWJpZW50X2xpZ2h0ID0gcHJvcHNbMF0udmFsdWVcbiAgICB0LmVxdWFsKGFtYmllbnRfbGlnaHQsIDExKVxuXG4gICAgcHJvcHMgPSBhd2FpdCB0aG5nLnByb3BlcnR5KCdvY2N1cGFuY3lfZGV0ZWN0ZWQnKS51cGRhdGUodHJ1ZSlcbiAgICBsZXQgb2NjdXBhbmN5X2RldGVjdGVkID0gcHJvcHNbMF0udmFsdWVcbiAgICB0LmVxdWFsKG9jY3VwYW5jeV9kZXRlY3RlZCwgdHJ1ZSlcblxuICAgIHNsZWVwLnNsZWVwKDEpXG5cbiAgICBhY3Rpb25zID0gYXdhaXQgdXNlci5hY3Rpb24oJ2FsbCcpLnJlYWQoKVxuXG4gICAgdC5lcXVhbChhY3Rpb25zLmxlbmd0aCwgMilcblxuICAgIGF3YWl0IHRlYXJEb3duKHsgdXNlciB9KVxufVxuXG5hc3luYyBmdW5jdGlvbiB0ZXN0MiAodCkge1xuICAgIGxldCB7IHVzZXIsIGNvbGxlY3Rpb24gfSA9IGF3YWl0IHNldHVwRml4dHVyZXMoKVxuICAgIGxldCBydWxlID0gZ2V0U2FtcGxlUnVsZSgpXG4gICAgbGV0IHRvZGF5ID0gbW9tZW50LnV0YygpLmZvcm1hdCgnZGRkJykudG9Mb3dlckNhc2UoKVxuICAgIGNvbnNvbGUubG9nKHRvZGF5KVxuICAgIHJ1bGUuY29uZGl0aW9ucyA9IFtcbiAgICAgICAge1xuICAgICAgICAgICAgJ3ZhcmlhYmxlJzogJ2RheV9vZl93ZWVrJyxcbiAgICAgICAgICAgICdvcGVyYXRvcic6ICc9JyxcbiAgICAgICAgICAgICd2YWx1ZSc6IFtcbiAgICAgICAgICAgICAgICB0b2RheVxuICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICdsb2dpY2FsX29wZXJhdG9yJzogJ2FuZCcsXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgICd2YXJpYWJsZSc6ICdvY2N1cGFuY3lfZGV0ZWN0ZWQnLFxuICAgICAgICAgICAgJ29wZXJhdG9yJzogJz0nLFxuICAgICAgICAgICAgJ3ZhbHVlJzogZmFsc2UsXG4gICAgICAgICAgICAnbG9naWNhbF9vcGVyYXRvcic6IG51bGwsXG4gICAgICAgIH0sXG4gICAgXVxuICAgIHJ1bGUub3BlcmF0aW9ucyA9IFtcbiAgICAgICAge1xuICAgICAgICAgICAgJ2NvbGxlY3Rpb25zJzogW1xuICAgICAgICAgICAgICAgIGNvbGxlY3Rpb24uaWRcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAnYWN0aW9ucyc6IFtcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICduYW1lJzogJ19kaW0nLFxuICAgICAgICAgICAgICAgICAgICAncGFyYW1ldGVycyc6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICd2YWx1ZSc6IDVcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBdXG4gICAgICAgIH1cbiAgICBdXG5cbiAgICBsZXQgcnVsZXMgPSB7ICdfX3J1bGVfXzc4Mjg3Mjg3MDAxMDEnOiBydWxlIH1cblxuICAgIGxldCBwcm9wZXJ0aWVzID0ge1xuICAgICAgICAnb2NjdXBhbmN5X2RldGVjdGVkJzogZmFsc2UsXG4gICAgICAgICdjb2xvdXJfdGVtcGVyYXR1cmUnOiAzLFxuICAgIH1cblxuICAgIGxldCBhY3Rpb25zID0gYXdhaXQgdXNlci5hY3Rpb24oJ2FsbCcpLnJlYWQoKVxuICAgIHQuZXF1YWwoYWN0aW9ucy5sZW5ndGgsIDApXG5cbiAgICBsZXQgdGhuZyA9IGF3YWl0IGNyZWF0ZVRobmcodXNlciwgcnVsZXMsIHByb3BlcnRpZXMpXG5cbiAgICBzbGVlcC5zbGVlcCgxKVxuICAgIGFjdGlvbnMgPSBhd2FpdCB1c2VyLmFjdGlvbignYWxsJykucmVhZCgpXG4gICAgdC5lcXVhbChhY3Rpb25zLmxlbmd0aCwgMSlcbiAgICB0LmVxdWFsKGFjdGlvbnNbMF0udHlwZSwgJ19kaW0nKVxuICAgIHQuZXF1YWwoYWN0aW9uc1swXS5jdXN0b21GaWVsZHMudmFsdWUsIDUpXG5cbiAgICAvLyBUaGlzIHVwZGF0ZSBzaG91bGQsIHNpbmNlIHdlJ3ZlIHdhaXRlZC5cbiAgICBsZXQgcHJvcHMgPSBhd2FpdCB0aG5nLnByb3BlcnR5KCdjb2xvdXJfdGVtcGVyYXR1cmUnKS51cGRhdGUoNClcbiAgICBsZXQgY29sb3VyX3RlbXBlcmF0dXJlID0gcHJvcHNbMF0udmFsdWVcbiAgICB0LmVxdWFsKGNvbG91cl90ZW1wZXJhdHVyZSwgNClcblxuICAgIHNsZWVwLnNsZWVwKDEpXG4gICAgYWN0aW9ucyA9IGF3YWl0IHVzZXIuYWN0aW9uKCdhbGwnKS5yZWFkKClcbiAgICB0LmVxdWFsKGFjdGlvbnMubGVuZ3RoLCAyKVxuXG4gICAgYXdhaXQgdGVhckRvd24oeyB1c2VyIH0pXG59XG4gICAgXG5hc3luYyBmdW5jdGlvbiB0ZXN0MyAodCkge1xuICAgIGxldCB7IHVzZXIsIGNvbGxlY3Rpb24gfSA9IGF3YWl0IHNldHVwRml4dHVyZXMoKVxuICAgIGxldCBydWxlID0gZ2V0U2FtcGxlUnVsZSgpXG4gICAgbGV0IHNvb24gPSBtb21lbnQudXRjKCkuYWRkKDUsICdzZWNvbmRzJykuZm9ybWF0KCdISDptbTpzcycpXG4gICAgcnVsZS5jb25kaXRpb25zID0gW1xuICAgICAgICB7XG4gICAgICAgICAgICAndmFyaWFibGUnOiAndGltZV9vZl9kYXknLFxuICAgICAgICAgICAgJ29wZXJhdG9yJzogJz4nLFxuICAgICAgICAgICAgJ3ZhbHVlJzogc29vbixcbiAgICAgICAgICAgICdsb2dpY2FsX29wZXJhdG9yJzogbnVsbCxcbiAgICAgICAgfSxcbiAgICBdXG4gICAgcnVsZS5vcGVyYXRpb25zID0gW1xuICAgICAgICB7XG4gICAgICAgICAgICAnY29sbGVjdGlvbnMnOiBbXG4gICAgICAgICAgICAgICAgY29sbGVjdGlvbi5pZFxuICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICdhY3Rpb25zJzogW1xuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgJ25hbWUnOiAnX29uJ1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBdXG4gICAgICAgIH1cbiAgICBdXG5cbiAgICBsZXQgcnVsZXMgPSB7ICdfX3J1bGVfXzc4Mjg3Mjg3MDAxMDEnOiBydWxlIH1cblxuICAgIGxldCBwcm9wZXJ0aWVzID0ge1xuICAgICAgICAnYW1iaWVudF9saWdodCc6IDEsXG4gICAgfVxuXG4gICAgbGV0IGFjdGlvbnMgPSBhd2FpdCB1c2VyLmFjdGlvbignYWxsJykucmVhZCgpXG4gICAgdC5lcXVhbChhY3Rpb25zLmxlbmd0aCwgMClcblxuICAgIGxldCB0aG5nID0gYXdhaXQgY3JlYXRlVGhuZyh1c2VyLCBydWxlcywgcHJvcGVydGllcylcblxuICAgIHNsZWVwLnNsZWVwKDEpXG4gICAgYWN0aW9ucyA9IGF3YWl0IHVzZXIuYWN0aW9uKCdhbGwnKS5yZWFkKClcbiAgICB0LmVxdWFsKGFjdGlvbnMubGVuZ3RoLCAwKVxuXG4gICAgLy8gVGhpcyB1cGRhdGUgc2hvdWxkbid0IHRyaWdnZXIgYW4gYWN0aW9uLCBzaW5jZSBpdCdzIG5vdCB0aW1lIHlldC5cbiAgICBsZXQgcHJvcHMgPSBhd2FpdCB0aG5nLnByb3BlcnR5KCdhbWJpZW50X2xpZ2h0JykudXBkYXRlKDIpXG4gICAgbGV0IGFtYmllbnRfbGlnaHQgPSBwcm9wc1swXS52YWx1ZVxuICAgIHQuZXF1YWwoYW1iaWVudF9saWdodCwgMilcblxuICAgIHNsZWVwLnNsZWVwKDEpXG4gICAgYWN0aW9ucyA9IGF3YWl0IHVzZXIuYWN0aW9uKCdhbGwnKS5yZWFkKClcbiAgICB0LmVxdWFsKGFjdGlvbnMubGVuZ3RoLCAwKVxuXG4gICAgc2xlZXAuc2xlZXAoMylcblxuICAgIC8vIFRoaXMgdXBkYXRlIHNob3VsZCwgc2luY2Ugd2UndmUgd2FpdGVkLlxuICAgIHByb3BzID0gYXdhaXQgdGhuZy5wcm9wZXJ0eSgnYW1iaWVudF9saWdodCcpLnVwZGF0ZSgzKVxuICAgIGFtYmllbnRfbGlnaHQgPSBwcm9wc1swXS52YWx1ZVxuICAgIHQuZXF1YWwoYW1iaWVudF9saWdodCwgMylcblxuICAgIHNsZWVwLnNsZWVwKDEpXG4gICAgYWN0aW9ucyA9IGF3YWl0IHVzZXIuYWN0aW9uKCdhbGwnKS5yZWFkKClcbiAgICB0LmVxdWFsKGFjdGlvbnMubGVuZ3RoLCAxKVxuICAgIHQuZXF1YWwoYWN0aW9ucy5sZW5ndGgsIDEpXG4gICAgdC5lcXVhbChhY3Rpb25zWzBdLnR5cGUsICdfb24nKVxuXG4gICAgYXdhaXQgdGVhckRvd24oeyB1c2VyIH0pXG59XG5cbnRlc3QoJ0ludGVncmF0aW9uIHRlc3RzJywgYXN5bmMgKHQpID0+IHtcbiAgICBjb25zb2xlLmxvZygnIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjJylcbiAgICBjb25zb2xlLmxvZygnMS4gTUFLRSBTVVJFIFRIRSBSRUFDVE9SIElTIEZJTklTSEVEIFVQTE9BRElORy4nKVxuICAgIGNvbnNvbGUubG9nKCcyLiBNQUtFIFNVUkUgVEhFIFZBTFVFUyBJTiBgdXBsb2FkU2V0dGluZ3MuanNvbmAgQVJFIENPUlJFQ1QuJylcbiAgICBjb25zb2xlLmxvZygnMy4gSUYgVEhFIFRFU1RTIEZBSUwsIFJVTiBUSEVNIEEgRkVXIE1PUkUgVElNRVMuIElUIE1BWSBIQVZFJylcbiAgICBjb25zb2xlLmxvZygnICAgQkVFTiBBIENPTk5FQ1RJT04vVElNSU5HIElTU1VFLicpXG4gICAgY29uc29sZS5sb2coJyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIycpXG4gICAgYXdhaXQgdGVzdDEodClcbiAgICBhd2FpdCB0ZXN0Mih0KVxuICAgIGF3YWl0IHRlc3QzKHQpXG59KVxuIl19",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "integration.js"
      ],
      "names": [
        "settings",
        "project",
        "operator",
        "projectId",
        "read",
        "log",
        "fetchProject",
        "app",
        "application",
        "applicationId",
        "EVT",
        "App",
        "appApiKey",
        "fetchApp",
        "user",
        "appUser",
        "create",
        "anonymous",
        "User",
        "createUser",
        "collection",
        "PREFIX",
        "createCollection",
        "rules",
        "properties",
        "thng",
        "_",
        "assign",
        "id",
        "createThng",
        "names",
        "Promise",
        "all",
        "map",
        "name",
        "actionType",
        "error",
        "status",
        "console",
        "JSON",
        "stringify",
        "createActionTypes",
        "action",
        "then",
        "actions",
        "type",
        "delete",
        "catch",
        "deleteAllActions",
        "setupFixtures",
        "fixtures",
        "tearDown",
        "t",
        "rule",
        "getSampleRule",
        "conditions",
        "operations",
        "equal",
        "length",
        "sleep",
        "props",
        "property",
        "update",
        "ambient_light",
        "value",
        "occupancy_detected",
        "test1",
        "today",
        "moment",
        "utc",
        "format",
        "toLowerCase",
        "customFields",
        "colour_temperature",
        "test2",
        "soon",
        "add",
        "test3",
        "require",
        "fs",
        "test",
        "BASE_DIR",
        "__dirname",
        "Operator",
        "operatorKey",
        "parse",
        "readFileSync",
        "objectType",
        "verb",
        "obj"
      ],
      "mappings": "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",
      "file": "integration.js",
      "sourceRoot": "/Users/dtr/gooee/REACTOR/scripts",
      "sourcesContent": [
        "'use strict'\nlet _ = require('lodash')\nlet EVT = require('evrythng-extended')\nlet fs = require('fs')\nlet moment = require('moment')\nlet sleep = require('sleep')\nlet test = require('blue-tape')\n\nlet BASE_DIR = `${__dirname}/..`\nlet PREFIX = 'REACTOR'\n\nlet settings = require(`${BASE_DIR}/uploadSettings.json`)\n\nlet operator = new EVT.Operator(settings.operatorKey)\n\nfunction getSampleRule () {\n    let rule = JSON.parse(fs.readFileSync(`${BASE_DIR}/tests/shared/rules-sample-1.json`, 'utf8'))\n    rule.name = `${PREFIX} Rule`\n    return rule\n}\n\nfunction log (objectType, verb, obj) {\n    console.log(`${objectType} '${obj.name}' ${verb} with ID '${obj.id}'`)\n}\n\nasync function fetchProject (settings) {\n    let project = await operator\n        .project(settings.projectId)\n        .read()\n\n    log('Project', 'fetched', project)\n    return operator.project(settings.projectId)\n}\n\nasync function fetchApp (settings) {\n    let app = await operator\n        .project(settings.projectId)\n        .application(settings.applicationId)\n        .read()\n\n    log('Application', 'fetched', app)\n    return new EVT.App(app.appApiKey)\n}\n\nasync function createUser (app) {\n    let user = await app.appUser().create({ anonymous: true })\n    log('User', 'created', user)\n    return new EVT.User(user, app)\n}\n\nasync function createCollection (user) {\n    let collection = await user.collection().create({\n        'name': `${PREFIX} Collection`,\n    })\n\n    log('Collection', 'created', collection)\n    return collection\n}\n\nasync function createThng (user, rules, properties) {\n    let thng = await user.thng().create({\n        'name': `${PREFIX} Thng`,\n        'properties': _.assign(properties, rules),\n    })\n\n    log('Thng', 'created', thng)\n    return user.thng(thng.id)\n}\n\nasync function createActionTypes (names) {\n    return Promise.all(names.map(async (name) => {\n        try {\n            let actionType = await operator.actionType().create({ name })\n            // TODO: rescope action types\n\n            log('ActionType', 'created', actionType)\n            return actionType\n\n        } catch (error) {\n            if (error.status !== 409)\n                console.error(JSON.stringify(error))\n        }\n    }))\n}\n\nasync function deleteAllActions (user) {\n    await user.action('all').read().then((actions) => {\n\n        return Promise.all(_.map(actions, (action) => {\n            return operator.action(action.type, action.id).delete()\n\n        })).catch((error) => {\n            console.log(`Error deleting Actions: ${JSON.stringify(error, null, 2)}`)\n        })\n    })\n\n    console.log('All Actions deleted')\n}\n\nasync function setupFixtures () {\n    let project = await fetchProject(settings)\n    let app = await fetchApp(settings)\n    let user = await createUser(app)\n    await deleteAllActions(user)\n    let collection = await createCollection(user)\n    await createActionTypes(['_dim', '_on', '_off'])\n\n    return { project, app, user, collection }\n}\n\nasync function tearDown (fixtures) {\n    await deleteAllActions(fixtures.user)\n}\n\nasync function test1 (t) {\n    let { user, collection } = await setupFixtures()\n    let rule = getSampleRule()\n    rule.conditions = [\n        {\n            'variable': 'occupancy_detected',\n            'operator': '=',\n            'value': true,\n            'logical_operator': 'and',\n        },\n        {\n            'variable': 'ambient_light',\n            'operator': '>',\n            'value': 10,\n            'logical_operator': null,\n        },\n    ]\n    rule.operations = [\n        {\n            'collections': [\n                collection.id\n            ],\n            'actions': [\n                {\n                    'name': '_off'\n                },\n                {\n                    'name': '_dim',\n                    'parameters': {\n                        'value': 1\n                    }\n                }\n            ]\n        }\n    ]\n\n    let rules = { '__rule__7828728700101': rule }\n\n    let properties = {\n        'occupancy_detected': false,\n        'ambient_light': 9,\n    }\n\n    let actions = await user.action('all').read()\n    t.equal(actions.length, 0)\n\n    let thng = await createThng(user, rules, properties)\n\n    sleep.sleep(1)\n    actions = await user.action('all').read()\n    t.equal(actions.length, 0)\n\n    let props = await thng.property('ambient_light').update(11)\n    let ambient_light = props[0].value\n    t.equal(ambient_light, 11)\n\n    props = await thng.property('occupancy_detected').update(true)\n    let occupancy_detected = props[0].value\n    t.equal(occupancy_detected, true)\n\n    sleep.sleep(1)\n\n    actions = await user.action('all').read()\n\n    t.equal(actions.length, 2)\n\n    await tearDown({ user })\n}\n\nasync function test2 (t) {\n    let { user, collection } = await setupFixtures()\n    let rule = getSampleRule()\n    let today = moment.utc().format('ddd').toLowerCase()\n    console.log(today)\n    rule.conditions = [\n        {\n            'variable': 'day_of_week',\n            'operator': '=',\n            'value': [\n                today\n            ],\n            'logical_operator': 'and',\n        },\n        {\n            'variable': 'occupancy_detected',\n            'operator': '=',\n            'value': false,\n            'logical_operator': null,\n        },\n    ]\n    rule.operations = [\n        {\n            'collections': [\n                collection.id\n            ],\n            'actions': [\n                {\n                    'name': '_dim',\n                    'parameters': {\n                        'value': 5\n                    }\n                },\n            ]\n        }\n    ]\n\n    let rules = { '__rule__7828728700101': rule }\n\n    let properties = {\n        'occupancy_detected': false,\n        'colour_temperature': 3,\n    }\n\n    let actions = await user.action('all').read()\n    t.equal(actions.length, 0)\n\n    let thng = await createThng(user, rules, properties)\n\n    sleep.sleep(1)\n    actions = await user.action('all').read()\n    t.equal(actions.length, 1)\n    t.equal(actions[0].type, '_dim')\n    t.equal(actions[0].customFields.value, 5)\n\n    // This update should, since we've waited.\n    let props = await thng.property('colour_temperature').update(4)\n    let colour_temperature = props[0].value\n    t.equal(colour_temperature, 4)\n\n    sleep.sleep(1)\n    actions = await user.action('all').read()\n    t.equal(actions.length, 2)\n\n    await tearDown({ user })\n}\n    \nasync function test3 (t) {\n    let { user, collection } = await setupFixtures()\n    let rule = getSampleRule()\n    let soon = moment.utc().add(5, 'seconds').format('HH:mm:ss')\n    rule.conditions = [\n        {\n            'variable': 'time_of_day',\n            'operator': '>',\n            'value': soon,\n            'logical_operator': null,\n        },\n    ]\n    rule.operations = [\n        {\n            'collections': [\n                collection.id\n            ],\n            'actions': [\n                {\n                    'name': '_on'\n                },\n            ]\n        }\n    ]\n\n    let rules = { '__rule__7828728700101': rule }\n\n    let properties = {\n        'ambient_light': 1,\n    }\n\n    let actions = await user.action('all').read()\n    t.equal(actions.length, 0)\n\n    let thng = await createThng(user, rules, properties)\n\n    sleep.sleep(1)\n    actions = await user.action('all').read()\n    t.equal(actions.length, 0)\n\n    // This update shouldn't trigger an action, since it's not time yet.\n    let props = await thng.property('ambient_light').update(2)\n    let ambient_light = props[0].value\n    t.equal(ambient_light, 2)\n\n    sleep.sleep(1)\n    actions = await user.action('all').read()\n    t.equal(actions.length, 0)\n\n    sleep.sleep(3)\n\n    // This update should, since we've waited.\n    props = await thng.property('ambient_light').update(3)\n    ambient_light = props[0].value\n    t.equal(ambient_light, 3)\n\n    sleep.sleep(1)\n    actions = await user.action('all').read()\n    t.equal(actions.length, 1)\n    t.equal(actions.length, 1)\n    t.equal(actions[0].type, '_on')\n\n    await tearDown({ user })\n}\n\ntest('Integration tests', async (t) => {\n    console.log('###############################################################')\n    console.log('1. MAKE SURE THE REACTOR IS FINISHED UPLOADING.')\n    console.log('2. MAKE SURE THE VALUES IN `uploadSettings.json` ARE CORRECT.')\n    console.log('3. IF THE TESTS FAIL, RUN THEM A FEW MORE TIMES. IT MAY HAVE')\n    console.log('   BEEN A CONNECTION/TIMING ISSUE.')\n    console.log('###############################################################')\n    await test1(t)\n    await test2(t)\n    await test3(t)\n})\n"
      ]
    },
    "mtime": 1472741138000
  },
  "{\"filename\":\"/Users/dtr/gooee/javascript-sdk-v2/src/auth.js\",\"env\":{},\"retainLines\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"presets\":[],\"plugins\":[[[],null],[[],null],[[],{\"loose\":false,\"spec\":false}],[[],null],[[],null],[[],{\"spec\":false}],[[],null],[[],{\"loose\":false}],[[],null],[[],null],[[],null],[[],{\"loose\":false}],[[],{\"loose\":false}],[[],null],[[],null],[[],null],[[],{\"loose\":false}],[[],null],[[],{\"loose\":false}],[[],null],[[],null],[[],{\"loose\":false}],[[],{\"async\":false,\"asyncGenerators\":false}]],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"minified\":false,\"sourceRoot\":\"/Users/dtr/gooee/javascript-sdk-v2/src\",\"babelrc\":true,\"sourceType\":\"module\",\"moduleIds\":false,\"passPerPreset\":false,\"parserOpts\":false,\"generatorOpts\":false}:6.16.0": {
    "metadata": {
      "usedHelpers": [
        "createClass",
        "classCallCheck",
        "interopRequireDefault"
      ],
      "marked": [],
      "modules": {
        "imports": [
          {
            "source": "request-promise",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "request"
              }
            ]
          }
        ],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      }
    },
    "options": {
      "filename": "/Users/dtr/gooee/javascript-sdk-v2/src/auth.js",
      "filenameRelative": "/Users/dtr/gooee/javascript-sdk-v2/src/auth.js",
      "env": {},
      "retainLines": false,
      "highlightCode": true,
      "suppressDeprecationMessages": false,
      "presets": [],
      "plugins": [
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false,
            "spec": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "spec": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          {
            "async": false,
            "asyncGenerators": false
          }
        ]
      ],
      "ignore": [],
      "code": true,
      "metadata": true,
      "ast": false,
      "comments": true,
      "compact": "auto",
      "minified": false,
      "sourceMaps": "both",
      "sourceMapTarget": "auth.js",
      "sourceFileName": "auth.js",
      "sourceRoot": "/Users/dtr/gooee/javascript-sdk-v2/src",
      "babelrc": false,
      "sourceType": "module",
      "moduleRoot": "/Users/dtr/gooee/javascript-sdk-v2/src",
      "moduleIds": false,
      "passPerPreset": false,
      "parserOpts": false,
      "generatorOpts": false,
      "basename": "auth"
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _requestPromise = require('request-promise');\n\nvar _requestPromise2 = _interopRequireDefault(_requestPromise);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar BASE_URL = 'https://stage-api.gooee.io';\n\nfunction _ref2(error) {\n    console.error(error);\n}\n\nfunction _ref() {\n    var _this = this;\n\n    return (0, _requestPromise2.default)(this._loginInfo).then(function (response) {\n        _this.token = response.token;\n        console.log(_this.token);\n    }).catch(_ref2);\n}\n\nvar User = function () {\n    function User(username, password) {\n        _classCallCheck(this, User);\n\n        this.username = username;\n        this.password = password;\n        this.token = null;\n\n        this._loginInfo = {\n            method: 'POST',\n            json: true,\n            url: BASE_URL + '/auth/login',\n            body: {\n                username: this.username,\n                password: this.password\n            }\n        };\n    }\n\n    _createClass(User, [{\n        key: 'login',\n        value: _ref\n    }]);\n\n    return User;\n}();\n\nexports.default = User;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF1dGguanMiXSwibmFtZXMiOlsiQkFTRV9VUkwiLCJlcnJvciIsImNvbnNvbGUiLCJfbG9naW5JbmZvIiwidGhlbiIsInJlc3BvbnNlIiwidG9rZW4iLCJsb2ciLCJjYXRjaCIsIlVzZXIiLCJ1c2VybmFtZSIsInBhc3N3b3JkIiwibWV0aG9kIiwianNvbiIsInVybCIsImJvZHkiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQUE7Ozs7Ozs7O0FBRUEsSUFBTUEsV0FBVyw0QkFBakI7O0FBMEJtQixlQUFDQyxLQUFELEVBQVc7QUFDZEMsWUFBUUQsS0FBUixDQUFjQSxLQUFkO0FBQ0g7O2dCQVJBO0FBQUE7O0FBQ0wsV0FBTyw4QkFBUSxLQUFLRSxVQUFiLEVBQ0ZDLElBREUsQ0FDRyxVQUFDQyxRQUFELEVBQWM7QUFDaEIsY0FBS0MsS0FBTCxHQUFhRCxTQUFTQyxLQUF0QjtBQUNBSixnQkFBUUssR0FBUixDQUFZLE1BQUtELEtBQWpCO0FBQ0gsS0FKRSxFQUtGRSxLQUxFLE9BQVA7QUFRSDs7SUEzQkNDLEk7QUFFRixrQkFBYUMsUUFBYixFQUF1QkMsUUFBdkIsRUFBaUM7QUFBQTs7QUFDN0IsYUFBS0QsUUFBTCxHQUFnQkEsUUFBaEI7QUFDQSxhQUFLQyxRQUFMLEdBQWdCQSxRQUFoQjtBQUNBLGFBQUtMLEtBQUwsR0FBYSxJQUFiOztBQUVBLGFBQUtILFVBQUwsR0FBa0I7QUFDZFMsb0JBQVEsTUFETTtBQUVkQyxrQkFBTSxJQUZRO0FBR2RDLGlCQUFRZCxRQUFSLGdCQUhjO0FBSWRlLGtCQUFNO0FBQ0ZMLDBCQUFVLEtBQUtBLFFBRGI7QUFFRkMsMEJBQVUsS0FBS0E7QUFGYjtBQUpRLFNBQWxCO0FBU0g7Ozs7Ozs7Ozs7a0JBY1VGLEkiLCJmaWxlIjoiYXV0aC5qcyIsInNvdXJjZVJvb3QiOiIvVXNlcnMvZHRyL2dvb2VlL2phdmFzY3JpcHQtc2RrLXYyL3NyYyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCByZXF1ZXN0IGZyb20gJ3JlcXVlc3QtcHJvbWlzZSdcblxuY29uc3QgQkFTRV9VUkwgPSAnaHR0cHM6Ly9zdGFnZS1hcGkuZ29vZWUuaW8nXG5cbmNsYXNzIFVzZXIge1xuXG4gICAgY29uc3RydWN0b3IgKHVzZXJuYW1lLCBwYXNzd29yZCkge1xuICAgICAgICB0aGlzLnVzZXJuYW1lID0gdXNlcm5hbWVcbiAgICAgICAgdGhpcy5wYXNzd29yZCA9IHBhc3N3b3JkXG4gICAgICAgIHRoaXMudG9rZW4gPSBudWxsXG5cbiAgICAgICAgdGhpcy5fbG9naW5JbmZvID0ge1xuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICBqc29uOiB0cnVlLFxuICAgICAgICAgICAgdXJsOiBgJHtCQVNFX1VSTH0vYXV0aC9sb2dpbmAsXG4gICAgICAgICAgICBib2R5OiB7XG4gICAgICAgICAgICAgICAgdXNlcm5hbWU6IHRoaXMudXNlcm5hbWUsXG4gICAgICAgICAgICAgICAgcGFzc3dvcmQ6IHRoaXMucGFzc3dvcmQsXG4gICAgICAgICAgICB9LFxuICAgICAgICB9XG4gICAgfVxuXG4gICAgbG9naW4gKCkge1xuICAgICAgICByZXR1cm4gcmVxdWVzdCh0aGlzLl9sb2dpbkluZm8pXG4gICAgICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnRva2VuID0gcmVzcG9uc2UudG9rZW5cbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyh0aGlzLnRva2VuKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKVxuICAgICAgICAgICAgfSlcbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFVzZXIiXX0=",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "auth.js"
      ],
      "names": [
        "BASE_URL",
        "error",
        "console",
        "_loginInfo",
        "then",
        "response",
        "token",
        "log",
        "catch",
        "User",
        "username",
        "password",
        "method",
        "json",
        "url",
        "body"
      ],
      "mappings": ";;;;;;;;AAAA;;;;;;;;AAEA,IAAMA,WAAW,4BAAjB;;AA0BmB,eAACC,KAAD,EAAW;AACdC,YAAQD,KAAR,CAAcA,KAAd;AACH;;gBARA;AAAA;;AACL,WAAO,8BAAQ,KAAKE,UAAb,EACFC,IADE,CACG,UAACC,QAAD,EAAc;AAChB,cAAKC,KAAL,GAAaD,SAASC,KAAtB;AACAJ,gBAAQK,GAAR,CAAY,MAAKD,KAAjB;AACH,KAJE,EAKFE,KALE,OAAP;AAQH;;IA3BCC,I;AAEF,kBAAaC,QAAb,EAAuBC,QAAvB,EAAiC;AAAA;;AAC7B,aAAKD,QAAL,GAAgBA,QAAhB;AACA,aAAKC,QAAL,GAAgBA,QAAhB;AACA,aAAKL,KAAL,GAAa,IAAb;;AAEA,aAAKH,UAAL,GAAkB;AACdS,oBAAQ,MADM;AAEdC,kBAAM,IAFQ;AAGdC,iBAAQd,QAAR,gBAHc;AAIde,kBAAM;AACFL,0BAAU,KAAKA,QADb;AAEFC,0BAAU,KAAKA;AAFb;AAJQ,SAAlB;AASH;;;;;;;;;;kBAcUF,I",
      "file": "auth.js",
      "sourceRoot": "/Users/dtr/gooee/javascript-sdk-v2/src",
      "sourcesContent": [
        "import request from 'request-promise'\n\nconst BASE_URL = 'https://stage-api.gooee.io'\n\nclass User {\n\n    constructor (username, password) {\n        this.username = username\n        this.password = password\n        this.token = null\n\n        this._loginInfo = {\n            method: 'POST',\n            json: true,\n            url: `${BASE_URL}/auth/login`,\n            body: {\n                username: this.username,\n                password: this.password,\n            },\n        }\n    }\n\n    login () {\n        return request(this._loginInfo)\n            .then((response) => {\n                this.token = response.token\n                console.log(this.token)\n            })\n            .catch((error) => {\n                console.error(error)\n            })\n    }\n}\n\nexport default User"
      ]
    },
    "mtime": 1475271733000
  },
  "{\"filename\":\"/Users/dtr/try/rxjs/index.js\",\"env\":{},\"retainLines\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"presets\":[],\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"minified\":false,\"sourceRoot\":\"/Users/dtr/try/rxjs\",\"babelrc\":true,\"sourceType\":\"module\",\"moduleIds\":false,\"passPerPreset\":false,\"parserOpts\":false,\"generatorOpts\":false}:6.17.0": {
    "metadata": {
      "usedHelpers": [],
      "marked": [],
      "modules": {
        "imports": [
          {
            "source": "rxjs/Rx",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "Rx"
              }
            ]
          }
        ],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      }
    },
    "options": {
      "filename": "/Users/dtr/try/rxjs/index.js",
      "filenameRelative": "/Users/dtr/try/rxjs/index.js",
      "env": {},
      "retainLines": false,
      "highlightCode": true,
      "suppressDeprecationMessages": false,
      "presets": [],
      "plugins": [],
      "ignore": [],
      "code": true,
      "metadata": true,
      "ast": false,
      "comments": true,
      "compact": "auto",
      "minified": false,
      "sourceMaps": "both",
      "sourceMapTarget": "index.js",
      "sourceFileName": "index.js",
      "sourceRoot": "/Users/dtr/try/rxjs",
      "babelrc": false,
      "sourceType": "module",
      "moduleRoot": "/Users/dtr/try/rxjs",
      "moduleIds": false,
      "passPerPreset": false,
      "parserOpts": false,
      "generatorOpts": false,
      "basename": "index"
    },
    "ignored": false,
    "code": "import Rx from 'rxjs/Rx';\n\nRx.Observable.of(1, 2, 3).map(x => x + '!!!').toPromise().then(value => console.log(value));\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbIlJ4IiwiT2JzZXJ2YWJsZSIsIm9mIiwibWFwIiwieCIsInRvUHJvbWlzZSIsInRoZW4iLCJ2YWx1ZSIsImNvbnNvbGUiLCJsb2ciXSwibWFwcGluZ3MiOiJBQUFBLE9BQU9BLEVBQVAsTUFBZSxTQUFmOztBQUVBQSxHQUFHQyxVQUFILENBQWNDLEVBQWQsQ0FBaUIsQ0FBakIsRUFBbUIsQ0FBbkIsRUFBcUIsQ0FBckIsRUFDS0MsR0FETCxDQUNTQyxLQUFLQSxJQUFJLEtBRGxCLEVBRUtDLFNBRkwsR0FHS0MsSUFITCxDQUdXQyxLQUFELElBQVdDLFFBQVFDLEdBQVIsQ0FBWUYsS0FBWixDQUhyQiIsImZpbGUiOiJpbmRleC5qcyIsInNvdXJjZVJvb3QiOiIvVXNlcnMvZHRyL3RyeS9yeGpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJ4IGZyb20gJ3J4anMvUngnXG5cblJ4Lk9ic2VydmFibGUub2YoMSwyLDMpXG4gICAgLm1hcCh4ID0+IHggKyAnISEhJylcbiAgICAudG9Qcm9taXNlKClcbiAgICAudGhlbigodmFsdWUpID0+IGNvbnNvbGUubG9nKHZhbHVlKSlcblxuIl19",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "index.js"
      ],
      "names": [
        "Rx",
        "Observable",
        "of",
        "map",
        "x",
        "toPromise",
        "then",
        "value",
        "console",
        "log"
      ],
      "mappings": "AAAA,OAAOA,EAAP,MAAe,SAAf;;AAEAA,GAAGC,UAAH,CAAcC,EAAd,CAAiB,CAAjB,EAAmB,CAAnB,EAAqB,CAArB,EACKC,GADL,CACSC,KAAKA,IAAI,KADlB,EAEKC,SAFL,GAGKC,IAHL,CAGWC,KAAD,IAAWC,QAAQC,GAAR,CAAYF,KAAZ,CAHrB",
      "file": "index.js",
      "sourceRoot": "/Users/dtr/try/rxjs",
      "sourcesContent": [
        "import Rx from 'rxjs/Rx'\n\nRx.Observable.of(1,2,3)\n    .map(x => x + '!!!')\n    .toPromise()\n    .then((value) => console.log(value))\n\n"
      ]
    },
    "mtime": 1476404701000
  },
  "{\"filename\":\"/Users/dtr/try/rxjs/index.js\",\"env\":{},\"retainLines\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"presets\":[],\"plugins\":[[[],{\"loose\":false,\"spec\":false}],[[],null],[[],null],[[],{\"spec\":false}],[[],null],[[],{\"loose\":false}],[[],null],[[],null],[[],null],[[],{\"loose\":false}],[[],{\"loose\":false}],[[],null],[[],null],[[],null],[[],{\"loose\":false}],[[],null],[[],{\"loose\":false}],[[],null],[[],null],[[],{\"loose\":false}],[[],{\"async\":false,\"asyncGenerators\":false}]],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"minified\":false,\"sourceRoot\":\"/Users/dtr/try/rxjs\",\"babelrc\":true,\"sourceType\":\"module\",\"moduleIds\":false,\"passPerPreset\":false,\"parserOpts\":false,\"generatorOpts\":false}:6.17.0": {
    "metadata": {
      "usedHelpers": [
        "interopRequireDefault"
      ],
      "marked": [],
      "modules": {
        "imports": [
          {
            "source": "rx",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "Rx"
              }
            ]
          }
        ],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      }
    },
    "options": {
      "filename": "/Users/dtr/try/rxjs/index.js",
      "filenameRelative": "/Users/dtr/try/rxjs/index.js",
      "env": {},
      "retainLines": false,
      "highlightCode": true,
      "suppressDeprecationMessages": false,
      "presets": [],
      "plugins": [
        [
          [],
          {
            "loose": false,
            "spec": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "spec": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          {
            "async": false,
            "asyncGenerators": false
          }
        ]
      ],
      "ignore": [],
      "code": true,
      "metadata": true,
      "ast": false,
      "comments": true,
      "compact": "auto",
      "minified": false,
      "sourceMaps": "both",
      "sourceMapTarget": "index.js",
      "sourceFileName": "index.js",
      "sourceRoot": "/Users/dtr/try/rxjs",
      "babelrc": false,
      "sourceType": "module",
      "moduleRoot": "/Users/dtr/try/rxjs",
      "moduleIds": false,
      "passPerPreset": false,
      "parserOpts": false,
      "generatorOpts": false,
      "basename": "index"
    },
    "ignored": false,
    "code": "'use strict';\n\nvar _rx = require('rx');\n\nvar _rx2 = _interopRequireDefault(_rx);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n_rx2.default.Observable.of(1, 2, 3).map(function (x) {\n    return x + '!!!';\n}).toPromise().then(function (a, b, c) {\n    return console.log(a, b, c);\n});\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbIk9ic2VydmFibGUiLCJvZiIsIm1hcCIsIngiLCJ0b1Byb21pc2UiLCJ0aGVuIiwiYSIsImIiLCJjIiwiY29uc29sZSIsImxvZyJdLCJtYXBwaW5ncyI6Ijs7QUFBQTs7Ozs7O0FBRUEsYUFBR0EsVUFBSCxDQUFjQyxFQUFkLENBQWlCLENBQWpCLEVBQW1CLENBQW5CLEVBQXFCLENBQXJCLEVBQ0tDLEdBREwsQ0FDUztBQUFBLFdBQUtDLElBQUksS0FBVDtBQUFBLENBRFQsRUFFS0MsU0FGTCxHQUdLQyxJQUhMLENBR1UsVUFBQ0MsQ0FBRCxFQUFHQyxDQUFILEVBQUtDLENBQUw7QUFBQSxXQUFXQyxRQUFRQyxHQUFSLENBQVlKLENBQVosRUFBY0MsQ0FBZCxFQUFnQkMsQ0FBaEIsQ0FBWDtBQUFBLENBSFYiLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiL1VzZXJzL2R0ci90cnkvcnhqcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSeCBmcm9tICdyeCdcblxuUnguT2JzZXJ2YWJsZS5vZigxLDIsMylcbiAgICAubWFwKHggPT4geCArICchISEnKVxuICAgIC50b1Byb21pc2UoKVxuICAgIC50aGVuKChhLGIsYykgPT4gY29uc29sZS5sb2coYSxiLGMpKVxuXG4iXX0=",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "index.js"
      ],
      "names": [
        "Observable",
        "of",
        "map",
        "x",
        "toPromise",
        "then",
        "a",
        "b",
        "c",
        "console",
        "log"
      ],
      "mappings": ";;AAAA;;;;;;AAEA,aAAGA,UAAH,CAAcC,EAAd,CAAiB,CAAjB,EAAmB,CAAnB,EAAqB,CAArB,EACKC,GADL,CACS;AAAA,WAAKC,IAAI,KAAT;AAAA,CADT,EAEKC,SAFL,GAGKC,IAHL,CAGU,UAACC,CAAD,EAAGC,CAAH,EAAKC,CAAL;AAAA,WAAWC,QAAQC,GAAR,CAAYJ,CAAZ,EAAcC,CAAd,EAAgBC,CAAhB,CAAX;AAAA,CAHV",
      "file": "index.js",
      "sourceRoot": "/Users/dtr/try/rxjs",
      "sourcesContent": [
        "import Rx from 'rx'\n\nRx.Observable.of(1,2,3)\n    .map(x => x + '!!!')\n    .toPromise()\n    .then((a,b,c) => console.log(a,b,c))\n\n"
      ]
    },
    "mtime": 1476405220000
  },
  "{\"filename\":\"/Users/dtr/gooee/ecmascript-sdk/src/main.js\",\"env\":{},\"retainLines\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"presets\":[],\"plugins\":[[[],null],[[],null],[[],null],[[],{\"loose\":false,\"spec\":false}],[[],null],[[],null],[[],{\"spec\":false}],[[],null],[[],{\"loose\":false}],[[],null],[[],null],[[],null],[[],{\"loose\":false}],[[],{\"loose\":false}],[[],null],[[],null],[[],null],[[],{\"loose\":false}],[[],null],[[],{\"loose\":false}],[[],null],[[],null],[[],{\"loose\":false}],[[],{\"async\":false,\"asyncGenerators\":false}]],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"minified\":false,\"sourceRoot\":\"/Users/dtr/gooee/ecmascript-sdk/src\",\"babelrc\":true,\"sourceType\":\"module\",\"moduleIds\":false,\"passPerPreset\":false,\"parserOpts\":false,\"generatorOpts\":false}:6.17.0": {
    "metadata": {
      "usedHelpers": [
        "interopRequireDefault",
        "typeof"
      ],
      "marked": [],
      "modules": {
        "imports": [
          {
            "source": "./auth",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "User"
              }
            ]
          },
          {
            "source": "./entities",
            "imported": [
              "Buildings",
              "Customers",
              "Devices",
              "Manufacturers",
              "Spaces"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "Buildings",
                "local": "Buildings"
              },
              {
                "kind": "named",
                "imported": "Customers",
                "local": "Customers"
              },
              {
                "kind": "named",
                "imported": "Devices",
                "local": "Devices"
              },
              {
                "kind": "named",
                "imported": "Manufacturers",
                "local": "Manufacturers"
              },
              {
                "kind": "named",
                "imported": "Spaces",
                "local": "Spaces"
              }
            ]
          }
        ],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      }
    },
    "options": {
      "filename": "/Users/dtr/gooee/ecmascript-sdk/src/main.js",
      "filenameRelative": "/Users/dtr/gooee/ecmascript-sdk/src/main.js",
      "env": {},
      "retainLines": false,
      "highlightCode": true,
      "suppressDeprecationMessages": false,
      "presets": [],
      "plugins": [
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false,
            "spec": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "spec": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          {
            "async": false,
            "asyncGenerators": false
          }
        ]
      ],
      "ignore": [],
      "code": true,
      "metadata": true,
      "ast": false,
      "comments": true,
      "compact": "auto",
      "minified": false,
      "sourceMaps": "both",
      "sourceMapTarget": "main.js",
      "sourceFileName": "main.js",
      "sourceRoot": "/Users/dtr/gooee/ecmascript-sdk/src",
      "babelrc": false,
      "sourceType": "module",
      "moduleRoot": "/Users/dtr/gooee/ecmascript-sdk/src",
      "moduleIds": false,
      "passPerPreset": false,
      "parserOpts": false,
      "generatorOpts": false,
      "basename": "main"
    },
    "ignored": false,
    "code": "'use strict';\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _auth = require('./auth');\n\nvar _auth2 = _interopRequireDefault(_auth);\n\nvar _entities = require('./entities');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nFunction.prototype.$asyncbind = function $asyncbind(self, catcher) {\n    'use strict';\n\n    if (!Function.prototype.$asyncbind) {\n        Object.defineProperty(Function.prototype, '$asyncbind', {\n            value: $asyncbind,\n            enumerable: false,\n            configurable: true,\n            writable: true\n        });\n    }\n\n    if (!$asyncbind.trampoline) {\n        $asyncbind.trampoline = function trampoline(t, x, s, e) {\n            return function b(q) {\n                while (q) {\n                    if (q.then) return q.then(b, e);\n\n                    try {\n                        if (q.pop) {\n                            if (q.length) return q.pop() ? x.call(t) : q;\n                            q = s;\n                        } else q = q.call(t);\n                    } catch (r) {\n                        return e(r);\n                    }\n                }\n            };\n        };\n    }\n\n    if (!$asyncbind.LazyThenable) {\n        $asyncbind.LazyThenable = function () {\n            function isThenable(obj) {\n                return obj && obj instanceof Object && typeof obj.then === 'function';\n            }\n\n            function resolution(p, r, how) {\n                try {\n                    var x = how ? how(r) : r;\n                    if (p === x) return p.reject(new TypeError('Promise resolution loop'));\n\n                    if (isThenable(x)) {\n                        x.then(function (y) {\n                            resolution(p, y);\n                        }, function (e) {\n                            p.reject(e);\n                        });\n                    } else {\n                        p.resolve(x);\n                    }\n                } catch (ex) {\n                    p.reject(ex);\n                }\n            }\n\n            function Chained() {}\n\n            ;\n            Chained.prototype = {\n                resolve: _unchained,\n                reject: _unchained,\n                then: thenChain\n            };\n\n            function _unchained(v) {}\n\n            function thenChain(res, rej) {\n                this.resolve = res;\n                this.reject = rej;\n            }\n\n            function then(res, rej) {\n                var chain = new Chained();\n\n                try {\n                    this._resolver(function (value) {\n                        return isThenable(value) ? value.then(res, rej) : resolution(chain, value, res);\n                    }, function (ex) {\n                        resolution(chain, ex, rej);\n                    });\n                } catch (ex) {\n                    resolution(chain, ex, rej);\n                }\n\n                return chain;\n            }\n\n            function Thenable(resolver) {\n                this._resolver = resolver;\n                this.then = then;\n            }\n\n            ;\n\n            Thenable.resolve = function (v) {\n                return Thenable.isThenable(v) ? v : {\n                    then: function then(resolve) {\n                        return resolve(v);\n                    }\n                };\n            };\n\n            Thenable.isThenable = isThenable;\n            return Thenable;\n        }();\n\n        $asyncbind.EagerThenable = $asyncbind.Thenable = ($asyncbind.EagerThenableFactory = function (tick) {\n            tick = tick || (typeof process === 'undefined' ? 'undefined' : _typeof(process)) === 'object' && process.nextTick || typeof setImmediate === 'function' && setImmediate || function (f) {\n                setTimeout(f, 0);\n            };\n\n            var soon = function () {\n                var fq = [],\n                    fqStart = 0,\n                    bufferSize = 1024;\n\n                function callQueue() {\n                    while (fq.length - fqStart) {\n                        fq[fqStart]();\n                        fq[fqStart++] = undefined;\n\n                        if (fqStart === bufferSize) {\n                            fq.splice(0, bufferSize);\n                            fqStart = 0;\n                        }\n                    }\n                }\n\n                return function (fn) {\n                    fq.push(fn);\n                    if (fq.length - fqStart === 1) tick(callQueue);\n                };\n            }();\n\n            function Zousan(func) {\n                if (func) {\n                    var me = this;\n                    func(function (arg) {\n                        me.resolve(arg);\n                    }, function (arg) {\n                        me.reject(arg);\n                    });\n                }\n            }\n\n            Zousan.prototype = {\n                resolve: function resolve(value) {\n                    if (this.state !== undefined) return;\n                    if (value === this) return this.reject(new TypeError('Attempt to resolve promise with self'));\n                    var me = this;\n\n                    if (value && (typeof value === 'function' || (typeof value === 'undefined' ? 'undefined' : _typeof(value)) === 'object')) {\n                        try {\n                            var first = 0;\n                            var then = value.then;\n\n                            if (typeof then === 'function') {\n                                then.call(value, function (ra) {\n                                    if (!first++) {\n                                        me.resolve(ra);\n                                    }\n                                }, function (rr) {\n                                    if (!first++) {\n                                        me.reject(rr);\n                                    }\n                                });\n                                return;\n                            }\n                        } catch (e) {\n                            if (!first) this.reject(e);\n                            return;\n                        }\n                    }\n\n                    this.state = STATE_FULFILLED;\n                    this.v = value;\n                    if (me.c) soon(function () {\n                        for (var n = 0, l = me.c.length; n < l; n++) {\n                            STATE_FULFILLED(me.c[n], value);\n                        }\n                    });\n                },\n                reject: function reject(reason) {\n                    if (this.state !== undefined) return;\n                    this.state = STATE_REJECTED;\n                    this.v = reason;\n                    var clients = this.c;\n                    if (clients) soon(function () {\n                        for (var n = 0, l = clients.length; n < l; n++) {\n                            STATE_REJECTED(clients[n], reason);\n                        }\n                    });\n                },\n                then: function then(onF, onR) {\n                    var p = new Zousan();\n                    var client = {\n                        y: onF,\n                        n: onR,\n                        p: p\n                    };\n\n                    if (this.state === undefined) {\n                        if (this.c) this.c.push(client);else this.c = [client];\n                    } else {\n                        var s = this.state,\n                            a = this.v;\n                        soon(function () {\n                            s(client, a);\n                        });\n                    }\n\n                    return p;\n                }\n            };\n\n            function STATE_FULFILLED(c, arg) {\n                if (typeof c.y === 'function') {\n                    try {\n                        var yret = c.y.call(undefined, arg);\n                        c.p.resolve(yret);\n                    } catch (err) {\n                        c.p.reject(err);\n                    }\n                } else c.p.resolve(arg);\n            }\n\n            function STATE_REJECTED(c, reason) {\n                if (typeof c.n === 'function') {\n                    try {\n                        var yret = c.n.call(undefined, reason);\n                        c.p.resolve(yret);\n                    } catch (err) {\n                        c.p.reject(err);\n                    }\n                } else c.p.reject(reason);\n            }\n\n            Zousan.resolve = function (val) {\n                if (val && val instanceof Zousan) return val;\n                var z = new Zousan();\n                z.resolve(val);\n                return z;\n            };\n\n            Zousan.reject = function (err) {\n                if (err && err instanceof Zousan) return err;\n                var z = new Zousan();\n                z.reject(err);\n                return z;\n            };\n\n            Zousan.version = '2.3.2-nodent';\n            return Zousan;\n        })();\n    }\n\n    var resolver = this;\n\n    switch (catcher) {\n        case true:\n            return new $asyncbind.Thenable(boundThen);\n\n        case 0:\n            return new $asyncbind.LazyThenable(boundThen);\n\n        case undefined:\n            boundThen.then = boundThen;\n            return boundThen;\n\n        default:\n            return function () {\n                try {\n                    return resolver.apply(self, arguments);\n                } catch (ex) {\n                    return catcher(ex);\n                }\n            };\n    }\n\n    function boundThen() {\n        return resolver.apply(self, arguments);\n    }\n};\n\n/**\n * This file is a stub, used as a test script. It may be removed entirely.\n */\n/* eslint no-console: 0 */\nglobal.Promise = require('bluebird');\n// import 'source-map-support/register' // TODO: remove this on prod\n\nfunction main() {\n    return new Promise(function ($return, $error) {\n        var user, manufacturer, manufacturer2, customer, building, space, gateway, device;\n        return new _auth2.default('dustin@gooee.com', 'g0033107').login().then(function ($await_1) {\n            user = $await_1;\n\n            return (0, _entities.Manufacturers)(user).create({ name: 'manu1' }).then(function ($await_2) {\n                manufacturer = $await_2;\n                return (0, _entities.Manufacturers)(user).create({ name: 'manu2' }).then(function ($await_3) {\n                    manufacturer2 = $await_3;\n\n                    return (0, _entities.Customers)(user).create({\n                        name: 'unique',\n                        manufacturers: [manufacturer.id, manufacturer2.id]\n                    }).then(function ($await_4) {\n                        customer = $await_4;\n\n                        return (0, _entities.Buildings)(user).create({\n                            name: 'aBuilding',\n                            customer: customer.id\n                        }).then(function ($await_5) {\n                            building = $await_5;\n\n                            return (0, _entities.Spaces)(user).create({\n                                name: 'unique',\n                                type: 'floor',\n                                building: building.id\n                            }).then(function ($await_6) {\n                                space = $await_6;\n\n                                return (0, _entities.Devices)(user).create({\n                                    name: 'my gateway',\n                                    type: 'gateway',\n                                    spaces: [space.id]\n                                }).then(function ($await_7) {\n                                    gateway = $await_7;\n\n                                    return (0, _entities.Devices)(user).create({\n                                        name: 'my wim',\n                                        type: 'wim',\n                                        parent_device: gateway.id,\n                                        spaces: [space.id]\n                                    }).then(function ($await_8) {\n                                        device = $await_8;\n\n                                        console.log(device);\n                                        // for (let manu of await customer.data('manufacturers')) {\n                                        //     console.log(await manu)\n                                        // }\n                                        // console.log(await customer.data())\n                                        // // Create a Building.\n                                        // const building = await Buildings(user).create({\n                                        //     name: 'unique',\n                                        //     customer: customer.data.id,\n                                        // })\n                                        //\n                                        // // Create a Space.\n                                        // const space = await Spaces(user).create({\n                                        //     name: 'unique',\n                                        //     type: 'floor',\n                                        //     building: building.data.id,\n                                        // })\n                                        //\n                                        // console.log(space)\n                                        //\n                                        // // Lazily iterate over all Manufacturers 1 by 1.\n                                        // const iter = Manufacturers(user).iterate({\n                                        //     'name__icontains': ['quux', 'bar'],\n                                        // })\n                                        //\n                                        // for (let manu of iter) {\n                                        //     console.log(await manu)\n                                        // }\n                                        //\n                                        // // Fetch all the Manufacturers at once.\n                                        // const ents =\n                                        // await Manufacturers(user).list({ 'name__icontains': 'Quux' })\n                                        // console.log(ents)\n                                        return $return();\n                                    }.$asyncbind(this, $error), $error);\n                                }.$asyncbind(this, $error), $error);\n                            }.$asyncbind(this, $error), $error);\n                        }.$asyncbind(this, $error), $error);\n                    }.$asyncbind(this, $error), $error);\n                }.$asyncbind(this, $error), $error);\n            }.$asyncbind(this, $error), $error);\n        }.$asyncbind(this, $error), $error);\n    }.$asyncbind(this));\n}\n\nmain();\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiZ2xvYmFsIiwiUHJvbWlzZSIsInJlcXVpcmUiLCJtYWluIiwibG9naW4iLCJ1c2VyIiwiY3JlYXRlIiwibmFtZSIsIm1hbnVmYWN0dXJlciIsIm1hbnVmYWN0dXJlcjIiLCJtYW51ZmFjdHVyZXJzIiwiaWQiLCJjdXN0b21lciIsImJ1aWxkaW5nIiwidHlwZSIsInNwYWNlIiwic3BhY2VzIiwiZ2F0ZXdheSIsInBhcmVudF9kZXZpY2UiLCJkZXZpY2UiLCJjb25zb2xlIiwibG9nIl0sIm1hcHBpbmdzIjoiOzs7O0FBT0E7Ozs7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQVJBOzs7QUFHQTtBQUNBQSxPQUFPQyxPQUFQLEdBQWlCQyxRQUFRLFVBQVIsQ0FBakI7QUFDQTs7QUFPQSxTQUFlQyxJQUFmO0FBQUE7QUFBQSxZQUNVLElBRFYsRUFHVSxZQUhWLEVBSVUsYUFKVixFQU1VLFFBTlYsRUFXVSxRQVhWLEVBZ0JVLEtBaEJWLEVBc0JVLE9BdEJWLEVBNEJVLE1BNUJWO0FBQ2lCLGVBQU0sbUJBQVMsa0JBQVQsRUFBNkIsVUFBN0IsRUFBeUNDLEtBQXpDLEVBQU47QUFBUEMsZ0JBQU4sR0FBYSxRQUFiOztBQUVxQixtQkFBTSw2QkFBY0EsSUFBZCxFQUFvQkMsTUFBcEIsQ0FBMkIsRUFBRUMsTUFBTSxPQUFSLEVBQTNCLENBQU47QUFBZkMsNEJBQU4sR0FBcUIsUUFBckI7QUFDc0IsdUJBQU0sNkJBQWNILElBQWQsRUFBb0JDLE1BQXBCLENBQTJCLEVBQUVDLE1BQU0sT0FBUixFQUEzQixDQUFOO0FBQWhCRSxpQ0FBTixHQUFzQixRQUF0Qjs7QUFFaUIsMkJBQU0seUJBQVVKLElBQVYsRUFBZ0JDLE1BQWhCLENBQXVCO0FBQzFDQyw4QkFBTSxRQURvQztBQUUxQ0csdUNBQWUsQ0FBQ0YsYUFBYUcsRUFBZCxFQUFrQkYsY0FBY0UsRUFBaEM7QUFGMkIscUJBQXZCLENBQU47QUFBWEMsZ0NBQU4sR0FBaUIsUUFBakI7O0FBS2lCLCtCQUFNLHlCQUFVUCxJQUFWLEVBQWdCQyxNQUFoQixDQUF1QjtBQUMxQ0Msa0NBQU0sV0FEb0M7QUFFMUNLLHNDQUFVQSxTQUFTRDtBQUZ1Qix5QkFBdkIsQ0FBTjtBQUFYRSxvQ0FBTixHQUFpQixRQUFqQjs7QUFLYyxtQ0FBTSxzQkFBT1IsSUFBUCxFQUFhQyxNQUFiLENBQW9CO0FBQ3BDQyxzQ0FBTSxRQUQ4QjtBQUVwQ08sc0NBQU0sT0FGOEI7QUFHcENELDBDQUFVQSxTQUFTRjtBQUhpQiw2QkFBcEIsQ0FBTjtBQUFSSSxxQ0FBTixHQUFjLFFBQWQ7O0FBTWdCLHVDQUFNLHVCQUFRVixJQUFSLEVBQWNDLE1BQWQsQ0FBcUI7QUFDdkNDLDBDQUFNLFlBRGlDO0FBRXZDTywwQ0FBTSxTQUZpQztBQUd2Q0UsNENBQVEsQ0FBQ0QsTUFBTUosRUFBUDtBQUgrQixpQ0FBckIsQ0FBTjtBQUFWTSwyQ0FBTixHQUFnQixRQUFoQjs7QUFNZSwyQ0FBTSx1QkFBUVosSUFBUixFQUFjQyxNQUFkLENBQXFCO0FBQ3RDQyw4Q0FBTSxRQURnQztBQUV0Q08sOENBQU0sS0FGZ0M7QUFHdENJLHVEQUFlRCxRQUFRTixFQUhlO0FBSXRDSyxnREFBUSxDQUFDRCxNQUFNSixFQUFQO0FBSjhCLHFDQUFyQixDQUFOO0FBQVRRLDhDQUFOLEdBQWUsUUFBZjs7QUFPQUMsZ0RBQVFDLEdBQVIsQ0FBWUYsTUFBWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF2Q2U7QUFBQTtBQU5DO0FBTkY7QUFMRztBQUxBO0FBRks7QUFERDtBQUZSO0FBRGpCO0FBQUE7O0FBc0VBaEIiLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZVJvb3QiOiIvVXNlcnMvZHRyL2dvb2VlL2VjbWFzY3JpcHQtc2RrL3NyYyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogVGhpcyBmaWxlIGlzIGEgc3R1YiwgdXNlZCBhcyBhIHRlc3Qgc2NyaXB0LiBJdCBtYXkgYmUgcmVtb3ZlZCBlbnRpcmVseS5cbiAqL1xuLyogZXNsaW50IG5vLWNvbnNvbGU6IDAgKi9cbmdsb2JhbC5Qcm9taXNlID0gcmVxdWlyZSgnYmx1ZWJpcmQnKVxuLy8gaW1wb3J0ICdzb3VyY2UtbWFwLXN1cHBvcnQvcmVnaXN0ZXInIC8vIFRPRE86IHJlbW92ZSB0aGlzIG9uIHByb2RcblxuaW1wb3J0IFVzZXIgZnJvbSAnLi9hdXRoJ1xuaW1wb3J0IHtcbiAgICBCdWlsZGluZ3MsIEN1c3RvbWVycywgRGV2aWNlcywgTWFudWZhY3R1cmVycywgU3BhY2VzLFxufSBmcm9tICcuL2VudGl0aWVzJ1xuXG5hc3luYyBmdW5jdGlvbiBtYWluICgpIHtcbiAgICBjb25zdCB1c2VyID0gYXdhaXQgbmV3IFVzZXIoJ2R1c3RpbkBnb29lZS5jb20nLCAnZzAwMzMxMDcnKS5sb2dpbigpXG5cbiAgICBjb25zdCBtYW51ZmFjdHVyZXIgPSBhd2FpdCBNYW51ZmFjdHVyZXJzKHVzZXIpLmNyZWF0ZSh7IG5hbWU6ICdtYW51MScgfSlcbiAgICBjb25zdCBtYW51ZmFjdHVyZXIyID0gYXdhaXQgTWFudWZhY3R1cmVycyh1c2VyKS5jcmVhdGUoeyBuYW1lOiAnbWFudTInIH0pXG5cbiAgICBjb25zdCBjdXN0b21lciA9IGF3YWl0IEN1c3RvbWVycyh1c2VyKS5jcmVhdGUoe1xuICAgICAgICBuYW1lOiAndW5pcXVlJyxcbiAgICAgICAgbWFudWZhY3R1cmVyczogW21hbnVmYWN0dXJlci5pZCwgbWFudWZhY3R1cmVyMi5pZF0sXG4gICAgfSlcblxuICAgIGNvbnN0IGJ1aWxkaW5nID0gYXdhaXQgQnVpbGRpbmdzKHVzZXIpLmNyZWF0ZSh7XG4gICAgICAgIG5hbWU6ICdhQnVpbGRpbmcnLFxuICAgICAgICBjdXN0b21lcjogY3VzdG9tZXIuaWQsXG4gICAgfSlcblxuICAgIGNvbnN0IHNwYWNlID0gYXdhaXQgU3BhY2VzKHVzZXIpLmNyZWF0ZSh7XG4gICAgICAgIG5hbWU6ICd1bmlxdWUnLFxuICAgICAgICB0eXBlOiAnZmxvb3InLFxuICAgICAgICBidWlsZGluZzogYnVpbGRpbmcuaWQsXG4gICAgfSlcblxuICAgIGNvbnN0IGdhdGV3YXkgPSBhd2FpdCBEZXZpY2VzKHVzZXIpLmNyZWF0ZSh7XG4gICAgICAgIG5hbWU6ICdteSBnYXRld2F5JyxcbiAgICAgICAgdHlwZTogJ2dhdGV3YXknLFxuICAgICAgICBzcGFjZXM6IFtzcGFjZS5pZF0sXG4gICAgfSlcblxuICAgIGNvbnN0IGRldmljZSA9IGF3YWl0IERldmljZXModXNlcikuY3JlYXRlKHtcbiAgICAgICAgbmFtZTogJ215IHdpbScsXG4gICAgICAgIHR5cGU6ICd3aW0nLFxuICAgICAgICBwYXJlbnRfZGV2aWNlOiBnYXRld2F5LmlkLFxuICAgICAgICBzcGFjZXM6IFtzcGFjZS5pZF0sXG4gICAgfSlcblxuICAgIGNvbnNvbGUubG9nKGRldmljZSlcbiAgICAvLyBmb3IgKGxldCBtYW51IG9mIGF3YWl0IGN1c3RvbWVyLmRhdGEoJ21hbnVmYWN0dXJlcnMnKSkge1xuICAgIC8vICAgICBjb25zb2xlLmxvZyhhd2FpdCBtYW51KVxuICAgIC8vIH1cbiAgICAvLyBjb25zb2xlLmxvZyhhd2FpdCBjdXN0b21lci5kYXRhKCkpXG4gICAgLy8gLy8gQ3JlYXRlIGEgQnVpbGRpbmcuXG4gICAgLy8gY29uc3QgYnVpbGRpbmcgPSBhd2FpdCBCdWlsZGluZ3ModXNlcikuY3JlYXRlKHtcbiAgICAvLyAgICAgbmFtZTogJ3VuaXF1ZScsXG4gICAgLy8gICAgIGN1c3RvbWVyOiBjdXN0b21lci5kYXRhLmlkLFxuICAgIC8vIH0pXG4gICAgLy9cbiAgICAvLyAvLyBDcmVhdGUgYSBTcGFjZS5cbiAgICAvLyBjb25zdCBzcGFjZSA9IGF3YWl0IFNwYWNlcyh1c2VyKS5jcmVhdGUoe1xuICAgIC8vICAgICBuYW1lOiAndW5pcXVlJyxcbiAgICAvLyAgICAgdHlwZTogJ2Zsb29yJyxcbiAgICAvLyAgICAgYnVpbGRpbmc6IGJ1aWxkaW5nLmRhdGEuaWQsXG4gICAgLy8gfSlcbiAgICAvL1xuICAgIC8vIGNvbnNvbGUubG9nKHNwYWNlKVxuICAgIC8vXG4gICAgLy8gLy8gTGF6aWx5IGl0ZXJhdGUgb3ZlciBhbGwgTWFudWZhY3R1cmVycyAxIGJ5IDEuXG4gICAgLy8gY29uc3QgaXRlciA9IE1hbnVmYWN0dXJlcnModXNlcikuaXRlcmF0ZSh7XG4gICAgLy8gICAgICduYW1lX19pY29udGFpbnMnOiBbJ3F1dXgnLCAnYmFyJ10sXG4gICAgLy8gfSlcbiAgICAvL1xuICAgIC8vIGZvciAobGV0IG1hbnUgb2YgaXRlcikge1xuICAgIC8vICAgICBjb25zb2xlLmxvZyhhd2FpdCBtYW51KVxuICAgIC8vIH1cbiAgICAvL1xuICAgIC8vIC8vIEZldGNoIGFsbCB0aGUgTWFudWZhY3R1cmVycyBhdCBvbmNlLlxuICAgIC8vIGNvbnN0IGVudHMgPVxuICAgIC8vIGF3YWl0IE1hbnVmYWN0dXJlcnModXNlcikubGlzdCh7ICduYW1lX19pY29udGFpbnMnOiAnUXV1eCcgfSlcbiAgICAvLyBjb25zb2xlLmxvZyhlbnRzKVxufVxuXG5tYWluKClcbiJdfQ==",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "main.js"
      ],
      "names": [
        "global",
        "Promise",
        "require",
        "main",
        "login",
        "user",
        "create",
        "name",
        "manufacturer",
        "manufacturer2",
        "manufacturers",
        "id",
        "customer",
        "building",
        "type",
        "space",
        "spaces",
        "gateway",
        "parent_device",
        "device",
        "console",
        "log"
      ],
      "mappings": ";;;;AAOA;;;;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AARA;;;AAGA;AACAA,OAAOC,OAAP,GAAiBC,QAAQ,UAAR,CAAjB;AACA;;AAOA,SAAeC,IAAf;AAAA;AAAA,YACU,IADV,EAGU,YAHV,EAIU,aAJV,EAMU,QANV,EAWU,QAXV,EAgBU,KAhBV,EAsBU,OAtBV,EA4BU,MA5BV;AACiB,eAAM,mBAAS,kBAAT,EAA6B,UAA7B,EAAyCC,KAAzC,EAAN;AAAPC,gBAAN,GAAa,QAAb;;AAEqB,mBAAM,6BAAcA,IAAd,EAAoBC,MAApB,CAA2B,EAAEC,MAAM,OAAR,EAA3B,CAAN;AAAfC,4BAAN,GAAqB,QAArB;AACsB,uBAAM,6BAAcH,IAAd,EAAoBC,MAApB,CAA2B,EAAEC,MAAM,OAAR,EAA3B,CAAN;AAAhBE,iCAAN,GAAsB,QAAtB;;AAEiB,2BAAM,yBAAUJ,IAAV,EAAgBC,MAAhB,CAAuB;AAC1CC,8BAAM,QADoC;AAE1CG,uCAAe,CAACF,aAAaG,EAAd,EAAkBF,cAAcE,EAAhC;AAF2B,qBAAvB,CAAN;AAAXC,gCAAN,GAAiB,QAAjB;;AAKiB,+BAAM,yBAAUP,IAAV,EAAgBC,MAAhB,CAAuB;AAC1CC,kCAAM,WADoC;AAE1CK,sCAAUA,SAASD;AAFuB,yBAAvB,CAAN;AAAXE,oCAAN,GAAiB,QAAjB;;AAKc,mCAAM,sBAAOR,IAAP,EAAaC,MAAb,CAAoB;AACpCC,sCAAM,QAD8B;AAEpCO,sCAAM,OAF8B;AAGpCD,0CAAUA,SAASF;AAHiB,6BAApB,CAAN;AAARI,qCAAN,GAAc,QAAd;;AAMgB,uCAAM,uBAAQV,IAAR,EAAcC,MAAd,CAAqB;AACvCC,0CAAM,YADiC;AAEvCO,0CAAM,SAFiC;AAGvCE,4CAAQ,CAACD,MAAMJ,EAAP;AAH+B,iCAArB,CAAN;AAAVM,2CAAN,GAAgB,QAAhB;;AAMe,2CAAM,uBAAQZ,IAAR,EAAcC,MAAd,CAAqB;AACtCC,8CAAM,QADgC;AAEtCO,8CAAM,KAFgC;AAGtCI,uDAAeD,QAAQN,EAHe;AAItCK,gDAAQ,CAACD,MAAMJ,EAAP;AAJ8B,qCAArB,CAAN;AAATQ,8CAAN,GAAe,QAAf;;AAOAC,gDAAQC,GAAR,CAAYF,MAAZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAvCe;AAAA;AANC;AANF;AALG;AALA;AAFK;AADD;AAFR;AADjB;AAAA;;AAsEAhB",
      "file": "main.js",
      "sourceRoot": "/Users/dtr/gooee/ecmascript-sdk/src",
      "sourcesContent": [
        "/**\n * This file is a stub, used as a test script. It may be removed entirely.\n */\n/* eslint no-console: 0 */\nglobal.Promise = require('bluebird')\n// import 'source-map-support/register' // TODO: remove this on prod\n\nimport User from './auth'\nimport {\n    Buildings, Customers, Devices, Manufacturers, Spaces,\n} from './entities'\n\nasync function main () {\n    const user = await new User('dustin@gooee.com', 'g0033107').login()\n\n    const manufacturer = await Manufacturers(user).create({ name: 'manu1' })\n    const manufacturer2 = await Manufacturers(user).create({ name: 'manu2' })\n\n    const customer = await Customers(user).create({\n        name: 'unique',\n        manufacturers: [manufacturer.id, manufacturer2.id],\n    })\n\n    const building = await Buildings(user).create({\n        name: 'aBuilding',\n        customer: customer.id,\n    })\n\n    const space = await Spaces(user).create({\n        name: 'unique',\n        type: 'floor',\n        building: building.id,\n    })\n\n    const gateway = await Devices(user).create({\n        name: 'my gateway',\n        type: 'gateway',\n        spaces: [space.id],\n    })\n\n    const device = await Devices(user).create({\n        name: 'my wim',\n        type: 'wim',\n        parent_device: gateway.id,\n        spaces: [space.id],\n    })\n\n    console.log(device)\n    // for (let manu of await customer.data('manufacturers')) {\n    //     console.log(await manu)\n    // }\n    // console.log(await customer.data())\n    // // Create a Building.\n    // const building = await Buildings(user).create({\n    //     name: 'unique',\n    //     customer: customer.data.id,\n    // })\n    //\n    // // Create a Space.\n    // const space = await Spaces(user).create({\n    //     name: 'unique',\n    //     type: 'floor',\n    //     building: building.data.id,\n    // })\n    //\n    // console.log(space)\n    //\n    // // Lazily iterate over all Manufacturers 1 by 1.\n    // const iter = Manufacturers(user).iterate({\n    //     'name__icontains': ['quux', 'bar'],\n    // })\n    //\n    // for (let manu of iter) {\n    //     console.log(await manu)\n    // }\n    //\n    // // Fetch all the Manufacturers at once.\n    // const ents =\n    // await Manufacturers(user).list({ 'name__icontains': 'Quux' })\n    // console.log(ents)\n}\n\nmain()\n"
      ]
    },
    "mtime": 1476990516000
  },
  "{\"filename\":\"/Users/dtr/gooee/ecmascript-sdk/src/auth.js\",\"env\":{},\"retainLines\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"presets\":[],\"plugins\":[[[],null],[[],null],[[],null],[[],{\"loose\":false,\"spec\":false}],[[],null],[[],null],[[],{\"spec\":false}],[[],null],[[],{\"loose\":false}],[[],null],[[],null],[[],null],[[],{\"loose\":false}],[[],{\"loose\":false}],[[],null],[[],null],[[],null],[[],{\"loose\":false}],[[],null],[[],{\"loose\":false}],[[],null],[[],null],[[],{\"loose\":false}],[[],{\"async\":false,\"asyncGenerators\":false}]],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"minified\":false,\"sourceRoot\":\"/Users/dtr/gooee/ecmascript-sdk/src\",\"babelrc\":true,\"sourceType\":\"module\",\"moduleIds\":false,\"passPerPreset\":false,\"parserOpts\":false,\"generatorOpts\":false}:6.17.0": {
    "metadata": {
      "usedHelpers": [
        "inherits",
        "possibleConstructorReturn",
        "classCallCheck",
        "createClass",
        "interopRequireWildcard",
        "typeof"
      ],
      "marked": [],
      "modules": {
        "imports": [
          {
            "source": "./types",
            "imported": [
              "JsonObject",
              "SimpleResponse"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "JsonObject",
                "local": "JsonObject"
              },
              {
                "kind": "named",
                "imported": "SimpleResponse",
                "local": "SimpleResponse"
              }
            ]
          },
          {
            "source": "./api",
            "imported": [
              "*"
            ],
            "specifiers": [
              {
                "kind": "namespace",
                "local": "api"
              }
            ]
          },
          {
            "source": "./api",
            "imported": [
              "InvalidResponse"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "InvalidResponse",
                "local": "InvalidResponse"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "AuthorizationError",
            "AuthResponse",
            "login",
            "username",
            "password",
            "User"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "AuthorizationError",
              "exported": "AuthorizationError"
            },
            {
              "kind": "local",
              "local": "AuthResponse",
              "exported": "AuthResponse"
            },
            {
              "kind": "local",
              "local": "login",
              "exported": "login"
            },
            {
              "kind": "local",
              "local": "username",
              "exported": "username"
            },
            {
              "kind": "local",
              "local": "password",
              "exported": "password"
            },
            {
              "kind": "local",
              "local": "User",
              "exported": "User"
            }
          ]
        }
      }
    },
    "options": {
      "filename": "/Users/dtr/gooee/ecmascript-sdk/src/auth.js",
      "filenameRelative": "/Users/dtr/gooee/ecmascript-sdk/src/auth.js",
      "env": {},
      "retainLines": false,
      "highlightCode": true,
      "suppressDeprecationMessages": false,
      "presets": [],
      "plugins": [
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false,
            "spec": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "spec": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          {
            "async": false,
            "asyncGenerators": false
          }
        ]
      ],
      "ignore": [],
      "code": true,
      "metadata": true,
      "ast": false,
      "comments": true,
      "compact": "auto",
      "minified": false,
      "sourceMaps": "both",
      "sourceMapTarget": "auth.js",
      "sourceFileName": "auth.js",
      "sourceRoot": "/Users/dtr/gooee/ecmascript-sdk/src",
      "babelrc": false,
      "sourceType": "module",
      "moduleRoot": "/Users/dtr/gooee/ecmascript-sdk/src",
      "moduleIds": false,
      "passPerPreset": false,
      "parserOpts": false,
      "generatorOpts": false,
      "basename": "auth"
    },
    "ignored": false,
    "code": "'use strict';\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.User = exports.login = exports.AuthorizationError = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _api = require('./api');\n\nvar api = _interopRequireWildcard(_api);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nFunction.prototype.$asyncbind = function $asyncbind(self, catcher) {\n    'use strict';\n\n    if (!Function.prototype.$asyncbind) {\n        Object.defineProperty(Function.prototype, '$asyncbind', {\n            value: $asyncbind,\n            enumerable: false,\n            configurable: true,\n            writable: true\n        });\n    }\n\n    if (!$asyncbind.trampoline) {\n        $asyncbind.trampoline = function trampoline(t, x, s, e) {\n            return function b(q) {\n                while (q) {\n                    if (q.then) return q.then(b, e);\n\n                    try {\n                        if (q.pop) {\n                            if (q.length) return q.pop() ? x.call(t) : q;\n                            q = s;\n                        } else q = q.call(t);\n                    } catch (r) {\n                        return e(r);\n                    }\n                }\n            };\n        };\n    }\n\n    if (!$asyncbind.LazyThenable) {\n        $asyncbind.LazyThenable = function () {\n            function isThenable(obj) {\n                return obj && obj instanceof Object && typeof obj.then === 'function';\n            }\n\n            function resolution(p, r, how) {\n                try {\n                    var x = how ? how(r) : r;\n                    if (p === x) return p.reject(new TypeError('Promise resolution loop'));\n\n                    if (isThenable(x)) {\n                        x.then(function (y) {\n                            resolution(p, y);\n                        }, function (e) {\n                            p.reject(e);\n                        });\n                    } else {\n                        p.resolve(x);\n                    }\n                } catch (ex) {\n                    p.reject(ex);\n                }\n            }\n\n            function Chained() {}\n\n            ;\n            Chained.prototype = {\n                resolve: _unchained,\n                reject: _unchained,\n                then: thenChain\n            };\n\n            function _unchained(v) {}\n\n            function thenChain(res, rej) {\n                this.resolve = res;\n                this.reject = rej;\n            }\n\n            function then(res, rej) {\n                var chain = new Chained();\n\n                try {\n                    this._resolver(function (value) {\n                        return isThenable(value) ? value.then(res, rej) : resolution(chain, value, res);\n                    }, function (ex) {\n                        resolution(chain, ex, rej);\n                    });\n                } catch (ex) {\n                    resolution(chain, ex, rej);\n                }\n\n                return chain;\n            }\n\n            function Thenable(resolver) {\n                this._resolver = resolver;\n                this.then = then;\n            }\n\n            ;\n\n            Thenable.resolve = function (v) {\n                return Thenable.isThenable(v) ? v : {\n                    then: function then(resolve) {\n                        return resolve(v);\n                    }\n                };\n            };\n\n            Thenable.isThenable = isThenable;\n            return Thenable;\n        }();\n\n        $asyncbind.EagerThenable = $asyncbind.Thenable = ($asyncbind.EagerThenableFactory = function (tick) {\n            tick = tick || (typeof process === 'undefined' ? 'undefined' : _typeof(process)) === 'object' && process.nextTick || typeof setImmediate === 'function' && setImmediate || function (f) {\n                setTimeout(f, 0);\n            };\n\n            var soon = function () {\n                var fq = [],\n                    fqStart = 0,\n                    bufferSize = 1024;\n\n                function callQueue() {\n                    while (fq.length - fqStart) {\n                        fq[fqStart]();\n                        fq[fqStart++] = undefined;\n\n                        if (fqStart === bufferSize) {\n                            fq.splice(0, bufferSize);\n                            fqStart = 0;\n                        }\n                    }\n                }\n\n                return function (fn) {\n                    fq.push(fn);\n                    if (fq.length - fqStart === 1) tick(callQueue);\n                };\n            }();\n\n            function Zousan(func) {\n                if (func) {\n                    var me = this;\n                    func(function (arg) {\n                        me.resolve(arg);\n                    }, function (arg) {\n                        me.reject(arg);\n                    });\n                }\n            }\n\n            Zousan.prototype = {\n                resolve: function resolve(value) {\n                    if (this.state !== undefined) return;\n                    if (value === this) return this.reject(new TypeError('Attempt to resolve promise with self'));\n                    var me = this;\n\n                    if (value && (typeof value === 'function' || (typeof value === 'undefined' ? 'undefined' : _typeof(value)) === 'object')) {\n                        try {\n                            var first = 0;\n                            var then = value.then;\n\n                            if (typeof then === 'function') {\n                                then.call(value, function (ra) {\n                                    if (!first++) {\n                                        me.resolve(ra);\n                                    }\n                                }, function (rr) {\n                                    if (!first++) {\n                                        me.reject(rr);\n                                    }\n                                });\n                                return;\n                            }\n                        } catch (e) {\n                            if (!first) this.reject(e);\n                            return;\n                        }\n                    }\n\n                    this.state = STATE_FULFILLED;\n                    this.v = value;\n                    if (me.c) soon(function () {\n                        for (var n = 0, l = me.c.length; n < l; n++) {\n                            STATE_FULFILLED(me.c[n], value);\n                        }\n                    });\n                },\n                reject: function reject(reason) {\n                    if (this.state !== undefined) return;\n                    this.state = STATE_REJECTED;\n                    this.v = reason;\n                    var clients = this.c;\n                    if (clients) soon(function () {\n                        for (var n = 0, l = clients.length; n < l; n++) {\n                            STATE_REJECTED(clients[n], reason);\n                        }\n                    });\n                },\n                then: function then(onF, onR) {\n                    var p = new Zousan();\n                    var client = {\n                        y: onF,\n                        n: onR,\n                        p: p\n                    };\n\n                    if (this.state === undefined) {\n                        if (this.c) this.c.push(client);else this.c = [client];\n                    } else {\n                        var s = this.state,\n                            a = this.v;\n                        soon(function () {\n                            s(client, a);\n                        });\n                    }\n\n                    return p;\n                }\n            };\n\n            function STATE_FULFILLED(c, arg) {\n                if (typeof c.y === 'function') {\n                    try {\n                        var yret = c.y.call(undefined, arg);\n                        c.p.resolve(yret);\n                    } catch (err) {\n                        c.p.reject(err);\n                    }\n                } else c.p.resolve(arg);\n            }\n\n            function STATE_REJECTED(c, reason) {\n                if (typeof c.n === 'function') {\n                    try {\n                        var yret = c.n.call(undefined, reason);\n                        c.p.resolve(yret);\n                    } catch (err) {\n                        c.p.reject(err);\n                    }\n                } else c.p.reject(reason);\n            }\n\n            Zousan.resolve = function (val) {\n                if (val && val instanceof Zousan) return val;\n                var z = new Zousan();\n                z.resolve(val);\n                return z;\n            };\n\n            Zousan.reject = function (err) {\n                if (err && err instanceof Zousan) return err;\n                var z = new Zousan();\n                z.reject(err);\n                return z;\n            };\n\n            Zousan.version = '2.3.2-nodent';\n            return Zousan;\n        })();\n    }\n\n    var resolver = this;\n\n    switch (catcher) {\n        case true:\n            return new $asyncbind.Thenable(boundThen);\n\n        case 0:\n            return new $asyncbind.LazyThenable(boundThen);\n\n        case undefined:\n            boundThen.then = boundThen;\n            return boundThen;\n\n        default:\n            return function () {\n                try {\n                    return resolver.apply(self, arguments);\n                } catch (ex) {\n                    return catcher(ex);\n                }\n            };\n    }\n\n    function boundThen() {\n        return resolver.apply(self, arguments);\n    }\n};\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar LOGIN_PATH = 'auth/login';\n\nvar AuthorizationError = exports.AuthorizationError = function (_InvalidResponse) {\n    _inherits(AuthorizationError, _InvalidResponse);\n\n    function AuthorizationError(response) {\n        _classCallCheck(this, AuthorizationError);\n\n        return _possibleConstructorReturn(this, (AuthorizationError.__proto__ || Object.getPrototypeOf(AuthorizationError)).call(this, response, 'There was a problem logging in: '));\n    }\n\n    return AuthorizationError;\n}(_api.InvalidResponse);\n\n/**\n * Login to the Gooee API.\n * Returns a JWT token.\n */\nfunction _login(username, password) {\n    return new Promise(function ($return, $error) {\n        var url, fetchArgs, response;\n\n        url = api.HOST + '/' + LOGIN_PATH;\n        fetchArgs = { body: { username: username, password: password } };\n        return api.request('POST', url, fetchArgs).then(function ($await_1) {\n            response = $await_1;\n\n            if (response.status !== 200) return $error(new AuthorizationError(response));\n\n            return $return(response.body.token);\n        }.$asyncbind(this, $error), $error);\n    }.$asyncbind(this));\n}\n\n/**\n * A Gooee API User, with a username and password.\n */\nexports.login = _login;\n\nvar User = exports.User = function () {\n    function User(username, password) {\n        _classCallCheck(this, User);\n\n        this.username = username;\n        this.password = password;\n        this.token = '';\n    }\n\n    /**\n     * Login to the Gooee API.\n     */\n\n\n    _createClass(User, [{\n        key: 'login',\n        value: function login() {\n            return new Promise(function ($return, $error) {\n                return _login(this.username, this.password).then(function ($await_2) {\n                    this.token = $await_2;\n                    return $return(this);\n                }.$asyncbind(this, $error), $error);\n            }.$asyncbind(this));\n        }\n    }, {\n        key: 'get',\n        value: function get(path) {\n            var $args = arguments;return new Promise(function ($return, $error) {\n                var opts = $args.length > 1 && $args[1] !== undefined ? $args[1] : {};\n\n                return $return(api.request('GET', path, opts, this.token));\n            }.$asyncbind(this));\n        }\n    }, {\n        key: 'post',\n        value: function post(path, body) {\n            var $args = arguments;return new Promise(function ($return, $error) {\n                var opts = $args.length > 2 && $args[2] !== undefined ? $args[2] : {};\n\n                opts.body = body;\n                return $return(api.request('POST', path, opts, this.token));\n            }.$asyncbind(this));\n        }\n    }, {\n        key: 'put',\n        value: function put(path, body) {\n            var $args = arguments;return new Promise(function ($return, $error) {\n                var opts = $args.length > 2 && $args[2] !== undefined ? $args[2] : {};\n\n                opts.body = body;\n                return $return(api.request('PUT', path, opts, this.token));\n            }.$asyncbind(this));\n        }\n    }, {\n        key: 'patch',\n        value: function patch(path, body) {\n            var $args = arguments;return new Promise(function ($return, $error) {\n                var opts = $args.length > 2 && $args[2] !== undefined ? $args[2] : {};\n\n                opts.body = body;\n                return $return(api.request('PATCH', path, opts, this.token));\n            }.$asyncbind(this));\n        }\n    }, {\n        key: 'del',\n        value: function del(path) {\n            var $args = arguments;return new Promise(function ($return, $error) {\n                var opts = $args.length > 1 && $args[1] !== undefined ? $args[1] : {};\n\n                return $return(api.request('DELETE', path, opts, this.token));\n            }.$asyncbind(this));\n        }\n    }]);\n\n    return User;\n}();\n\nexports.default = User;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF1dGguanMiXSwibmFtZXMiOlsiYXBpIiwiTE9HSU5fUEFUSCIsIkF1dGhvcml6YXRpb25FcnJvciIsInJlc3BvbnNlIiwibG9naW4iLCJ1c2VybmFtZSIsInBhc3N3b3JkIiwidXJsIiwiSE9TVCIsImZldGNoQXJncyIsImJvZHkiLCJyZXF1ZXN0Iiwic3RhdHVzIiwidG9rZW4iLCJVc2VyIiwicGF0aCIsIm9wdHMiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBTUE7O0lBQVlBLEc7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFHWixJQUFNQyxhQUFhLFlBQW5COztJQUVhQyxrQixXQUFBQSxrQjs7O0FBRVQsZ0NBQVlDLFFBQVosRUFBeUM7QUFBQTs7QUFBQSx1SUFDL0JBLFFBRCtCLEVBQ3JCLGtDQURxQjtBQUV4Qzs7Ozs7QUFLTDs7OztBQUlPLFNBQWVDLE1BQWYsQ0FDSEMsUUFERyxFQUVIQyxRQUZHO0FBQUE7QUFBQSxZQUlHLEdBSkgsRUFLRyxTQUxILEVBTUcsUUFOSDs7QUFJR0MsV0FBTixHQUFlUCxJQUFJUSxJQUFuQixTQUEyQlAsVUFBM0I7QUFDTVEsaUJBQU4sR0FBa0IsRUFBRUMsTUFBTSxFQUFFTCxrQkFBRixFQUFZQyxrQkFBWixFQUFSLEVBQWxCO0FBQytCLGVBQU1OLElBQUlXLE9BQUosQ0FBWSxNQUFaLEVBQW9CSixHQUFwQixFQUF5QkUsU0FBekIsQ0FBTjtBQUF6Qk4sb0JBQU4sR0FBK0IsUUFBL0I7O0FBRUEsZ0JBQUlBLFNBQVNTLE1BQVQsS0FBb0IsR0FBeEIsRUFDSSxjQUFNLElBQUlWLGtCQUFKLENBQXVCQyxRQUF2QixDQUFOOztBQUVKLDJCQUFPQSxTQUFTTyxJQUFULENBQWNHLEtBQXJCO0FBTCtCO0FBTjVCO0FBQUE7O0FBZVA7Ozs7O0lBR2FDLEksV0FBQUEsSTtBQUtULGtCQUFZVCxRQUFaLEVBQThCQyxRQUE5QixFQUFnRDtBQUFBOztBQUM1QyxhQUFLRCxRQUFMLEdBQWdCQSxRQUFoQjtBQUNBLGFBQUtDLFFBQUwsR0FBZ0JBLFFBQWhCO0FBQ0EsYUFBS08sS0FBTCxHQUFhLEVBQWI7QUFDSDs7QUFFRDs7Ozs7Ozs7O0FBSWlCLHVCQUFNVCxPQUFNLEtBQUtDLFFBQVgsRUFBcUIsS0FBS0MsUUFBMUIsQ0FBTjtBQUFiLHlCQUFLTyxLQUFMLEdBQWEsUUFBYjtBQUNBLG1DQUFPLElBQVA7QUFEYTs7Ozs7NEJBS2JFLEk7O29CQUNBQyxJLDJEQUFlLEU7O0FBRWYsK0JBQU9oQixJQUFJVyxPQUFKLENBQVksS0FBWixFQUFtQkksSUFBbkIsRUFBeUJDLElBQXpCLEVBQStCLEtBQUtILEtBQXBDLENBQVA7Ozs7OzZCQUlBRSxJLEVBQ0FMLEk7O29CQUNBTSxJLDJEQUFlLEU7O0FBRWZBLHFCQUFLTixJQUFMLEdBQVlBLElBQVo7QUFDQSwrQkFBT1YsSUFBSVcsT0FBSixDQUFZLE1BQVosRUFBb0JJLElBQXBCLEVBQTBCQyxJQUExQixFQUFnQyxLQUFLSCxLQUFyQyxDQUFQOzs7Ozs0QkFJQUUsSSxFQUNBTCxJOztvQkFDQU0sSSwyREFBZSxFOztBQUVmQSxxQkFBS04sSUFBTCxHQUFZQSxJQUFaO0FBQ0EsK0JBQU9WLElBQUlXLE9BQUosQ0FBWSxLQUFaLEVBQW1CSSxJQUFuQixFQUF5QkMsSUFBekIsRUFBK0IsS0FBS0gsS0FBcEMsQ0FBUDs7Ozs7OEJBSUFFLEksRUFDQUwsSTs7b0JBQ0FNLEksMkRBQWUsRTs7QUFFZkEscUJBQUtOLElBQUwsR0FBWUEsSUFBWjtBQUNBLCtCQUFPVixJQUFJVyxPQUFKLENBQVksT0FBWixFQUFxQkksSUFBckIsRUFBMkJDLElBQTNCLEVBQWlDLEtBQUtILEtBQXRDLENBQVA7Ozs7OzRCQUlBRSxJOztvQkFDQUMsSSwyREFBZSxFOztBQUVmLCtCQUFPaEIsSUFBSVcsT0FBSixDQUFZLFFBQVosRUFBc0JJLElBQXRCLEVBQTRCQyxJQUE1QixFQUFrQyxLQUFLSCxLQUF2QyxDQUFQOzs7Ozs7OztrQkFJT0MsSSIsImZpbGUiOiJhdXRoLmpzIiwic291cmNlUm9vdCI6Ii9Vc2Vycy9kdHIvZ29vZWUvZWNtYXNjcmlwdC1zZGsvc3JjIiwic291cmNlc0NvbnRlbnQiOlsiLyogQGZsb3cgKi9cbmltcG9ydCB0eXBlIHtcbiAgICBKc29uT2JqZWN0LFxuICAgIFNpbXBsZVJlc3BvbnNlLFxufSBmcm9tICcuL3R5cGVzJ1xuXG5pbXBvcnQgKiBhcyBhcGkgZnJvbSAnLi9hcGknXG5pbXBvcnQgeyBJbnZhbGlkUmVzcG9uc2UgfSBmcm9tICcuL2FwaSdcblxuY29uc3QgTE9HSU5fUEFUSCA9ICdhdXRoL2xvZ2luJ1xuXG5leHBvcnQgY2xhc3MgQXV0aG9yaXphdGlvbkVycm9yIGV4dGVuZHMgSW52YWxpZFJlc3BvbnNlIHtcblxuICAgIGNvbnN0cnVjdG9yKHJlc3BvbnNlOiBTaW1wbGVSZXNwb25zZTwqPikge1xuICAgICAgICBzdXBlcihyZXNwb25zZSwgJ1RoZXJlIHdhcyBhIHByb2JsZW0gbG9nZ2luZyBpbjogJylcbiAgICB9XG59XG5cbmV4cG9ydCB0eXBlIEF1dGhSZXNwb25zZSA9IFNpbXBsZVJlc3BvbnNlPHsgdG9rZW46IHN0cmluZyB9PlxuXG4vKipcbiAqIExvZ2luIHRvIHRoZSBHb29lZSBBUEkuXG4gKiBSZXR1cm5zIGEgSldUIHRva2VuLlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbG9naW4oXG4gICAgdXNlcm5hbWU6IHN0cmluZyxcbiAgICBwYXNzd29yZDogc3RyaW5nXG4pOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIGNvbnN0IHVybCA9IGAke2FwaS5IT1NUfS8ke0xPR0lOX1BBVEh9YFxuICAgIGNvbnN0IGZldGNoQXJncyA9IHsgYm9keTogeyB1c2VybmFtZSwgcGFzc3dvcmQgfSB9XG4gICAgY29uc3QgcmVzcG9uc2U6IEF1dGhSZXNwb25zZSA9IGF3YWl0IGFwaS5yZXF1ZXN0KCdQT1NUJywgdXJsLCBmZXRjaEFyZ3MpXG5cbiAgICBpZiAocmVzcG9uc2Uuc3RhdHVzICE9PSAyMDApXG4gICAgICAgIHRocm93IG5ldyBBdXRob3JpemF0aW9uRXJyb3IocmVzcG9uc2UpXG5cbiAgICByZXR1cm4gcmVzcG9uc2UuYm9keS50b2tlblxufVxuXG5cbi8qKlxuICogQSBHb29lZSBBUEkgVXNlciwgd2l0aCBhIHVzZXJuYW1lIGFuZCBwYXNzd29yZC5cbiAqL1xuZXhwb3J0IGNsYXNzIFVzZXIge1xuICAgIHVzZXJuYW1lOiBzdHJpbmdcbiAgICBwYXNzd29yZDogc3RyaW5nXG4gICAgdG9rZW46IHN0cmluZ1xuXG4gICAgY29uc3RydWN0b3IodXNlcm5hbWU6IHN0cmluZywgcGFzc3dvcmQ6IHN0cmluZykge1xuICAgICAgICB0aGlzLnVzZXJuYW1lID0gdXNlcm5hbWVcbiAgICAgICAgdGhpcy5wYXNzd29yZCA9IHBhc3N3b3JkXG4gICAgICAgIHRoaXMudG9rZW4gPSAnJ1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIExvZ2luIHRvIHRoZSBHb29lZSBBUEkuXG4gICAgICovXG4gICAgYXN5bmMgbG9naW4oKTogUHJvbWlzZTxVc2VyPiB7XG4gICAgICAgIHRoaXMudG9rZW4gPSBhd2FpdCBsb2dpbih0aGlzLnVzZXJuYW1lLCB0aGlzLnBhc3N3b3JkKVxuICAgICAgICByZXR1cm4gdGhpc1xuICAgIH1cblxuICAgIGFzeW5jIGdldChcbiAgICAgICAgcGF0aDogc3RyaW5nLFxuICAgICAgICBvcHRzOiBPYmplY3QgPSB7fVxuICAgICk6IFByb21pc2U8UmVzcG9uc2U+IHtcbiAgICAgICAgcmV0dXJuIGFwaS5yZXF1ZXN0KCdHRVQnLCBwYXRoLCBvcHRzLCB0aGlzLnRva2VuKVxuICAgIH1cblxuICAgIGFzeW5jIHBvc3QoXG4gICAgICAgIHBhdGg6IHN0cmluZyxcbiAgICAgICAgYm9keTogSnNvbk9iamVjdCxcbiAgICAgICAgb3B0czogT2JqZWN0ID0ge31cbiAgICApOiBQcm9taXNlPFJlc3BvbnNlPiB7XG4gICAgICAgIG9wdHMuYm9keSA9IGJvZHlcbiAgICAgICAgcmV0dXJuIGFwaS5yZXF1ZXN0KCdQT1NUJywgcGF0aCwgb3B0cywgdGhpcy50b2tlbilcbiAgICB9XG5cbiAgICBhc3luYyBwdXQoXG4gICAgICAgIHBhdGg6IHN0cmluZyxcbiAgICAgICAgYm9keTogSnNvbk9iamVjdCxcbiAgICAgICAgb3B0czogT2JqZWN0ID0ge31cbiAgICApOiBQcm9taXNlPFJlc3BvbnNlPiB7XG4gICAgICAgIG9wdHMuYm9keSA9IGJvZHlcbiAgICAgICAgcmV0dXJuIGFwaS5yZXF1ZXN0KCdQVVQnLCBwYXRoLCBvcHRzLCB0aGlzLnRva2VuKVxuICAgIH1cblxuICAgIGFzeW5jIHBhdGNoKFxuICAgICAgICBwYXRoOiBzdHJpbmcsXG4gICAgICAgIGJvZHk6IEpzb25PYmplY3QsXG4gICAgICAgIG9wdHM6IE9iamVjdCA9IHt9XG4gICAgKTogUHJvbWlzZTxSZXNwb25zZT4ge1xuICAgICAgICBvcHRzLmJvZHkgPSBib2R5XG4gICAgICAgIHJldHVybiBhcGkucmVxdWVzdCgnUEFUQ0gnLCBwYXRoLCBvcHRzLCB0aGlzLnRva2VuKVxuICAgIH1cblxuICAgIGFzeW5jIGRlbChcbiAgICAgICAgcGF0aDogc3RyaW5nLFxuICAgICAgICBvcHRzOiBPYmplY3QgPSB7fVxuICAgICk6IFByb21pc2U8UmVzcG9uc2U+IHtcbiAgICAgICAgcmV0dXJuIGFwaS5yZXF1ZXN0KCdERUxFVEUnLCBwYXRoLCBvcHRzLCB0aGlzLnRva2VuKVxuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgVXNlclxuIl19",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "auth.js"
      ],
      "names": [
        "api",
        "LOGIN_PATH",
        "AuthorizationError",
        "response",
        "login",
        "username",
        "password",
        "url",
        "HOST",
        "fetchArgs",
        "body",
        "request",
        "status",
        "token",
        "User",
        "path",
        "opts"
      ],
      "mappings": ";;;;;;;;;;;AAMA;;IAAYA,G;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAGZ,IAAMC,aAAa,YAAnB;;IAEaC,kB,WAAAA,kB;;;AAET,gCAAYC,QAAZ,EAAyC;AAAA;;AAAA,uIAC/BA,QAD+B,EACrB,kCADqB;AAExC;;;;;AAKL;;;;AAIO,SAAeC,MAAf,CACHC,QADG,EAEHC,QAFG;AAAA;AAAA,YAIG,GAJH,EAKG,SALH,EAMG,QANH;;AAIGC,WAAN,GAAeP,IAAIQ,IAAnB,SAA2BP,UAA3B;AACMQ,iBAAN,GAAkB,EAAEC,MAAM,EAAEL,kBAAF,EAAYC,kBAAZ,EAAR,EAAlB;AAC+B,eAAMN,IAAIW,OAAJ,CAAY,MAAZ,EAAoBJ,GAApB,EAAyBE,SAAzB,CAAN;AAAzBN,oBAAN,GAA+B,QAA/B;;AAEA,gBAAIA,SAASS,MAAT,KAAoB,GAAxB,EACI,cAAM,IAAIV,kBAAJ,CAAuBC,QAAvB,CAAN;;AAEJ,2BAAOA,SAASO,IAAT,CAAcG,KAArB;AAL+B;AAN5B;AAAA;;AAeP;;;;;IAGaC,I,WAAAA,I;AAKT,kBAAYT,QAAZ,EAA8BC,QAA9B,EAAgD;AAAA;;AAC5C,aAAKD,QAAL,GAAgBA,QAAhB;AACA,aAAKC,QAAL,GAAgBA,QAAhB;AACA,aAAKO,KAAL,GAAa,EAAb;AACH;;AAED;;;;;;;;;AAIiB,uBAAMT,OAAM,KAAKC,QAAX,EAAqB,KAAKC,QAA1B,CAAN;AAAb,yBAAKO,KAAL,GAAa,QAAb;AACA,mCAAO,IAAP;AADa;;;;;4BAKbE,I;;oBACAC,I,2DAAe,E;;AAEf,+BAAOhB,IAAIW,OAAJ,CAAY,KAAZ,EAAmBI,IAAnB,EAAyBC,IAAzB,EAA+B,KAAKH,KAApC,CAAP;;;;;6BAIAE,I,EACAL,I;;oBACAM,I,2DAAe,E;;AAEfA,qBAAKN,IAAL,GAAYA,IAAZ;AACA,+BAAOV,IAAIW,OAAJ,CAAY,MAAZ,EAAoBI,IAApB,EAA0BC,IAA1B,EAAgC,KAAKH,KAArC,CAAP;;;;;4BAIAE,I,EACAL,I;;oBACAM,I,2DAAe,E;;AAEfA,qBAAKN,IAAL,GAAYA,IAAZ;AACA,+BAAOV,IAAIW,OAAJ,CAAY,KAAZ,EAAmBI,IAAnB,EAAyBC,IAAzB,EAA+B,KAAKH,KAApC,CAAP;;;;;8BAIAE,I,EACAL,I;;oBACAM,I,2DAAe,E;;AAEfA,qBAAKN,IAAL,GAAYA,IAAZ;AACA,+BAAOV,IAAIW,OAAJ,CAAY,OAAZ,EAAqBI,IAArB,EAA2BC,IAA3B,EAAiC,KAAKH,KAAtC,CAAP;;;;;4BAIAE,I;;oBACAC,I,2DAAe,E;;AAEf,+BAAOhB,IAAIW,OAAJ,CAAY,QAAZ,EAAsBI,IAAtB,EAA4BC,IAA5B,EAAkC,KAAKH,KAAvC,CAAP;;;;;;;;kBAIOC,I",
      "file": "auth.js",
      "sourceRoot": "/Users/dtr/gooee/ecmascript-sdk/src",
      "sourcesContent": [
        "/* @flow */\nimport type {\n    JsonObject,\n    SimpleResponse,\n} from './types'\n\nimport * as api from './api'\nimport { InvalidResponse } from './api'\n\nconst LOGIN_PATH = 'auth/login'\n\nexport class AuthorizationError extends InvalidResponse {\n\n    constructor(response: SimpleResponse<*>) {\n        super(response, 'There was a problem logging in: ')\n    }\n}\n\nexport type AuthResponse = SimpleResponse<{ token: string }>\n\n/**\n * Login to the Gooee API.\n * Returns a JWT token.\n */\nexport async function login(\n    username: string,\n    password: string\n): Promise<string> {\n    const url = `${api.HOST}/${LOGIN_PATH}`\n    const fetchArgs = { body: { username, password } }\n    const response: AuthResponse = await api.request('POST', url, fetchArgs)\n\n    if (response.status !== 200)\n        throw new AuthorizationError(response)\n\n    return response.body.token\n}\n\n\n/**\n * A Gooee API User, with a username and password.\n */\nexport class User {\n    username: string\n    password: string\n    token: string\n\n    constructor(username: string, password: string) {\n        this.username = username\n        this.password = password\n        this.token = ''\n    }\n\n    /**\n     * Login to the Gooee API.\n     */\n    async login(): Promise<User> {\n        this.token = await login(this.username, this.password)\n        return this\n    }\n\n    async get(\n        path: string,\n        opts: Object = {}\n    ): Promise<Response> {\n        return api.request('GET', path, opts, this.token)\n    }\n\n    async post(\n        path: string,\n        body: JsonObject,\n        opts: Object = {}\n    ): Promise<Response> {\n        opts.body = body\n        return api.request('POST', path, opts, this.token)\n    }\n\n    async put(\n        path: string,\n        body: JsonObject,\n        opts: Object = {}\n    ): Promise<Response> {\n        opts.body = body\n        return api.request('PUT', path, opts, this.token)\n    }\n\n    async patch(\n        path: string,\n        body: JsonObject,\n        opts: Object = {}\n    ): Promise<Response> {\n        opts.body = body\n        return api.request('PATCH', path, opts, this.token)\n    }\n\n    async del(\n        path: string,\n        opts: Object = {}\n    ): Promise<Response> {\n        return api.request('DELETE', path, opts, this.token)\n    }\n}\n\nexport default User\n"
      ]
    },
    "mtime": 1476987718000
  },
  "{\"filename\":\"/Users/dtr/gooee/ecmascript-sdk/src/api.js\",\"env\":{},\"retainLines\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"presets\":[],\"plugins\":[[[],null],[[],null],[[],null],[[],{\"loose\":false,\"spec\":false}],[[],null],[[],null],[[],{\"spec\":false}],[[],null],[[],{\"loose\":false}],[[],null],[[],null],[[],null],[[],{\"loose\":false}],[[],{\"loose\":false}],[[],null],[[],null],[[],null],[[],{\"loose\":false}],[[],null],[[],{\"loose\":false}],[[],null],[[],null],[[],{\"loose\":false}],[[],{\"async\":false,\"asyncGenerators\":false}]],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"minified\":false,\"sourceRoot\":\"/Users/dtr/gooee/ecmascript-sdk/src\",\"babelrc\":true,\"sourceType\":\"module\",\"moduleIds\":false,\"passPerPreset\":false,\"parserOpts\":false,\"generatorOpts\":false}:6.17.0": {
    "metadata": {
      "usedHelpers": [
        "inherits",
        "possibleConstructorReturn",
        "classCallCheck",
        "interopRequireDefault",
        "interopRequireWildcard",
        "typeof"
      ],
      "marked": [],
      "modules": {
        "imports": [
          {
            "source": "isomorphic-fetch",
            "imported": [],
            "specifiers": []
          },
          {
            "source": "bluebird",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "Promise"
              }
            ]
          },
          {
            "source": "es6-error",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "ExtendableError"
              }
            ]
          },
          {
            "source": "lodash",
            "imported": [
              "*"
            ],
            "specifiers": [
              {
                "kind": "namespace",
                "local": "_"
              }
            ]
          },
          {
            "source": "query-string",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "queryString"
              }
            ]
          },
          {
            "source": "./types",
            "imported": [
              "EntityType",
              "HttpMethod",
              "JsonResponse",
              "QueryParams",
              "RequestOptions"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "EntityType",
                "local": "EntityType"
              },
              {
                "kind": "named",
                "imported": "HttpMethod",
                "local": "HttpMethod"
              },
              {
                "kind": "named",
                "imported": "JsonResponse",
                "local": "JsonResponse"
              },
              {
                "kind": "named",
                "imported": "QueryParams",
                "local": "QueryParams"
              },
              {
                "kind": "named",
                "imported": "RequestOptions",
                "local": "RequestOptions"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "HOST",
            "InvalidResponse",
            "validateResponse",
            "expectedStatus",
            "response",
            "errorMsg",
            "getEntityUrl",
            "entityType",
            "id",
            "params",
            "request",
            "method",
            "url",
            "options",
            "token"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "HOST",
              "exported": "HOST"
            },
            {
              "kind": "local",
              "local": "InvalidResponse",
              "exported": "InvalidResponse"
            },
            {
              "kind": "local",
              "local": "validateResponse",
              "exported": "validateResponse"
            },
            {
              "kind": "local",
              "local": "expectedStatus",
              "exported": "expectedStatus"
            },
            {
              "kind": "local",
              "local": "response",
              "exported": "response"
            },
            {
              "kind": "local",
              "local": "errorMsg",
              "exported": "errorMsg"
            },
            {
              "kind": "local",
              "local": "getEntityUrl",
              "exported": "getEntityUrl"
            },
            {
              "kind": "local",
              "local": "entityType",
              "exported": "entityType"
            },
            {
              "kind": "local",
              "local": "id",
              "exported": "id"
            },
            {
              "kind": "local",
              "local": "params",
              "exported": "params"
            },
            {
              "kind": "local",
              "local": "request",
              "exported": "request"
            },
            {
              "kind": "local",
              "local": "method",
              "exported": "method"
            },
            {
              "kind": "local",
              "local": "url",
              "exported": "url"
            },
            {
              "kind": "local",
              "local": "options",
              "exported": "options"
            },
            {
              "kind": "local",
              "local": "token",
              "exported": "token"
            }
          ]
        }
      }
    },
    "options": {
      "filename": "/Users/dtr/gooee/ecmascript-sdk/src/api.js",
      "filenameRelative": "/Users/dtr/gooee/ecmascript-sdk/src/api.js",
      "env": {},
      "retainLines": false,
      "highlightCode": true,
      "suppressDeprecationMessages": false,
      "presets": [],
      "plugins": [
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false,
            "spec": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "spec": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          {
            "async": false,
            "asyncGenerators": false
          }
        ]
      ],
      "ignore": [],
      "code": true,
      "metadata": true,
      "ast": false,
      "comments": true,
      "compact": "auto",
      "minified": false,
      "sourceMaps": "both",
      "sourceMapTarget": "api.js",
      "sourceFileName": "api.js",
      "sourceRoot": "/Users/dtr/gooee/ecmascript-sdk/src",
      "babelrc": false,
      "sourceType": "module",
      "moduleRoot": "/Users/dtr/gooee/ecmascript-sdk/src",
      "moduleIds": false,
      "passPerPreset": false,
      "parserOpts": false,
      "generatorOpts": false,
      "basename": "api"
    },
    "ignored": false,
    "code": "'use strict';\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.InvalidResponse = exports.HOST = undefined;\nexports.validateResponse = validateResponse;\nexports.getEntityUrl = getEntityUrl;\nexports.request = request;\n\nrequire('isomorphic-fetch');\n\nvar _bluebird = require('bluebird');\n\nvar _bluebird2 = _interopRequireDefault(_bluebird);\n\nvar _es6Error = require('es6-error');\n\nvar _es6Error2 = _interopRequireDefault(_es6Error);\n\nvar _lodash = require('lodash');\n\nvar _ = _interopRequireWildcard(_lodash);\n\nvar _queryString = require('query-string');\n\nvar _queryString2 = _interopRequireDefault(_queryString);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nFunction.prototype.$asyncbind = function $asyncbind(self, catcher) {\n    'use strict';\n\n    if (!Function.prototype.$asyncbind) {\n        Object.defineProperty(Function.prototype, '$asyncbind', {\n            value: $asyncbind,\n            enumerable: false,\n            configurable: true,\n            writable: true\n        });\n    }\n\n    if (!$asyncbind.trampoline) {\n        $asyncbind.trampoline = function trampoline(t, x, s, e) {\n            return function b(q) {\n                while (q) {\n                    if (q.then) return q.then(b, e);\n\n                    try {\n                        if (q.pop) {\n                            if (q.length) return q.pop() ? x.call(t) : q;\n                            q = s;\n                        } else q = q.call(t);\n                    } catch (r) {\n                        return e(r);\n                    }\n                }\n            };\n        };\n    }\n\n    if (!$asyncbind.LazyThenable) {\n        $asyncbind.LazyThenable = function () {\n            function isThenable(obj) {\n                return obj && obj instanceof Object && typeof obj.then === 'function';\n            }\n\n            function resolution(p, r, how) {\n                try {\n                    var x = how ? how(r) : r;\n                    if (p === x) return p.reject(new TypeError('Promise resolution loop'));\n\n                    if (isThenable(x)) {\n                        x.then(function (y) {\n                            resolution(p, y);\n                        }, function (e) {\n                            p.reject(e);\n                        });\n                    } else {\n                        p.resolve(x);\n                    }\n                } catch (ex) {\n                    p.reject(ex);\n                }\n            }\n\n            function Chained() {}\n\n            ;\n            Chained.prototype = {\n                resolve: _unchained,\n                reject: _unchained,\n                then: thenChain\n            };\n\n            function _unchained(v) {}\n\n            function thenChain(res, rej) {\n                this.resolve = res;\n                this.reject = rej;\n            }\n\n            function then(res, rej) {\n                var chain = new Chained();\n\n                try {\n                    this._resolver(function (value) {\n                        return isThenable(value) ? value.then(res, rej) : resolution(chain, value, res);\n                    }, function (ex) {\n                        resolution(chain, ex, rej);\n                    });\n                } catch (ex) {\n                    resolution(chain, ex, rej);\n                }\n\n                return chain;\n            }\n\n            function Thenable(resolver) {\n                this._resolver = resolver;\n                this.then = then;\n            }\n\n            ;\n\n            Thenable.resolve = function (v) {\n                return Thenable.isThenable(v) ? v : {\n                    then: function then(resolve) {\n                        return resolve(v);\n                    }\n                };\n            };\n\n            Thenable.isThenable = isThenable;\n            return Thenable;\n        }();\n\n        $asyncbind.EagerThenable = $asyncbind.Thenable = ($asyncbind.EagerThenableFactory = function (tick) {\n            tick = tick || (typeof process === 'undefined' ? 'undefined' : _typeof(process)) === 'object' && process.nextTick || typeof setImmediate === 'function' && setImmediate || function (f) {\n                setTimeout(f, 0);\n            };\n\n            var soon = function () {\n                var fq = [],\n                    fqStart = 0,\n                    bufferSize = 1024;\n\n                function callQueue() {\n                    while (fq.length - fqStart) {\n                        fq[fqStart]();\n                        fq[fqStart++] = undefined;\n\n                        if (fqStart === bufferSize) {\n                            fq.splice(0, bufferSize);\n                            fqStart = 0;\n                        }\n                    }\n                }\n\n                return function (fn) {\n                    fq.push(fn);\n                    if (fq.length - fqStart === 1) tick(callQueue);\n                };\n            }();\n\n            function Zousan(func) {\n                if (func) {\n                    var me = this;\n                    func(function (arg) {\n                        me.resolve(arg);\n                    }, function (arg) {\n                        me.reject(arg);\n                    });\n                }\n            }\n\n            Zousan.prototype = {\n                resolve: function resolve(value) {\n                    if (this.state !== undefined) return;\n                    if (value === this) return this.reject(new TypeError('Attempt to resolve promise with self'));\n                    var me = this;\n\n                    if (value && (typeof value === 'function' || (typeof value === 'undefined' ? 'undefined' : _typeof(value)) === 'object')) {\n                        try {\n                            var first = 0;\n                            var then = value.then;\n\n                            if (typeof then === 'function') {\n                                then.call(value, function (ra) {\n                                    if (!first++) {\n                                        me.resolve(ra);\n                                    }\n                                }, function (rr) {\n                                    if (!first++) {\n                                        me.reject(rr);\n                                    }\n                                });\n                                return;\n                            }\n                        } catch (e) {\n                            if (!first) this.reject(e);\n                            return;\n                        }\n                    }\n\n                    this.state = STATE_FULFILLED;\n                    this.v = value;\n                    if (me.c) soon(function () {\n                        for (var n = 0, l = me.c.length; n < l; n++) {\n                            STATE_FULFILLED(me.c[n], value);\n                        }\n                    });\n                },\n                reject: function reject(reason) {\n                    if (this.state !== undefined) return;\n                    this.state = STATE_REJECTED;\n                    this.v = reason;\n                    var clients = this.c;\n                    if (clients) soon(function () {\n                        for (var n = 0, l = clients.length; n < l; n++) {\n                            STATE_REJECTED(clients[n], reason);\n                        }\n                    });\n                },\n                then: function then(onF, onR) {\n                    var p = new Zousan();\n                    var client = {\n                        y: onF,\n                        n: onR,\n                        p: p\n                    };\n\n                    if (this.state === undefined) {\n                        if (this.c) this.c.push(client);else this.c = [client];\n                    } else {\n                        var s = this.state,\n                            a = this.v;\n                        soon(function () {\n                            s(client, a);\n                        });\n                    }\n\n                    return p;\n                }\n            };\n\n            function STATE_FULFILLED(c, arg) {\n                if (typeof c.y === 'function') {\n                    try {\n                        var yret = c.y.call(undefined, arg);\n                        c.p.resolve(yret);\n                    } catch (err) {\n                        c.p.reject(err);\n                    }\n                } else c.p.resolve(arg);\n            }\n\n            function STATE_REJECTED(c, reason) {\n                if (typeof c.n === 'function') {\n                    try {\n                        var yret = c.n.call(undefined, reason);\n                        c.p.resolve(yret);\n                    } catch (err) {\n                        c.p.reject(err);\n                    }\n                } else c.p.reject(reason);\n            }\n\n            Zousan.resolve = function (val) {\n                if (val && val instanceof Zousan) return val;\n                var z = new Zousan();\n                z.resolve(val);\n                return z;\n            };\n\n            Zousan.reject = function (err) {\n                if (err && err instanceof Zousan) return err;\n                var z = new Zousan();\n                z.reject(err);\n                return z;\n            };\n\n            Zousan.version = '2.3.2-nodent';\n            return Zousan;\n        })();\n    }\n\n    var resolver = this;\n\n    switch (catcher) {\n        case true:\n            return new $asyncbind.Thenable(boundThen);\n\n        case 0:\n            return new $asyncbind.LazyThenable(boundThen);\n\n        case undefined:\n            boundThen.then = boundThen;\n            return boundThen;\n\n        default:\n            return function () {\n                try {\n                    return resolver.apply(self, arguments);\n                } catch (ex) {\n                    return catcher(ex);\n                }\n            };\n    }\n\n    function boundThen() {\n        return resolver.apply(self, arguments);\n    }\n};\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar HOST = exports.HOST = 'http://localhost:8000';\n\n/**\n * Exception for invalid HTTP responses.\n */\n\nvar InvalidResponse = exports.InvalidResponse = function (_ExtendableError) {\n    _inherits(InvalidResponse, _ExtendableError);\n\n    function InvalidResponse(response) {\n        var msgPrefix = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n\n        _classCallCheck(this, InvalidResponse);\n\n        var _this = _possibleConstructorReturn(this, (InvalidResponse.__proto__ || Object.getPrototypeOf(InvalidResponse)).call(this, msgPrefix + JSON.stringify(response)));\n\n        _this.response = response;\n        return _this;\n    }\n\n    return InvalidResponse;\n}(_es6Error2.default);\n\n/**\n * Assert that the given response has the given status code.\n */\n\n\nfunction validateResponse(expectedStatus, response) {\n    var $args = arguments;return new _bluebird2.default(function ($return, $error) {\n        var errorMsg = $args.length > 2 && $args[2] !== undefined ? $args[2] : '';\n\n        if (response.status !== expectedStatus) return $error(new InvalidResponse(response, errorMsg));\n        return $return(response);\n    }.$asyncbind(this));\n}\n\n/**\n * Construct an entity URL.\n */\nfunction getEntityUrl(entityType) {\n    var id = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n    var params = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n\n    var parts = [HOST, entityType + 's'];\n    if (id) parts.push(id);\n    if (params) parts.push('?' + _queryString2.default.stringify(params));\n    return _.join(parts, '/');\n}\n\n/**\n * Make an HTTP request to the Gooee API.\n */\nfunction request(method, url) {\n    var $args = arguments;return new _bluebird2.default(function ($return, $error) {\n        var options, token, response, json;\n        options = $args.length > 2 && $args[2] !== undefined ? $args[2] : {};\n        token = $args.length > 3 && $args[3] !== undefined ? $args[3] : null;\n\n        _.merge(options, {\n            method: method,\n            headers: {\n                'accept': 'application/json'\n            }\n        });\n\n        if (token) _.set(options, 'headers.authorization', 'JWT ' + token);\n\n        if (_.includes(['POST', 'PUT', 'PATCH'], method)) {\n            _.set(options, 'headers.content-type', 'application/json');\n\n            if (options.body) options.body = JSON.stringify(options.body);\n        }\n\n        return fetch(url, options).then(function ($await_1) {\n            response = $await_1;\n            return response.json().then(function ($await_2) {\n                json = $await_2;\n                return $return({\n                    request: options,\n                    status: response.status,\n                    statusText: response.statusText,\n                    headers: response.headers,\n                    body: json\n                });\n            }.$asyncbind(this, $error), $error);\n        }.$asyncbind(this, $error), $error);\n    }.$asyncbind(this));\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwaS5qcyJdLCJuYW1lcyI6WyJ2YWxpZGF0ZVJlc3BvbnNlIiwiZ2V0RW50aXR5VXJsIiwicmVxdWVzdCIsIl8iLCJIT1NUIiwiSW52YWxpZFJlc3BvbnNlIiwicmVzcG9uc2UiLCJtc2dQcmVmaXgiLCJKU09OIiwic3RyaW5naWZ5IiwiZXhwZWN0ZWRTdGF0dXMiLCJlcnJvck1zZyIsInN0YXR1cyIsImVudGl0eVR5cGUiLCJpZCIsInBhcmFtcyIsInBhcnRzIiwicHVzaCIsImpvaW4iLCJtZXRob2QiLCJ1cmwiLCJvcHRpb25zIiwidG9rZW4iLCJtZXJnZSIsImhlYWRlcnMiLCJzZXQiLCJpbmNsdWRlcyIsImJvZHkiLCJmZXRjaCIsImpzb24iLCJzdGF0dXNUZXh0Il0sIm1hcHBpbmdzIjoiOzs7Ozs7OztRQTRCc0JBLGdCLEdBQUFBLGdCO1FBYU5DLFksR0FBQUEsWTtRQWdCTUMsTyxHQUFBQSxPOztBQXpEdEI7O0FBRUE7Ozs7QUFDQTs7OztBQUNBOztJQUFZQyxDOztBQUNaOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQU1PLElBQU1DLHNCQUFPLHVCQUFiOztBQUVQOzs7O0lBR2FDLGUsV0FBQUEsZTs7O0FBR1QsNkJBQVlDLFFBQVosRUFBb0Q7QUFBQSxZQUFoQkMsU0FBZ0IsdUVBQUosRUFBSTs7QUFBQTs7QUFBQSxzSUFDMUNBLFlBQVlDLEtBQUtDLFNBQUwsQ0FBZUgsUUFBZixDQUQ4Qjs7QUFFaEQsY0FBS0EsUUFBTCxHQUFnQkEsUUFBaEI7QUFGZ0Q7QUFHbkQ7Ozs7O0FBR0w7Ozs7O0FBR08sU0FBZU4sZ0JBQWYsQ0FDSFUsY0FERyxFQUVISixRQUZHO0FBQUE7QUFBQSxZQUdISyxRQUhHLDJEQUdnQixFQUhoQjs7QUFLSCxZQUFJTCxTQUFTTSxNQUFULEtBQW9CRixjQUF4QixFQUNJLGNBQU0sSUFBSUwsZUFBSixDQUFvQkMsUUFBcEIsRUFBOEJLLFFBQTlCLENBQU47QUFDSix1QkFBT0wsUUFBUDtBQVBHO0FBQUE7O0FBVVA7OztBQUdPLFNBQVNMLFlBQVQsQ0FDSFksVUFERyxFQUlHO0FBQUEsUUFGTkMsRUFFTSx1RUFGUSxJQUVSO0FBQUEsUUFETkMsTUFDTSx1RUFEaUIsSUFDakI7O0FBQ04sUUFBTUMsUUFBUSxDQUFDWixJQUFELEVBQU9TLGFBQWEsR0FBcEIsQ0FBZDtBQUNBLFFBQUlDLEVBQUosRUFDSUUsTUFBTUMsSUFBTixDQUFXSCxFQUFYO0FBQ0osUUFBSUMsTUFBSixFQUNJQyxNQUFNQyxJQUFOLE9BQWUsc0JBQVlSLFNBQVosQ0FBc0JNLE1BQXRCLENBQWY7QUFDSixXQUFPWixFQUFFZSxJQUFGLENBQU9GLEtBQVAsRUFBYyxHQUFkLENBQVA7QUFDSDs7QUFFRDs7O0FBR08sU0FBZWQsT0FBZixDQUNIaUIsTUFERyxFQUVIQyxHQUZHO0FBQUE7QUFBQSw0QkF1QkcsUUF2QkgsRUF3QkcsSUF4Qkg7QUFHSEMsZUFIRywyREFHdUIsRUFIdkI7QUFJSEMsYUFKRywyREFJYyxJQUpkOztBQU1IbkIsVUFBRW9CLEtBQUYsQ0FBUUYsT0FBUixFQUFpQjtBQUNiRixvQkFBUUEsTUFESztBQUViSyxxQkFBUztBQUNMLDBCQUFVO0FBREw7QUFGSSxTQUFqQjs7QUFPQSxZQUFJRixLQUFKLEVBQ0luQixFQUFFc0IsR0FBRixDQUFNSixPQUFOLEVBQWUsdUJBQWYsV0FBK0NDLEtBQS9DOztBQUVKLFlBQUluQixFQUFFdUIsUUFBRixDQUFXLENBQUMsTUFBRCxFQUFTLEtBQVQsRUFBZ0IsT0FBaEIsQ0FBWCxFQUFxQ1AsTUFBckMsQ0FBSixFQUFrRDtBQUM5Q2hCLGNBQUVzQixHQUFGLENBQU1KLE9BQU4sRUFBZSxzQkFBZixFQUF1QyxrQkFBdkM7O0FBRUEsZ0JBQUlBLFFBQVFNLElBQVosRUFDSU4sUUFBUU0sSUFBUixHQUFlbkIsS0FBS0MsU0FBTCxDQUFlWSxRQUFRTSxJQUF2QixDQUFmO0FBQ1A7O0FBRWdCLGVBQU1DLE1BQU1SLEdBQU4sRUFBV0MsT0FBWCxDQUFOO0FBQVhmLG9CQUFOLEdBQWlCLFFBQWpCO0FBQ2EsbUJBQU1BLFNBQVN1QixJQUFULEVBQU47QUFBUEEsb0JBQU4sR0FBYSxRQUFiO0FBQ0EsK0JBQU87QUFDSDNCLDZCQUFTbUIsT0FETjtBQUVIVCw0QkFBUU4sU0FBU00sTUFGZDtBQUdIa0IsZ0NBQVl4QixTQUFTd0IsVUFIbEI7QUFJSE4sNkJBQVNsQixTQUFTa0IsT0FKZjtBQUtIRywwQkFBTUU7QUFMSCxpQkFBUDtBQURhO0FBREk7QUF2QmQ7QUFBQSIsImZpbGUiOiJhcGkuanMiLCJzb3VyY2VSb290IjoiL1VzZXJzL2R0ci9nb29lZS9lY21hc2NyaXB0LXNkay9zcmMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgJ2lzb21vcnBoaWMtZmV0Y2gnXG5cbmltcG9ydCBQcm9taXNlIGZyb20gJ2JsdWViaXJkJ1xuaW1wb3J0IEV4dGVuZGFibGVFcnJvciBmcm9tICdlczYtZXJyb3InXG5pbXBvcnQgKiBhcyBfIGZyb20gJ2xvZGFzaCdcbmltcG9ydCBxdWVyeVN0cmluZyBmcm9tICdxdWVyeS1zdHJpbmcnXG5cbmltcG9ydCB0eXBlIHtcbiAgICBFbnRpdHlUeXBlLCBIdHRwTWV0aG9kLCBKc29uUmVzcG9uc2UsIFF1ZXJ5UGFyYW1zLCBSZXF1ZXN0T3B0aW9ucyxcbiB9IGZyb20gJy4vdHlwZXMnXG5cbmV4cG9ydCBjb25zdCBIT1NUID0gJ2h0dHA6Ly9sb2NhbGhvc3Q6ODAwMCdcblxuLyoqXG4gKiBFeGNlcHRpb24gZm9yIGludmFsaWQgSFRUUCByZXNwb25zZXMuXG4gKi9cbmV4cG9ydCBjbGFzcyBJbnZhbGlkUmVzcG9uc2UgZXh0ZW5kcyBFeHRlbmRhYmxlRXJyb3Ige1xuICAgIHJlc3BvbnNlOiBKc29uUmVzcG9uc2VcblxuICAgIGNvbnN0cnVjdG9yKHJlc3BvbnNlOiBKc29uUmVzcG9uc2UsIG1zZ1ByZWZpeCA9ICcnKSB7XG4gICAgICAgIHN1cGVyKG1zZ1ByZWZpeCArIEpTT04uc3RyaW5naWZ5KHJlc3BvbnNlKSlcbiAgICAgICAgdGhpcy5yZXNwb25zZSA9IHJlc3BvbnNlXG4gICAgfVxufVxuXG4vKipcbiAqIEFzc2VydCB0aGF0IHRoZSBnaXZlbiByZXNwb25zZSBoYXMgdGhlIGdpdmVuIHN0YXR1cyBjb2RlLlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdmFsaWRhdGVSZXNwb25zZShcbiAgICBleHBlY3RlZFN0YXR1czogbnVtYmVyLFxuICAgIHJlc3BvbnNlOiBKc29uUmVzcG9uc2UsXG4gICAgZXJyb3JNc2c6IHN0cmluZyA9ICcnLFxuKTogSnNvblJlc3BvbnNlIHtcbiAgICBpZiAocmVzcG9uc2Uuc3RhdHVzICE9PSBleHBlY3RlZFN0YXR1cylcbiAgICAgICAgdGhyb3cgbmV3IEludmFsaWRSZXNwb25zZShyZXNwb25zZSwgZXJyb3JNc2cpXG4gICAgcmV0dXJuIHJlc3BvbnNlXG59XG5cbi8qKlxuICogQ29uc3RydWN0IGFuIGVudGl0eSBVUkwuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRFbnRpdHlVcmwoXG4gICAgZW50aXR5VHlwZTogRW50aXR5VHlwZSxcbiAgICBpZDogP3N0cmluZyA9IG51bGwsXG4gICAgcGFyYW1zOiA/UXVlcnlQYXJhbXMgPSBudWxsXG4pOiBzdHJpbmcge1xuICAgIGNvbnN0IHBhcnRzID0gW0hPU1QsIGVudGl0eVR5cGUgKyAncyddXG4gICAgaWYgKGlkKVxuICAgICAgICBwYXJ0cy5wdXNoKGlkKVxuICAgIGlmIChwYXJhbXMpXG4gICAgICAgIHBhcnRzLnB1c2goYD8ke3F1ZXJ5U3RyaW5nLnN0cmluZ2lmeShwYXJhbXMpfWApXG4gICAgcmV0dXJuIF8uam9pbihwYXJ0cywgJy8nKVxufVxuXG4vKipcbiAqIE1ha2UgYW4gSFRUUCByZXF1ZXN0IHRvIHRoZSBHb29lZSBBUEkuXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZXF1ZXN0KFxuICAgIG1ldGhvZDogSHR0cE1ldGhvZCxcbiAgICB1cmw6IHN0cmluZyxcbiAgICBvcHRpb25zOiBSZXF1ZXN0T3B0aW9ucyA9IHt9LFxuICAgIHRva2VuOiA/c3RyaW5nID0gbnVsbFxuKTogUHJvbWlzZTxSZXNwb25zZT4ge1xuICAgIF8ubWVyZ2Uob3B0aW9ucywge1xuICAgICAgICBtZXRob2Q6IG1ldGhvZCxcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgJ2FjY2VwdCc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgfSxcbiAgICB9KVxuXG4gICAgaWYgKHRva2VuKVxuICAgICAgICBfLnNldChvcHRpb25zLCAnaGVhZGVycy5hdXRob3JpemF0aW9uJywgYEpXVCAke3Rva2VufWApXG5cbiAgICBpZiAoXy5pbmNsdWRlcyhbJ1BPU1QnLCAnUFVUJywgJ1BBVENIJ10sIG1ldGhvZCkpIHtcbiAgICAgICAgXy5zZXQob3B0aW9ucywgJ2hlYWRlcnMuY29udGVudC10eXBlJywgJ2FwcGxpY2F0aW9uL2pzb24nKVxuXG4gICAgICAgIGlmIChvcHRpb25zLmJvZHkpXG4gICAgICAgICAgICBvcHRpb25zLmJvZHkgPSBKU09OLnN0cmluZ2lmeShvcHRpb25zLmJvZHkpXG4gICAgfVxuXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwsIG9wdGlvbnMpXG4gICAgY29uc3QganNvbiA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKVxuICAgIHJldHVybiB7XG4gICAgICAgIHJlcXVlc3Q6IG9wdGlvbnMsXG4gICAgICAgIHN0YXR1czogcmVzcG9uc2Uuc3RhdHVzLFxuICAgICAgICBzdGF0dXNUZXh0OiByZXNwb25zZS5zdGF0dXNUZXh0LFxuICAgICAgICBoZWFkZXJzOiByZXNwb25zZS5oZWFkZXJzLFxuICAgICAgICBib2R5OiBqc29uLFxuICAgIH1cbn1cbiJdfQ==",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "api.js"
      ],
      "names": [
        "validateResponse",
        "getEntityUrl",
        "request",
        "_",
        "HOST",
        "InvalidResponse",
        "response",
        "msgPrefix",
        "JSON",
        "stringify",
        "expectedStatus",
        "errorMsg",
        "status",
        "entityType",
        "id",
        "params",
        "parts",
        "push",
        "join",
        "method",
        "url",
        "options",
        "token",
        "merge",
        "headers",
        "set",
        "includes",
        "body",
        "fetch",
        "json",
        "statusText"
      ],
      "mappings": ";;;;;;;;QA4BsBA,gB,GAAAA,gB;QAaNC,Y,GAAAA,Y;QAgBMC,O,GAAAA,O;;AAzDtB;;AAEA;;;;AACA;;;;AACA;;IAAYC,C;;AACZ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAMO,IAAMC,sBAAO,uBAAb;;AAEP;;;;IAGaC,e,WAAAA,e;;;AAGT,6BAAYC,QAAZ,EAAoD;AAAA,YAAhBC,SAAgB,uEAAJ,EAAI;;AAAA;;AAAA,sIAC1CA,YAAYC,KAAKC,SAAL,CAAeH,QAAf,CAD8B;;AAEhD,cAAKA,QAAL,GAAgBA,QAAhB;AAFgD;AAGnD;;;;;AAGL;;;;;AAGO,SAAeN,gBAAf,CACHU,cADG,EAEHJ,QAFG;AAAA;AAAA,YAGHK,QAHG,2DAGgB,EAHhB;;AAKH,YAAIL,SAASM,MAAT,KAAoBF,cAAxB,EACI,cAAM,IAAIL,eAAJ,CAAoBC,QAApB,EAA8BK,QAA9B,CAAN;AACJ,uBAAOL,QAAP;AAPG;AAAA;;AAUP;;;AAGO,SAASL,YAAT,CACHY,UADG,EAIG;AAAA,QAFNC,EAEM,uEAFQ,IAER;AAAA,QADNC,MACM,uEADiB,IACjB;;AACN,QAAMC,QAAQ,CAACZ,IAAD,EAAOS,aAAa,GAApB,CAAd;AACA,QAAIC,EAAJ,EACIE,MAAMC,IAAN,CAAWH,EAAX;AACJ,QAAIC,MAAJ,EACIC,MAAMC,IAAN,OAAe,sBAAYR,SAAZ,CAAsBM,MAAtB,CAAf;AACJ,WAAOZ,EAAEe,IAAF,CAAOF,KAAP,EAAc,GAAd,CAAP;AACH;;AAED;;;AAGO,SAAed,OAAf,CACHiB,MADG,EAEHC,GAFG;AAAA;AAAA,4BAuBG,QAvBH,EAwBG,IAxBH;AAGHC,eAHG,2DAGuB,EAHvB;AAIHC,aAJG,2DAIc,IAJd;;AAMHnB,UAAEoB,KAAF,CAAQF,OAAR,EAAiB;AACbF,oBAAQA,MADK;AAEbK,qBAAS;AACL,0BAAU;AADL;AAFI,SAAjB;;AAOA,YAAIF,KAAJ,EACInB,EAAEsB,GAAF,CAAMJ,OAAN,EAAe,uBAAf,WAA+CC,KAA/C;;AAEJ,YAAInB,EAAEuB,QAAF,CAAW,CAAC,MAAD,EAAS,KAAT,EAAgB,OAAhB,CAAX,EAAqCP,MAArC,CAAJ,EAAkD;AAC9ChB,cAAEsB,GAAF,CAAMJ,OAAN,EAAe,sBAAf,EAAuC,kBAAvC;;AAEA,gBAAIA,QAAQM,IAAZ,EACIN,QAAQM,IAAR,GAAenB,KAAKC,SAAL,CAAeY,QAAQM,IAAvB,CAAf;AACP;;AAEgB,eAAMC,MAAMR,GAAN,EAAWC,OAAX,CAAN;AAAXf,oBAAN,GAAiB,QAAjB;AACa,mBAAMA,SAASuB,IAAT,EAAN;AAAPA,oBAAN,GAAa,QAAb;AACA,+BAAO;AACH3B,6BAASmB,OADN;AAEHT,4BAAQN,SAASM,MAFd;AAGHkB,gCAAYxB,SAASwB,UAHlB;AAIHN,6BAASlB,SAASkB,OAJf;AAKHG,0BAAME;AALH,iBAAP;AADa;AADI;AAvBd;AAAA",
      "file": "api.js",
      "sourceRoot": "/Users/dtr/gooee/ecmascript-sdk/src",
      "sourcesContent": [
        "import 'isomorphic-fetch'\n\nimport Promise from 'bluebird'\nimport ExtendableError from 'es6-error'\nimport * as _ from 'lodash'\nimport queryString from 'query-string'\n\nimport type {\n    EntityType, HttpMethod, JsonResponse, QueryParams, RequestOptions,\n } from './types'\n\nexport const HOST = 'http://localhost:8000'\n\n/**\n * Exception for invalid HTTP responses.\n */\nexport class InvalidResponse extends ExtendableError {\n    response: JsonResponse\n\n    constructor(response: JsonResponse, msgPrefix = '') {\n        super(msgPrefix + JSON.stringify(response))\n        this.response = response\n    }\n}\n\n/**\n * Assert that the given response has the given status code.\n */\nexport async function validateResponse(\n    expectedStatus: number,\n    response: JsonResponse,\n    errorMsg: string = '',\n): JsonResponse {\n    if (response.status !== expectedStatus)\n        throw new InvalidResponse(response, errorMsg)\n    return response\n}\n\n/**\n * Construct an entity URL.\n */\nexport function getEntityUrl(\n    entityType: EntityType,\n    id: ?string = null,\n    params: ?QueryParams = null\n): string {\n    const parts = [HOST, entityType + 's']\n    if (id)\n        parts.push(id)\n    if (params)\n        parts.push(`?${queryString.stringify(params)}`)\n    return _.join(parts, '/')\n}\n\n/**\n * Make an HTTP request to the Gooee API.\n */\nexport async function request(\n    method: HttpMethod,\n    url: string,\n    options: RequestOptions = {},\n    token: ?string = null\n): Promise<Response> {\n    _.merge(options, {\n        method: method,\n        headers: {\n            'accept': 'application/json',\n        },\n    })\n\n    if (token)\n        _.set(options, 'headers.authorization', `JWT ${token}`)\n\n    if (_.includes(['POST', 'PUT', 'PATCH'], method)) {\n        _.set(options, 'headers.content-type', 'application/json')\n\n        if (options.body)\n            options.body = JSON.stringify(options.body)\n    }\n\n    const response = await fetch(url, options)\n    const json = await response.json()\n    return {\n        request: options,\n        status: response.status,\n        statusText: response.statusText,\n        headers: response.headers,\n        body: json,\n    }\n}\n"
      ]
    },
    "mtime": 1476990218000
  },
  "{\"filename\":\"/Users/dtr/gooee/ecmascript-sdk/src/entities.js\",\"env\":{},\"retainLines\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"presets\":[],\"plugins\":[[[],null],[[],null],[[],null],[[],{\"loose\":false,\"spec\":false}],[[],null],[[],null],[[],{\"spec\":false}],[[],null],[[],{\"loose\":false}],[[],null],[[],null],[[],null],[[],{\"loose\":false}],[[],{\"loose\":false}],[[],null],[[],null],[[],null],[[],{\"loose\":false}],[[],null],[[],{\"loose\":false}],[[],null],[[],null],[[],{\"loose\":false}],[[],{\"async\":false,\"asyncGenerators\":false}]],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"minified\":false,\"sourceRoot\":\"/Users/dtr/gooee/ecmascript-sdk/src\",\"babelrc\":true,\"sourceType\":\"module\",\"moduleIds\":false,\"passPerPreset\":false,\"parserOpts\":false,\"generatorOpts\":false}:6.17.0": {
    "metadata": {
      "usedHelpers": [],
      "marked": [],
      "modules": {
        "imports": [
          {
            "source": "./auth",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "User"
              }
            ]
          },
          {
            "source": "./entities/building",
            "imported": [
              "BuildingModel"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "BuildingModel",
                "local": "BuildingModel"
              }
            ]
          },
          {
            "source": "./entities/customer",
            "imported": [
              "CustomerModel"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "CustomerModel",
                "local": "CustomerModel"
              }
            ]
          },
          {
            "source": "./entities/device",
            "imported": [
              "DeviceModel"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "DeviceModel",
                "local": "DeviceModel"
              }
            ]
          },
          {
            "source": "./entities/manufacturer",
            "imported": [
              "ManufacturerModel"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "ManufacturerModel",
                "local": "ManufacturerModel"
              }
            ]
          },
          {
            "source": "./entities/space",
            "imported": [
              "SpaceModel"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "SpaceModel",
                "local": "SpaceModel"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "Buildings",
            "user",
            "Customers",
            "user",
            "Devices",
            "user",
            "Manufacturers",
            "user",
            "Spaces",
            "user"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "Buildings",
              "exported": "Buildings"
            },
            {
              "kind": "local",
              "local": "user",
              "exported": "user"
            },
            {
              "kind": "local",
              "local": "Customers",
              "exported": "Customers"
            },
            {
              "kind": "local",
              "local": "user",
              "exported": "user"
            },
            {
              "kind": "local",
              "local": "Devices",
              "exported": "Devices"
            },
            {
              "kind": "local",
              "local": "user",
              "exported": "user"
            },
            {
              "kind": "local",
              "local": "Manufacturers",
              "exported": "Manufacturers"
            },
            {
              "kind": "local",
              "local": "user",
              "exported": "user"
            },
            {
              "kind": "local",
              "local": "Spaces",
              "exported": "Spaces"
            },
            {
              "kind": "local",
              "local": "user",
              "exported": "user"
            }
          ]
        }
      }
    },
    "options": {
      "filename": "/Users/dtr/gooee/ecmascript-sdk/src/entities.js",
      "filenameRelative": "/Users/dtr/gooee/ecmascript-sdk/src/entities.js",
      "env": {},
      "retainLines": false,
      "highlightCode": true,
      "suppressDeprecationMessages": false,
      "presets": [],
      "plugins": [
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false,
            "spec": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "spec": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          {
            "async": false,
            "asyncGenerators": false
          }
        ]
      ],
      "ignore": [],
      "code": true,
      "metadata": true,
      "ast": false,
      "comments": true,
      "compact": "auto",
      "minified": false,
      "sourceMaps": "both",
      "sourceMapTarget": "entities.js",
      "sourceFileName": "entities.js",
      "sourceRoot": "/Users/dtr/gooee/ecmascript-sdk/src",
      "babelrc": false,
      "sourceType": "module",
      "moduleRoot": "/Users/dtr/gooee/ecmascript-sdk/src",
      "moduleIds": false,
      "passPerPreset": false,
      "parserOpts": false,
      "generatorOpts": false,
      "basename": "entities"
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.Buildings = Buildings;\nexports.Customers = Customers;\nexports.Devices = Devices;\nexports.Manufacturers = Manufacturers;\nexports.Spaces = Spaces;\n\nvar _building = require('./entities/building');\n\nvar _customer = require('./entities/customer');\n\nvar _device = require('./entities/device');\n\nvar _manufacturer = require('./entities/manufacturer');\n\nvar _space = require('./entities/space');\n\nfunction Buildings(user) {\n    return new _building.BuildingModel(user);\n}\n\nfunction Customers(user) {\n    return new _customer.CustomerModel(user);\n}\n\nfunction Devices(user) {\n    return new _device.DeviceModel(user);\n}\n\nfunction Manufacturers(user) {\n    return new _manufacturer.ManufacturerModel(user);\n}\n\nfunction Spaces(user) {\n    return new _space.SpaceModel(user);\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImVudGl0aWVzLmpzIl0sIm5hbWVzIjpbIkJ1aWxkaW5ncyIsIkN1c3RvbWVycyIsIkRldmljZXMiLCJNYW51ZmFjdHVyZXJzIiwiU3BhY2VzIiwidXNlciJdLCJtYXBwaW5ncyI6Ijs7Ozs7UUFRZ0JBLFMsR0FBQUEsUztRQUlBQyxTLEdBQUFBLFM7UUFJQUMsTyxHQUFBQSxPO1FBSUFDLGEsR0FBQUEsYTtRQUlBQyxNLEdBQUFBLE07O0FBdEJoQjs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFFTyxTQUFTSixTQUFULENBQW1CSyxJQUFuQixFQUErQjtBQUNsQyxXQUFPLDRCQUFrQkEsSUFBbEIsQ0FBUDtBQUNIOztBQUVNLFNBQVNKLFNBQVQsQ0FBbUJJLElBQW5CLEVBQStCO0FBQ2xDLFdBQU8sNEJBQWtCQSxJQUFsQixDQUFQO0FBQ0g7O0FBRU0sU0FBU0gsT0FBVCxDQUFpQkcsSUFBakIsRUFBNkI7QUFDaEMsV0FBTyx3QkFBZ0JBLElBQWhCLENBQVA7QUFDSDs7QUFFTSxTQUFTRixhQUFULENBQXVCRSxJQUF2QixFQUFtQztBQUN0QyxXQUFPLG9DQUFzQkEsSUFBdEIsQ0FBUDtBQUNIOztBQUVNLFNBQVNELE1BQVQsQ0FBZ0JDLElBQWhCLEVBQTRCO0FBQy9CLFdBQU8sc0JBQWVBLElBQWYsQ0FBUDtBQUNIIiwiZmlsZSI6ImVudGl0aWVzLmpzIiwic291cmNlUm9vdCI6Ii9Vc2Vycy9kdHIvZ29vZWUvZWNtYXNjcmlwdC1zZGsvc3JjIiwic291cmNlc0NvbnRlbnQiOlsiLyogQGZsb3cgKi9cbmltcG9ydCB0eXBlIFVzZXIgZnJvbSAnLi9hdXRoJ1xuaW1wb3J0IHsgQnVpbGRpbmdNb2RlbCB9IGZyb20gJy4vZW50aXRpZXMvYnVpbGRpbmcnXG5pbXBvcnQgeyBDdXN0b21lck1vZGVsIH0gZnJvbSAnLi9lbnRpdGllcy9jdXN0b21lcidcbmltcG9ydCB7IERldmljZU1vZGVsIH0gZnJvbSAnLi9lbnRpdGllcy9kZXZpY2UnXG5pbXBvcnQgeyBNYW51ZmFjdHVyZXJNb2RlbCB9IGZyb20gJy4vZW50aXRpZXMvbWFudWZhY3R1cmVyJ1xuaW1wb3J0IHsgU3BhY2VNb2RlbCB9IGZyb20gJy4vZW50aXRpZXMvc3BhY2UnXG5cbmV4cG9ydCBmdW5jdGlvbiBCdWlsZGluZ3ModXNlcjogVXNlcikge1xuICAgIHJldHVybiBuZXcgQnVpbGRpbmdNb2RlbCh1c2VyKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gQ3VzdG9tZXJzKHVzZXI6IFVzZXIpIHtcbiAgICByZXR1cm4gbmV3IEN1c3RvbWVyTW9kZWwodXNlcilcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIERldmljZXModXNlcjogVXNlcikge1xuICAgIHJldHVybiBuZXcgRGV2aWNlTW9kZWwodXNlcilcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIE1hbnVmYWN0dXJlcnModXNlcjogVXNlcikge1xuICAgIHJldHVybiBuZXcgTWFudWZhY3R1cmVyTW9kZWwodXNlcilcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIFNwYWNlcyh1c2VyOiBVc2VyKSB7XG4gICAgcmV0dXJuIG5ldyBTcGFjZU1vZGVsKHVzZXIpXG59XG4iXX0=",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "entities.js"
      ],
      "names": [
        "Buildings",
        "Customers",
        "Devices",
        "Manufacturers",
        "Spaces",
        "user"
      ],
      "mappings": ";;;;;QAQgBA,S,GAAAA,S;QAIAC,S,GAAAA,S;QAIAC,O,GAAAA,O;QAIAC,a,GAAAA,a;QAIAC,M,GAAAA,M;;AAtBhB;;AACA;;AACA;;AACA;;AACA;;AAEO,SAASJ,SAAT,CAAmBK,IAAnB,EAA+B;AAClC,WAAO,4BAAkBA,IAAlB,CAAP;AACH;;AAEM,SAASJ,SAAT,CAAmBI,IAAnB,EAA+B;AAClC,WAAO,4BAAkBA,IAAlB,CAAP;AACH;;AAEM,SAASH,OAAT,CAAiBG,IAAjB,EAA6B;AAChC,WAAO,wBAAgBA,IAAhB,CAAP;AACH;;AAEM,SAASF,aAAT,CAAuBE,IAAvB,EAAmC;AACtC,WAAO,oCAAsBA,IAAtB,CAAP;AACH;;AAEM,SAASD,MAAT,CAAgBC,IAAhB,EAA4B;AAC/B,WAAO,sBAAeA,IAAf,CAAP;AACH",
      "file": "entities.js",
      "sourceRoot": "/Users/dtr/gooee/ecmascript-sdk/src",
      "sourcesContent": [
        "/* @flow */\nimport type User from './auth'\nimport { BuildingModel } from './entities/building'\nimport { CustomerModel } from './entities/customer'\nimport { DeviceModel } from './entities/device'\nimport { ManufacturerModel } from './entities/manufacturer'\nimport { SpaceModel } from './entities/space'\n\nexport function Buildings(user: User) {\n    return new BuildingModel(user)\n}\n\nexport function Customers(user: User) {\n    return new CustomerModel(user)\n}\n\nexport function Devices(user: User) {\n    return new DeviceModel(user)\n}\n\nexport function Manufacturers(user: User) {\n    return new ManufacturerModel(user)\n}\n\nexport function Spaces(user: User) {\n    return new SpaceModel(user)\n}\n"
      ]
    },
    "mtime": 1476975833000
  },
  "{\"filename\":\"/Users/dtr/gooee/ecmascript-sdk/src/entities/building.js\",\"env\":{},\"retainLines\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"presets\":[],\"plugins\":[[[],null],[[],null],[[],null],[[],{\"loose\":false,\"spec\":false}],[[],null],[[],null],[[],{\"spec\":false}],[[],null],[[],{\"loose\":false}],[[],null],[[],null],[[],null],[[],{\"loose\":false}],[[],{\"loose\":false}],[[],null],[[],null],[[],null],[[],{\"loose\":false}],[[],null],[[],{\"loose\":false}],[[],null],[[],null],[[],{\"loose\":false}],[[],{\"async\":false,\"asyncGenerators\":false}]],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"minified\":false,\"sourceRoot\":\"/Users/dtr/gooee/ecmascript-sdk/src/entities\",\"babelrc\":true,\"sourceType\":\"module\",\"moduleIds\":false,\"passPerPreset\":false,\"parserOpts\":false,\"generatorOpts\":false}:6.17.0": {
    "metadata": {
      "usedHelpers": [
        "inherits",
        "possibleConstructorReturn",
        "classCallCheck",
        "interopRequireDefault"
      ],
      "marked": [],
      "modules": {
        "imports": [
          {
            "source": "../types",
            "imported": [
              "EntityJson"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "EntityJson",
                "local": "EntityJson"
              }
            ]
          },
          {
            "source": "./base",
            "imported": [
              "Entity",
              "EntityModel"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "Entity",
                "local": "Entity"
              },
              {
                "kind": "named",
                "imported": "EntityModel",
                "local": "EntityModel"
              }
            ]
          },
          {
            "source": "../entities",
            "imported": [
              "Customers",
              "Spaces"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "Customers",
                "local": "Customers"
              },
              {
                "kind": "named",
                "imported": "Spaces",
                "local": "Spaces"
              }
            ]
          },
          {
            "source": "../auth",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "User"
              }
            ]
          },
          {
            "source": "../schema",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "Joi"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "BuildingModel",
            "Building"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "BuildingModel",
              "exported": "BuildingModel"
            },
            {
              "kind": "local",
              "local": "Building",
              "exported": "Building"
            }
          ]
        }
      }
    },
    "options": {
      "filename": "/Users/dtr/gooee/ecmascript-sdk/src/entities/building.js",
      "filenameRelative": "/Users/dtr/gooee/ecmascript-sdk/src/entities/building.js",
      "env": {},
      "retainLines": false,
      "highlightCode": true,
      "suppressDeprecationMessages": false,
      "presets": [],
      "plugins": [
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false,
            "spec": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "spec": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          {
            "async": false,
            "asyncGenerators": false
          }
        ]
      ],
      "ignore": [],
      "code": true,
      "metadata": true,
      "ast": false,
      "comments": true,
      "compact": "auto",
      "minified": false,
      "sourceMaps": "both",
      "sourceMapTarget": "building.js",
      "sourceFileName": "building.js",
      "sourceRoot": "/Users/dtr/gooee/ecmascript-sdk/src/entities",
      "babelrc": false,
      "sourceType": "module",
      "moduleRoot": "/Users/dtr/gooee/ecmascript-sdk/src/entities",
      "moduleIds": false,
      "passPerPreset": false,
      "parserOpts": false,
      "generatorOpts": false,
      "basename": "building"
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.Building = exports.BuildingModel = undefined;\n\nvar _base = require('./base');\n\nvar _entities = require('../entities');\n\nvar _auth = require('../auth');\n\nvar _auth2 = _interopRequireDefault(_auth);\n\nvar _schema = require('../schema');\n\nvar _schema2 = _interopRequireDefault(_schema);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar schema = _schema2.default.logicalEntity().keys({\n    customer: _schema2.default.string().uuid().required(),\n    customer_site: _schema2.default.string().uuid().allow(null),\n    spaces: _schema2.default.uuidArray(),\n    users: _schema2.default.uuidArray(),\n    location: _schema2.default.locationObject().allow(null),\n    // TODO: maybe figure out something better for this\n    timezone: _schema2.default.string(),\n    last_activity: _schema2.default.string().allow(null),\n    meta: _schema2.default.array().items(_schema2.default.baseMeta())\n});\n\nvar BuildingModel = exports.BuildingModel = function (_EntityModel) {\n    _inherits(BuildingModel, _EntityModel);\n\n    function BuildingModel(user) {\n        _classCallCheck(this, BuildingModel);\n\n        return _possibleConstructorReturn(this, (BuildingModel.__proto__ || Object.getPrototypeOf(BuildingModel)).call(this, user, 'building', schema, Building));\n    }\n\n    return BuildingModel;\n}(_base.EntityModel);\n\nvar Building = exports.Building = function (_Entity) {\n    _inherits(Building, _Entity);\n\n    function Building(model, data) {\n        _classCallCheck(this, Building);\n\n        return _possibleConstructorReturn(this, (Building.__proto__ || Object.getPrototypeOf(Building)).call(this, model, data, {\n            'customer': {\n                model: (0, _entities.Customers)(model.user),\n                relatedName: 'buildings'\n            },\n            'spaces': {\n                model: (0, _entities.Spaces)(model.user),\n                relatedName: 'buildings'\n            }\n        }));\n    }\n\n    return Building;\n}(_base.Entity);\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJ1aWxkaW5nLmpzIl0sIm5hbWVzIjpbInNjaGVtYSIsImxvZ2ljYWxFbnRpdHkiLCJrZXlzIiwiY3VzdG9tZXIiLCJzdHJpbmciLCJ1dWlkIiwicmVxdWlyZWQiLCJjdXN0b21lcl9zaXRlIiwiYWxsb3ciLCJzcGFjZXMiLCJ1dWlkQXJyYXkiLCJ1c2VycyIsImxvY2F0aW9uIiwibG9jYXRpb25PYmplY3QiLCJ0aW1lem9uZSIsImxhc3RfYWN0aXZpdHkiLCJtZXRhIiwiYXJyYXkiLCJpdGVtcyIsImJhc2VNZXRhIiwiQnVpbGRpbmdNb2RlbCIsInVzZXIiLCJCdWlsZGluZyIsIm1vZGVsIiwiZGF0YSIsInJlbGF0ZWROYW1lIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBR0E7O0FBQ0E7O0FBQ0E7Ozs7QUFDQTs7Ozs7Ozs7Ozs7O0FBRUEsSUFBTUEsU0FBUyxpQkFBSUMsYUFBSixHQUFvQkMsSUFBcEIsQ0FBeUI7QUFDcENDLGNBQVUsaUJBQUlDLE1BQUosR0FBYUMsSUFBYixHQUFvQkMsUUFBcEIsRUFEMEI7QUFFcENDLG1CQUFlLGlCQUFJSCxNQUFKLEdBQWFDLElBQWIsR0FBb0JHLEtBQXBCLENBQTBCLElBQTFCLENBRnFCO0FBR3BDQyxZQUFRLGlCQUFJQyxTQUFKLEVBSDRCO0FBSXBDQyxXQUFPLGlCQUFJRCxTQUFKLEVBSjZCO0FBS3BDRSxjQUFVLGlCQUFJQyxjQUFKLEdBQXFCTCxLQUFyQixDQUEyQixJQUEzQixDQUwwQjtBQU1wQztBQUNBTSxjQUFVLGlCQUFJVixNQUFKLEVBUDBCO0FBUXBDVyxtQkFBZSxpQkFBSVgsTUFBSixHQUFhSSxLQUFiLENBQW1CLElBQW5CLENBUnFCO0FBU3BDUSxVQUFNLGlCQUFJQyxLQUFKLEdBQVlDLEtBQVosQ0FBa0IsaUJBQUlDLFFBQUosRUFBbEI7QUFUOEIsQ0FBekIsQ0FBZjs7SUFZYUMsYSxXQUFBQSxhOzs7QUFFVCwyQkFBWUMsSUFBWixFQUF3QjtBQUFBOztBQUFBLDZIQUNkQSxJQURjLEVBQ1IsVUFEUSxFQUNJckIsTUFESixFQUNZc0IsUUFEWjtBQUV2Qjs7Ozs7SUFHUUEsUSxXQUFBQSxROzs7QUFFVCxzQkFBWUMsS0FBWixFQUFrQ0MsSUFBbEMsRUFBb0Q7QUFBQTs7QUFBQSxtSEFDMUNELEtBRDBDLEVBQ25DQyxJQURtQyxFQUM3QjtBQUNmLHdCQUFZO0FBQ1JELHVCQUFPLHlCQUFVQSxNQUFNRixJQUFoQixDQURDO0FBRVJJLDZCQUFhO0FBRkwsYUFERztBQUtmLHNCQUFVO0FBQ05GLHVCQUFPLHNCQUFPQSxNQUFNRixJQUFiLENBREQ7QUFFTkksNkJBQWE7QUFGUDtBQUxLLFNBRDZCO0FBV25EIiwiZmlsZSI6ImJ1aWxkaW5nLmpzIiwic291cmNlUm9vdCI6Ii9Vc2Vycy9kdHIvZ29vZWUvZWNtYXNjcmlwdC1zZGsvc3JjL2VudGl0aWVzIiwic291cmNlc0NvbnRlbnQiOlsiLyogQGZsb3cgKi9cbmltcG9ydCB0eXBlIHsgRW50aXR5SnNvbiB9IGZyb20gJy4uL3R5cGVzJ1xuXG5pbXBvcnQgeyBFbnRpdHksIEVudGl0eU1vZGVsIH0gZnJvbSAnLi9iYXNlJ1xuaW1wb3J0IHsgQ3VzdG9tZXJzLCBTcGFjZXMgfSBmcm9tICcuLi9lbnRpdGllcydcbmltcG9ydCBVc2VyIGZyb20gJy4uL2F1dGgnXG5pbXBvcnQgSm9pIGZyb20gJy4uL3NjaGVtYSdcblxuY29uc3Qgc2NoZW1hID0gSm9pLmxvZ2ljYWxFbnRpdHkoKS5rZXlzKHtcbiAgICBjdXN0b21lcjogSm9pLnN0cmluZygpLnV1aWQoKS5yZXF1aXJlZCgpLFxuICAgIGN1c3RvbWVyX3NpdGU6IEpvaS5zdHJpbmcoKS51dWlkKCkuYWxsb3cobnVsbCksXG4gICAgc3BhY2VzOiBKb2kudXVpZEFycmF5KCksXG4gICAgdXNlcnM6IEpvaS51dWlkQXJyYXkoKSxcbiAgICBsb2NhdGlvbjogSm9pLmxvY2F0aW9uT2JqZWN0KCkuYWxsb3cobnVsbCksXG4gICAgLy8gVE9ETzogbWF5YmUgZmlndXJlIG91dCBzb21ldGhpbmcgYmV0dGVyIGZvciB0aGlzXG4gICAgdGltZXpvbmU6IEpvaS5zdHJpbmcoKSxcbiAgICBsYXN0X2FjdGl2aXR5OiBKb2kuc3RyaW5nKCkuYWxsb3cobnVsbCksXG4gICAgbWV0YTogSm9pLmFycmF5KCkuaXRlbXMoSm9pLmJhc2VNZXRhKCkpLFxufSlcblxuZXhwb3J0IGNsYXNzIEJ1aWxkaW5nTW9kZWwgZXh0ZW5kcyBFbnRpdHlNb2RlbCB7XG5cbiAgICBjb25zdHJ1Y3Rvcih1c2VyOiBVc2VyKSB7XG4gICAgICAgIHN1cGVyKHVzZXIsICdidWlsZGluZycsIHNjaGVtYSwgQnVpbGRpbmcpXG4gICAgfVxufVxuXG5leHBvcnQgY2xhc3MgQnVpbGRpbmcgZXh0ZW5kcyBFbnRpdHkge1xuXG4gICAgY29uc3RydWN0b3IobW9kZWw6IEJ1aWxkaW5nTW9kZWwsIGRhdGE6IEVudGl0eUpzb24pIHtcbiAgICAgICAgc3VwZXIobW9kZWwsIGRhdGEsIHtcbiAgICAgICAgICAgICdjdXN0b21lcic6IHtcbiAgICAgICAgICAgICAgICBtb2RlbDogQ3VzdG9tZXJzKG1vZGVsLnVzZXIpLFxuICAgICAgICAgICAgICAgIHJlbGF0ZWROYW1lOiAnYnVpbGRpbmdzJyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAnc3BhY2VzJzoge1xuICAgICAgICAgICAgICAgIG1vZGVsOiBTcGFjZXMobW9kZWwudXNlciksXG4gICAgICAgICAgICAgICAgcmVsYXRlZE5hbWU6ICdidWlsZGluZ3MnLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgfSlcbiAgICB9XG59XG4iXX0=",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "building.js"
      ],
      "names": [
        "schema",
        "logicalEntity",
        "keys",
        "customer",
        "string",
        "uuid",
        "required",
        "customer_site",
        "allow",
        "spaces",
        "uuidArray",
        "users",
        "location",
        "locationObject",
        "timezone",
        "last_activity",
        "meta",
        "array",
        "items",
        "baseMeta",
        "BuildingModel",
        "user",
        "Building",
        "model",
        "data",
        "relatedName"
      ],
      "mappings": ";;;;;;;AAGA;;AACA;;AACA;;;;AACA;;;;;;;;;;;;AAEA,IAAMA,SAAS,iBAAIC,aAAJ,GAAoBC,IAApB,CAAyB;AACpCC,cAAU,iBAAIC,MAAJ,GAAaC,IAAb,GAAoBC,QAApB,EAD0B;AAEpCC,mBAAe,iBAAIH,MAAJ,GAAaC,IAAb,GAAoBG,KAApB,CAA0B,IAA1B,CAFqB;AAGpCC,YAAQ,iBAAIC,SAAJ,EAH4B;AAIpCC,WAAO,iBAAID,SAAJ,EAJ6B;AAKpCE,cAAU,iBAAIC,cAAJ,GAAqBL,KAArB,CAA2B,IAA3B,CAL0B;AAMpC;AACAM,cAAU,iBAAIV,MAAJ,EAP0B;AAQpCW,mBAAe,iBAAIX,MAAJ,GAAaI,KAAb,CAAmB,IAAnB,CARqB;AASpCQ,UAAM,iBAAIC,KAAJ,GAAYC,KAAZ,CAAkB,iBAAIC,QAAJ,EAAlB;AAT8B,CAAzB,CAAf;;IAYaC,a,WAAAA,a;;;AAET,2BAAYC,IAAZ,EAAwB;AAAA;;AAAA,6HACdA,IADc,EACR,UADQ,EACIrB,MADJ,EACYsB,QADZ;AAEvB;;;;;IAGQA,Q,WAAAA,Q;;;AAET,sBAAYC,KAAZ,EAAkCC,IAAlC,EAAoD;AAAA;;AAAA,mHAC1CD,KAD0C,EACnCC,IADmC,EAC7B;AACf,wBAAY;AACRD,uBAAO,yBAAUA,MAAMF,IAAhB,CADC;AAERI,6BAAa;AAFL,aADG;AAKf,sBAAU;AACNF,uBAAO,sBAAOA,MAAMF,IAAb,CADD;AAENI,6BAAa;AAFP;AALK,SAD6B;AAWnD",
      "file": "building.js",
      "sourceRoot": "/Users/dtr/gooee/ecmascript-sdk/src/entities",
      "sourcesContent": [
        "/* @flow */\nimport type { EntityJson } from '../types'\n\nimport { Entity, EntityModel } from './base'\nimport { Customers, Spaces } from '../entities'\nimport User from '../auth'\nimport Joi from '../schema'\n\nconst schema = Joi.logicalEntity().keys({\n    customer: Joi.string().uuid().required(),\n    customer_site: Joi.string().uuid().allow(null),\n    spaces: Joi.uuidArray(),\n    users: Joi.uuidArray(),\n    location: Joi.locationObject().allow(null),\n    // TODO: maybe figure out something better for this\n    timezone: Joi.string(),\n    last_activity: Joi.string().allow(null),\n    meta: Joi.array().items(Joi.baseMeta()),\n})\n\nexport class BuildingModel extends EntityModel {\n\n    constructor(user: User) {\n        super(user, 'building', schema, Building)\n    }\n}\n\nexport class Building extends Entity {\n\n    constructor(model: BuildingModel, data: EntityJson) {\n        super(model, data, {\n            'customer': {\n                model: Customers(model.user),\n                relatedName: 'buildings',\n            },\n            'spaces': {\n                model: Spaces(model.user),\n                relatedName: 'buildings',\n            },\n        })\n    }\n}\n"
      ]
    },
    "mtime": 1476973975000
  },
  "{\"filename\":\"/Users/dtr/gooee/ecmascript-sdk/src/entities/base.js\",\"env\":{},\"retainLines\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"presets\":[],\"plugins\":[[[],null],[[],null],[[],null],[[],{\"loose\":false,\"spec\":false}],[[],null],[[],null],[[],{\"spec\":false}],[[],null],[[],{\"loose\":false}],[[],null],[[],null],[[],null],[[],{\"loose\":false}],[[],{\"loose\":false}],[[],null],[[],null],[[],null],[[],{\"loose\":false}],[[],null],[[],{\"loose\":false}],[[],null],[[],null],[[],{\"loose\":false}],[[],{\"async\":false,\"asyncGenerators\":false}]],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"minified\":false,\"sourceRoot\":\"/Users/dtr/gooee/ecmascript-sdk/src/entities\",\"babelrc\":true,\"sourceType\":\"module\",\"moduleIds\":false,\"passPerPreset\":false,\"parserOpts\":false,\"generatorOpts\":false}:6.17.0": {
    "metadata": {
      "usedHelpers": [
        "createClass",
        "classCallCheck",
        "inherits",
        "possibleConstructorReturn",
        "defineProperty",
        "interopRequireWildcard",
        "interopRequireDefault",
        "typeof"
      ],
      "marked": [],
      "modules": {
        "imports": [
          {
            "source": "lodash",
            "imported": [
              "*"
            ],
            "specifiers": [
              {
                "kind": "namespace",
                "local": "_"
              }
            ]
          },
          {
            "source": "immutable",
            "imported": [
              "*"
            ],
            "specifiers": [
              {
                "kind": "namespace",
                "local": "Immutable"
              }
            ]
          },
          {
            "source": "es6-error",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "ExtendableError"
              }
            ]
          },
          {
            "source": "bluebird",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "Promise"
              }
            ]
          },
          {
            "source": "../types",
            "imported": [
              "JsonObject",
              "EntityType",
              "EntitySchema",
              "EntityJson",
              "QueryParams"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "JsonObject",
                "local": "JsonObject"
              },
              {
                "kind": "named",
                "imported": "EntityType",
                "local": "EntityType"
              },
              {
                "kind": "named",
                "imported": "EntitySchema",
                "local": "EntitySchema"
              },
              {
                "kind": "named",
                "imported": "EntityJson",
                "local": "EntityJson"
              },
              {
                "kind": "named",
                "imported": "QueryParams",
                "local": "QueryParams"
              }
            ]
          },
          {
            "source": "../auth",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "User"
              }
            ]
          },
          {
            "source": "./core",
            "imported": [
              "validateEntity",
              "readEntity",
              "createEntity",
              "updateEntity",
              "listEntities",
              "iterEntities",
              "deleteEntity"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "validateEntity",
                "local": "validateEntity"
              },
              {
                "kind": "named",
                "imported": "readEntity",
                "local": "readEntity"
              },
              {
                "kind": "named",
                "imported": "createEntity",
                "local": "createEntity"
              },
              {
                "kind": "named",
                "imported": "updateEntity",
                "local": "updateEntity"
              },
              {
                "kind": "named",
                "imported": "listEntities",
                "local": "listEntities"
              },
              {
                "kind": "named",
                "imported": "iterEntities",
                "local": "iterEntities"
              },
              {
                "kind": "named",
                "imported": "deleteEntity",
                "local": "deleteEntity"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "EntityModel",
            "AttributeError",
            "Entity"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "EntityModel",
              "exported": "EntityModel"
            },
            {
              "kind": "local",
              "local": "AttributeError",
              "exported": "AttributeError"
            },
            {
              "kind": "local",
              "local": "Entity",
              "exported": "Entity"
            }
          ]
        }
      }
    },
    "options": {
      "filename": "/Users/dtr/gooee/ecmascript-sdk/src/entities/base.js",
      "filenameRelative": "/Users/dtr/gooee/ecmascript-sdk/src/entities/base.js",
      "env": {},
      "retainLines": false,
      "highlightCode": true,
      "suppressDeprecationMessages": false,
      "presets": [],
      "plugins": [
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false,
            "spec": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "spec": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          {
            "async": false,
            "asyncGenerators": false
          }
        ]
      ],
      "ignore": [],
      "code": true,
      "metadata": true,
      "ast": false,
      "comments": true,
      "compact": "auto",
      "minified": false,
      "sourceMaps": "both",
      "sourceMapTarget": "base.js",
      "sourceFileName": "base.js",
      "sourceRoot": "/Users/dtr/gooee/ecmascript-sdk/src/entities",
      "babelrc": false,
      "sourceType": "module",
      "moduleRoot": "/Users/dtr/gooee/ecmascript-sdk/src/entities",
      "moduleIds": false,
      "passPerPreset": false,
      "parserOpts": false,
      "generatorOpts": false,
      "basename": "base"
    },
    "ignored": false,
    "code": "'use strict';\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.Entity = exports.AttributeError = exports.EntityModel = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _lodash = require('lodash');\n\nvar _ = _interopRequireWildcard(_lodash);\n\nvar _immutable = require('immutable');\n\nvar Immutable = _interopRequireWildcard(_immutable);\n\nvar _es6Error = require('es6-error');\n\nvar _es6Error2 = _interopRequireDefault(_es6Error);\n\nvar _bluebird = require('bluebird');\n\nvar _bluebird2 = _interopRequireDefault(_bluebird);\n\nvar _core = require('./core');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nFunction.prototype.$asyncbind = function $asyncbind(self, catcher) {\n    'use strict';\n\n    if (!Function.prototype.$asyncbind) {\n        Object.defineProperty(Function.prototype, '$asyncbind', {\n            value: $asyncbind,\n            enumerable: false,\n            configurable: true,\n            writable: true\n        });\n    }\n\n    if (!$asyncbind.trampoline) {\n        $asyncbind.trampoline = function trampoline(t, x, s, e) {\n            return function b(q) {\n                while (q) {\n                    if (q.then) return q.then(b, e);\n\n                    try {\n                        if (q.pop) {\n                            if (q.length) return q.pop() ? x.call(t) : q;\n                            q = s;\n                        } else q = q.call(t);\n                    } catch (r) {\n                        return e(r);\n                    }\n                }\n            };\n        };\n    }\n\n    if (!$asyncbind.LazyThenable) {\n        $asyncbind.LazyThenable = function () {\n            function isThenable(obj) {\n                return obj && obj instanceof Object && typeof obj.then === 'function';\n            }\n\n            function resolution(p, r, how) {\n                try {\n                    var x = how ? how(r) : r;\n                    if (p === x) return p.reject(new TypeError('Promise resolution loop'));\n\n                    if (isThenable(x)) {\n                        x.then(function (y) {\n                            resolution(p, y);\n                        }, function (e) {\n                            p.reject(e);\n                        });\n                    } else {\n                        p.resolve(x);\n                    }\n                } catch (ex) {\n                    p.reject(ex);\n                }\n            }\n\n            function Chained() {}\n\n            ;\n            Chained.prototype = {\n                resolve: _unchained,\n                reject: _unchained,\n                then: thenChain\n            };\n\n            function _unchained(v) {}\n\n            function thenChain(res, rej) {\n                this.resolve = res;\n                this.reject = rej;\n            }\n\n            function then(res, rej) {\n                var chain = new Chained();\n\n                try {\n                    this._resolver(function (value) {\n                        return isThenable(value) ? value.then(res, rej) : resolution(chain, value, res);\n                    }, function (ex) {\n                        resolution(chain, ex, rej);\n                    });\n                } catch (ex) {\n                    resolution(chain, ex, rej);\n                }\n\n                return chain;\n            }\n\n            function Thenable(resolver) {\n                this._resolver = resolver;\n                this.then = then;\n            }\n\n            ;\n\n            Thenable.resolve = function (v) {\n                return Thenable.isThenable(v) ? v : {\n                    then: function then(resolve) {\n                        return resolve(v);\n                    }\n                };\n            };\n\n            Thenable.isThenable = isThenable;\n            return Thenable;\n        }();\n\n        $asyncbind.EagerThenable = $asyncbind.Thenable = ($asyncbind.EagerThenableFactory = function (tick) {\n            tick = tick || (typeof process === 'undefined' ? 'undefined' : _typeof(process)) === 'object' && process.nextTick || typeof setImmediate === 'function' && setImmediate || function (f) {\n                setTimeout(f, 0);\n            };\n\n            var soon = function () {\n                var fq = [],\n                    fqStart = 0,\n                    bufferSize = 1024;\n\n                function callQueue() {\n                    while (fq.length - fqStart) {\n                        fq[fqStart]();\n                        fq[fqStart++] = undefined;\n\n                        if (fqStart === bufferSize) {\n                            fq.splice(0, bufferSize);\n                            fqStart = 0;\n                        }\n                    }\n                }\n\n                return function (fn) {\n                    fq.push(fn);\n                    if (fq.length - fqStart === 1) tick(callQueue);\n                };\n            }();\n\n            function Zousan(func) {\n                if (func) {\n                    var me = this;\n                    func(function (arg) {\n                        me.resolve(arg);\n                    }, function (arg) {\n                        me.reject(arg);\n                    });\n                }\n            }\n\n            Zousan.prototype = {\n                resolve: function resolve(value) {\n                    if (this.state !== undefined) return;\n                    if (value === this) return this.reject(new TypeError('Attempt to resolve promise with self'));\n                    var me = this;\n\n                    if (value && (typeof value === 'function' || (typeof value === 'undefined' ? 'undefined' : _typeof(value)) === 'object')) {\n                        try {\n                            var first = 0;\n                            var then = value.then;\n\n                            if (typeof then === 'function') {\n                                then.call(value, function (ra) {\n                                    if (!first++) {\n                                        me.resolve(ra);\n                                    }\n                                }, function (rr) {\n                                    if (!first++) {\n                                        me.reject(rr);\n                                    }\n                                });\n                                return;\n                            }\n                        } catch (e) {\n                            if (!first) this.reject(e);\n                            return;\n                        }\n                    }\n\n                    this.state = STATE_FULFILLED;\n                    this.v = value;\n                    if (me.c) soon(function () {\n                        for (var n = 0, l = me.c.length; n < l; n++) {\n                            STATE_FULFILLED(me.c[n], value);\n                        }\n                    });\n                },\n                reject: function reject(reason) {\n                    if (this.state !== undefined) return;\n                    this.state = STATE_REJECTED;\n                    this.v = reason;\n                    var clients = this.c;\n                    if (clients) soon(function () {\n                        for (var n = 0, l = clients.length; n < l; n++) {\n                            STATE_REJECTED(clients[n], reason);\n                        }\n                    });\n                },\n                then: function then(onF, onR) {\n                    var p = new Zousan();\n                    var client = {\n                        y: onF,\n                        n: onR,\n                        p: p\n                    };\n\n                    if (this.state === undefined) {\n                        if (this.c) this.c.push(client);else this.c = [client];\n                    } else {\n                        var s = this.state,\n                            a = this.v;\n                        soon(function () {\n                            s(client, a);\n                        });\n                    }\n\n                    return p;\n                }\n            };\n\n            function STATE_FULFILLED(c, arg) {\n                if (typeof c.y === 'function') {\n                    try {\n                        var yret = c.y.call(undefined, arg);\n                        c.p.resolve(yret);\n                    } catch (err) {\n                        c.p.reject(err);\n                    }\n                } else c.p.resolve(arg);\n            }\n\n            function STATE_REJECTED(c, reason) {\n                if (typeof c.n === 'function') {\n                    try {\n                        var yret = c.n.call(undefined, reason);\n                        c.p.resolve(yret);\n                    } catch (err) {\n                        c.p.reject(err);\n                    }\n                } else c.p.reject(reason);\n            }\n\n            Zousan.resolve = function (val) {\n                if (val && val instanceof Zousan) return val;\n                var z = new Zousan();\n                z.resolve(val);\n                return z;\n            };\n\n            Zousan.reject = function (err) {\n                if (err && err instanceof Zousan) return err;\n                var z = new Zousan();\n                z.reject(err);\n                return z;\n            };\n\n            Zousan.version = '2.3.2-nodent';\n            return Zousan;\n        })();\n    }\n\n    var resolver = this;\n\n    switch (catcher) {\n        case true:\n            return new $asyncbind.Thenable(boundThen);\n\n        case 0:\n            return new $asyncbind.LazyThenable(boundThen);\n\n        case undefined:\n            boundThen.then = boundThen;\n            return boundThen;\n\n        default:\n            return function () {\n                try {\n                    return resolver.apply(self, arguments);\n                } catch (ex) {\n                    return catcher(ex);\n                }\n            };\n    }\n\n    function boundThen() {\n        return resolver.apply(self, arguments);\n    }\n};\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Base class representing an Entity type as a whole.\n *\n * Provides functions for creating an Entity and retrieving multiple Entity's\n * of the given type.\n */\nvar EntityModel = exports.EntityModel = function () {\n    function EntityModel(user, entityType, schema, instanceClass) {\n        _classCallCheck(this, EntityModel);\n\n        this.user = user;\n        this.type = entityType;\n        this.schema = schema;\n        this.instanceClass = instanceClass;\n    }\n\n    /**\n     * Create an Entity with the given data.\n     */\n\n\n    _createClass(EntityModel, [{\n        key: 'create',\n        value: function create(data) {\n            return new _bluebird2.default(function ($return, $error) {\n                var created;\n                return (0, _core.createEntity)(this.user, this.type, data).then(function ($await_1) {\n                    created = $await_1;\n                    created = (0, _core.validateEntity)(created, this.schema);\n                    return $return(new this.instanceClass(this, created));\n                }.$asyncbind(this, $error), $error);\n            }.$asyncbind(this));\n        }\n\n        /**\n         * Get the Entity with the given ID.\n         */\n\n    }, {\n        key: 'get',\n        value: function get(id) {\n            return new _bluebird2.default(function ($return, $error) {\n                var data;\n                return (0, _core.readEntity)(this.user, this.type, id).then(function ($await_2) {\n                    data = $await_2;\n                    data = (0, _core.validateEntity)(data, this.schema);\n                    return $return(new this.instanceClass(this, data));\n                }.$asyncbind(this, $error), $error);\n            }.$asyncbind(this));\n        }\n\n        /**\n         * Iterate over all existing Entities with this Entity type, filtered by\n         * the given params.\n         */\n\n    }, {\n        key: 'iterate',\n        value: regeneratorRuntime.mark(function iterate() {\n            var _this = this;\n\n            var params = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n            var _iteratorNormalCompletion, _didIteratorError, _iteratorError, _iterator, _step, promise;\n\n            return regeneratorRuntime.wrap(function iterate$(_context) {\n                while (1) {\n                    switch (_context.prev = _context.next) {\n                        case 0:\n                            _iteratorNormalCompletion = true;\n                            _didIteratorError = false;\n                            _iteratorError = undefined;\n                            _context.prev = 3;\n                            _iterator = (0, _core.iterEntities)(this.user, this.type, params)[Symbol.iterator]();\n\n                        case 5:\n                            if (_iteratorNormalCompletion = (_step = _iterator.next()).done) {\n                                _context.next = 12;\n                                break;\n                            }\n\n                            promise = _step.value;\n                            _context.next = 9;\n                            return promise.then(function (data) {\n                                data = (0, _core.validateEntity)(data, _this.schema);\n                                return new _this.instanceClass(_this, data);\n                            });\n\n                        case 9:\n                            _iteratorNormalCompletion = true;\n                            _context.next = 5;\n                            break;\n\n                        case 12:\n                            _context.next = 18;\n                            break;\n\n                        case 14:\n                            _context.prev = 14;\n                            _context.t0 = _context['catch'](3);\n                            _didIteratorError = true;\n                            _iteratorError = _context.t0;\n\n                        case 18:\n                            _context.prev = 18;\n                            _context.prev = 19;\n\n                            if (!_iteratorNormalCompletion && _iterator.return) {\n                                _iterator.return();\n                            }\n\n                        case 21:\n                            _context.prev = 21;\n\n                            if (!_didIteratorError) {\n                                _context.next = 24;\n                                break;\n                            }\n\n                            throw _iteratorError;\n\n                        case 24:\n                            return _context.finish(21);\n\n                        case 25:\n                            return _context.finish(18);\n\n                        case 26:\n                        case 'end':\n                            return _context.stop();\n                    }\n                }\n            }, iterate, this, [[3, 14, 18, 26], [19,, 21, 25]]);\n        })\n\n        /**\n         * List all existing Entities with this Entity type, filtered by the given\n         * params.\n         *\n         * If there are a large number of EntityModel of this type, this method\n         * can be extremely slow. In these cases, use iterate() instead.\n         */\n\n    }, {\n        key: 'list',\n        value: function list() {\n            var $args = arguments;return new _bluebird2.default(function ($return, $error) {\n                var _this2 = this;\n\n                var params = $args.length > 0 && $args[0] !== undefined ? $args[0] : {};\n\n                return $return((0, _core.listEntities)(this.user, this.type, params).map(function (data) {\n                    data = (0, _core.validateEntity)(data, _this2.schema);\n                    return new _this2.instanceClass(_this2, data);\n                }));\n            }.$asyncbind(this));\n        }\n    }]);\n\n    return EntityModel;\n}();\n\n/**\n * Exception for wrong attribute lookups on Entity data.\n */\n\n\nvar AttributeError = exports.AttributeError = function (_ExtendableError) {\n    _inherits(AttributeError, _ExtendableError);\n\n    function AttributeError(attribute, entity) {\n        _classCallCheck(this, AttributeError);\n\n        var _this3 = _possibleConstructorReturn(this, (AttributeError.__proto__ || Object.getPrototypeOf(AttributeError)).call(this, 'No attribute called \\'' + attribute + '\\' found on Entity' + (' ' + entity.toString())));\n\n        _this3.attribute = attribute;\n        _this3.entity = entity;\n        return _this3;\n    }\n\n    return AttributeError;\n}(_es6Error2.default);\n\n/**\n * Base class for an Entity in the Gooee ecosystem.\n */\nvar Entity = exports.Entity = function () {\n    function Entity(model, data) {\n        var relatedRefs = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n        _classCallCheck(this, Entity);\n\n        this.model = model;\n        this._data = Immutable.Map(data);\n        this._relatedRefs = relatedRefs;\n    }\n\n    _createClass(Entity, [{\n        key: 'toString',\n        value: function toString() {\n            return '<' + _.upperFirst(this.model.type) + ' ' + this.id + '>';\n        }\n        //\n        // _buildAttrGetters() {\n        //     _.forOwn(this._relatedRefs, (refData, key) => {\n        //         if (refData.many)\n        //             this[key] = () => this._getManyRelated(key)\n        //         else\n        //             this[key] = () => this._getRelated(key, this._data.get(key))\n        //     })\n        // }\n\n    }, {\n        key: '_getValue',\n        value: function _getValue(key) {\n            return this._data.get(key);\n        }\n    }, {\n        key: '_getRelated',\n        value: function _getRelated(key, id) {\n            var model = this._relatedRefs[key].model;\n            return model.get(id);\n        }\n    }, {\n        key: '_getManyRelated',\n        value: function _getManyRelated(key) {\n            var _relatedRefs$key = this._relatedRefs[key];\n            var model = _relatedRefs$key.model;\n            var relatedName = _relatedRefs$key.relatedName;\n\n\n            if (!relatedName) throw new Error('No many relationship on key \\'' + key + '\\'' + (' for Entity ' + this.toString()));\n\n            return model.iterate(_defineProperty({}, relatedName, this.id));\n        }\n\n        /**\n         * Get Entity data as JS object.\n         *\n         * Given no arguments, returns the whole data object. Else, returns only\n         * the fields given.\n         * TODO: Add validation for missing values.\n         */\n\n    }, {\n        key: 'values',\n        value: function values() {\n            var $args = arguments;return new _bluebird2.default(function ($return, $error) {\n                var _arguments = $args,\n                    _this4 = this;\n\n                // Filter to the given fields\n                var seq = this._data.toSeq();\n                if ($args.length) seq = seq.filter(function (val, key) {\n                    return _.includes(_arguments, key);\n                });\n\n                // Fetch data for related fields\n                return $return(_bluebird2.default.props(seq.map(function (val, key) {\n                    if (key in _this4._relatedRefs) {\n                        if (_this4._relatedRefs[key].many) return _this4._getManyRelated(key);\n                        return _this4._getRelated(key, val);\n                    }\n                    return _bluebird2.default.resolve(val);\n                }).toObject()));\n            }.$asyncbind(this));\n        }\n\n        /**\n         * Like `values()`, but returns only the values, as an array.\n         *\n         * If no args are given, returns an empty array.\n         */\n\n    }, {\n        key: 'valuesList',\n        value: function valuesList() {\n            var $args = arguments;return new _bluebird2.default(function ($return, $error) {\n                var _this5;\n\n                _this5 = this;\n                return _bluebird2.default.map($args, function (key) {\n                    if (!_this5._data.has(key)) throw new AttributeError(key, _this5);\n\n                    if (key in _this5._relatedRefs) {\n                        var _relatedName = _this5._relatedRefs[key].relatedName;\n\n                        if (_relatedName) return _this5._getManyRelated(key, _relatedName);\n\n                        return _this5._getRelated(key, _this5._data.get(key));\n                    }\n                    return _this5._data.get(key);\n                }).catch(function (err) {\n                    throw err;\n                }).then($return, $error);\n            }.$asyncbind(this));\n        }\n\n        /**\n         * Get a data attribute of this Entity.\n         */\n\n    }, {\n        key: 'get',\n        value: function get(key) {\n            return new _bluebird2.default(function ($return, $error) {\n                if (!this._data.has(key)) return $error(new AttributeError(key, this));\n\n                return this.values(key).then(function ($await_4) {\n                    return $return($await_4[0]);\n                }.$asyncbind(this, $error), $error);\n            }.$asyncbind(this));\n        }\n\n        /**\n         * Read the latest data for this Entity.\n         */\n\n    }, {\n        key: 'read',\n        value: function read() {\n            return new _bluebird2.default(function ($return, $error) {\n                var data;\n                return (0, _core.readEntity)(this.model.user, this.model.type, this.id).then(function ($await_5) {\n                    data = $await_5;\n                    this._data = Immutable.Map((0, _core.validateEntity)(data, this.model.schema));\n                    return $return(this);\n                }.$asyncbind(this, $error), $error);\n            }.$asyncbind(this));\n        }\n\n        /**\n         * Update this Entity with the given data, else with `this._data`.\n         */\n\n    }, {\n        key: 'update',\n        value: function update(data) {\n            return new _bluebird2.default(function ($return, $error) {\n                data = (0, _core.validateEntity)(data, this.model.schema);\n                return (0, _core.updateEntity)(this.model.user, this.model.type, this.id, data).then(function ($await_6) {\n                    data = $await_6;\n\n                    if (this._data !== data) this._data = this._data.mergeDeep(data);\n                    return $return(this);\n                }.$asyncbind(this, $error), $error);\n            }.$asyncbind(this));\n        }\n\n        /**\n         * Permanently delete this Entity.\n         */\n\n    }, {\n        key: 'destroy',\n        value: function destroy() {\n            return new _bluebird2.default(function ($return, $error) {\n                return (0, _core.deleteEntity)(this.model.user, this.model.type, this.id).then(function ($await_7) {\n                    delete this;\n                    return $return();\n                }.$asyncbind(this, $error), $error);\n            }.$asyncbind(this));\n        }\n    }, {\n        key: 'id',\n        get: function get() {\n            return this._data.get('id');\n        }\n    }]);\n\n    return Entity;\n}();\n\nexports.default = Entity;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJhc2UuanMiXSwibmFtZXMiOlsiXyIsIkltbXV0YWJsZSIsIkVudGl0eU1vZGVsIiwidXNlciIsImVudGl0eVR5cGUiLCJzY2hlbWEiLCJpbnN0YW5jZUNsYXNzIiwidHlwZSIsImRhdGEiLCJjcmVhdGVkIiwiaWQiLCJwYXJhbXMiLCJwcm9taXNlIiwidGhlbiIsIm1hcCIsIkF0dHJpYnV0ZUVycm9yIiwiYXR0cmlidXRlIiwiZW50aXR5IiwidG9TdHJpbmciLCJFbnRpdHkiLCJtb2RlbCIsInJlbGF0ZWRSZWZzIiwiX2RhdGEiLCJNYXAiLCJfcmVsYXRlZFJlZnMiLCJ1cHBlckZpcnN0Iiwia2V5IiwiZ2V0IiwicmVsYXRlZE5hbWUiLCJFcnJvciIsIml0ZXJhdGUiLCJzZXEiLCJ0b1NlcSIsImFyZ3VtZW50cyIsImxlbmd0aCIsImZpbHRlciIsInZhbCIsImluY2x1ZGVzIiwicHJvcHMiLCJtYW55IiwiX2dldE1hbnlSZWxhdGVkIiwiX2dldFJlbGF0ZWQiLCJyZXNvbHZlIiwidG9PYmplY3QiLCJoYXMiLCJjYXRjaCIsImVyciIsInZhbHVlcyIsIm1lcmdlRGVlcCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFDQTs7SUFBWUEsQzs7QUFDWjs7SUFBWUMsUzs7QUFDWjs7OztBQUNBOzs7O0FBV0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBVUE7Ozs7OztJ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QUNFLEtBQUtpQixLQUFMLENBQVdiLElBRGIsRUFDbUIsS0FBS0csRUFEeEIsQ0FBTjtBQUFQRix3QkFBTixHQUFhLFFBQWI7QUFFQSx5QkFBS2MsS0FBTCxHQUFhckIsVUFBVXNCLEdBQVYsQ0FDVCwwQkFBZWYsSUFBZixFQUFxQixLQUFLWSxLQUFMLENBQVdmLE1BQWhDLENBRFMsQ0FBYjtBQUVBLG1DQUFPLElBQVA7QUFKYTs7OztBQU9qQjs7Ozs7OytCQUdhRyxJOztBQUNUQSx1QkFBTywwQkFBZUEsSUFBZixFQUFxQixLQUFLWSxLQUFMLENBQVdmLE1BQWhDLENBQVA7QUFDTyx1QkFBTSx3QkFDVCxLQUFLZSxLQUFMLENBQVdqQixJQURGLEVBQ1EsS0FBS2lCLEtBQUwsQ0FBV2IsSUFEbkIsRUFDeUIsS0FBS0csRUFEOUIsRUFDa0NGLElBRGxDLENBQU47QUFBUEEsMkJBQU8sUUFBUDs7QUFHQSx3QkFBSSxLQUFLYyxLQUFMLEtBQWVkLElBQW5CLEVBQ0ksS0FBS2MsS0FBTCxHQUFhLEtBQUtBLEtBQUwsQ0FBVzBCLFNBQVgsQ0FBcUJ4QyxJQUFyQixDQUFiO0FBQ0osbUNBQU8sSUFBUDtBQUxPOzs7O0FBUVg7Ozs7Ozs7O0FBSUksdUJBQU0sd0JBQ0YsS0FBS1ksS0FBTCxDQUFXakIsSUFEVCxFQUNlLEtBQUtpQixLQUFMLENBQVdiLElBRDFCLEVBQ2dDLEtBQUtHLEVBRHJDLENBQU47QUFFQSwyQkFBTyxJQUFQO0FBRkE7QUFBQTs7Ozs7NEJBOUhhO0FBQ2IsbUJBQU8sS0FBS1ksS0FBTCxDQUFXSyxHQUFYLENBQWUsSUFBZixDQUFQO0FBQ0g7Ozs7OztrQkFrSVVSLE0iLCJmaWxlIjoiYmFzZS5qcyIsInNvdXJjZVJvb3QiOiIvVXNlcnMvZHRyL2dvb2VlL2VjbWFzY3JpcHQtc2RrL3NyYy9lbnRpdGllcyIsInNvdXJjZXNDb250ZW50IjpbIi8qIEBmbG93ICovXG5pbXBvcnQgKiBhcyBfIGZyb20gJ2xvZGFzaCdcbmltcG9ydCAqIGFzIEltbXV0YWJsZSBmcm9tICdpbW11dGFibGUnXG5pbXBvcnQgRXh0ZW5kYWJsZUVycm9yIGZyb20gJ2VzNi1lcnJvcidcbmltcG9ydCBQcm9taXNlIGZyb20gJ2JsdWViaXJkJ1xuXG5pbXBvcnQgdHlwZSB7XG4gICAgSnNvbk9iamVjdCxcbiAgICBFbnRpdHlUeXBlLFxuICAgIEVudGl0eVNjaGVtYSxcbiAgICBFbnRpdHlKc29uLFxuICAgIFF1ZXJ5UGFyYW1zLFxufSBmcm9tICcuLi90eXBlcydcbmltcG9ydCB0eXBlIFVzZXIgZnJvbSAnLi4vYXV0aCdcblxuaW1wb3J0IHtcbiAgICB2YWxpZGF0ZUVudGl0eSxcbiAgICByZWFkRW50aXR5LFxuICAgIGNyZWF0ZUVudGl0eSxcbiAgICB1cGRhdGVFbnRpdHksXG4gICAgbGlzdEVudGl0aWVzLFxuICAgIGl0ZXJFbnRpdGllcyxcbiAgICBkZWxldGVFbnRpdHksXG59IGZyb20gJy4vY29yZSdcblxuLyoqXG4gKiBCYXNlIGNsYXNzIHJlcHJlc2VudGluZyBhbiBFbnRpdHkgdHlwZSBhcyBhIHdob2xlLlxuICpcbiAqIFByb3ZpZGVzIGZ1bmN0aW9ucyBmb3IgY3JlYXRpbmcgYW4gRW50aXR5IGFuZCByZXRyaWV2aW5nIG11bHRpcGxlIEVudGl0eSdzXG4gKiBvZiB0aGUgZ2l2ZW4gdHlwZS5cbiAqL1xuZXhwb3J0IGNsYXNzIEVudGl0eU1vZGVsIHtcbiAgICB1c2VyOiBVc2VyXG4gICAgdHlwZTogRW50aXR5VHlwZVxuICAgIHNjaGVtYTogRW50aXR5U2NoZW1hXG4gICAgaW5zdGFuY2VDbGFzczogQ2xhc3M8RW50aXR5PlxuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHVzZXI6IFVzZXIsXG4gICAgICAgIGVudGl0eVR5cGU6IEVudGl0eVR5cGUsXG4gICAgICAgIHNjaGVtYTogRW50aXR5U2NoZW1hLFxuICAgICAgICBpbnN0YW5jZUNsYXNzOiBDbGFzczxFbnRpdHk+XG4gICAgKSB7XG4gICAgICAgIHRoaXMudXNlciA9IHVzZXJcbiAgICAgICAgdGhpcy50eXBlID0gZW50aXR5VHlwZVxuICAgICAgICB0aGlzLnNjaGVtYSA9IHNjaGVtYVxuICAgICAgICB0aGlzLmluc3RhbmNlQ2xhc3MgPSBpbnN0YW5jZUNsYXNzXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGFuIEVudGl0eSB3aXRoIHRoZSBnaXZlbiBkYXRhLlxuICAgICAqL1xuICAgIGFzeW5jIGNyZWF0ZShkYXRhOiBKc29uT2JqZWN0KTogUHJvbWlzZTxFbnRpdHk+IHtcbiAgICAgICAgbGV0IGNyZWF0ZWQgPSBhd2FpdCBjcmVhdGVFbnRpdHkodGhpcy51c2VyLCB0aGlzLnR5cGUsIGRhdGEpXG4gICAgICAgIGNyZWF0ZWQgPSB2YWxpZGF0ZUVudGl0eShjcmVhdGVkLCB0aGlzLnNjaGVtYSlcbiAgICAgICAgcmV0dXJuIG5ldyB0aGlzLmluc3RhbmNlQ2xhc3ModGhpcywgY3JlYXRlZClcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIEVudGl0eSB3aXRoIHRoZSBnaXZlbiBJRC5cbiAgICAgKi9cbiAgICBhc3luYyBnZXQoaWQ6IHN0cmluZyk6IFByb21pc2U8RW50aXR5PiB7XG4gICAgICAgIGxldCBkYXRhID0gYXdhaXQgcmVhZEVudGl0eSh0aGlzLnVzZXIsIHRoaXMudHlwZSwgaWQpXG4gICAgICAgIGRhdGEgPSB2YWxpZGF0ZUVudGl0eShkYXRhLCB0aGlzLnNjaGVtYSlcbiAgICAgICAgcmV0dXJuIG5ldyB0aGlzLmluc3RhbmNlQ2xhc3ModGhpcywgZGF0YSlcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBJdGVyYXRlIG92ZXIgYWxsIGV4aXN0aW5nIEVudGl0aWVzIHdpdGggdGhpcyBFbnRpdHkgdHlwZSwgZmlsdGVyZWQgYnlcbiAgICAgKiB0aGUgZ2l2ZW4gcGFyYW1zLlxuICAgICAqL1xuICAgICogaXRlcmF0ZShwYXJhbXM6IFF1ZXJ5UGFyYW1zID0ge30pOiBJdGVyYXRvcjxQcm9taXNlPEVudGl0eT4+IHtcbiAgICAgICAgZm9yIChjb25zdCBwcm9taXNlIG9mIGl0ZXJFbnRpdGllcyh0aGlzLnVzZXIsIHRoaXMudHlwZSwgcGFyYW1zKSkge1xuICAgICAgICAgICAgeWllbGQgcHJvbWlzZS50aGVuKChkYXRhKSA9PiB7XG4gICAgICAgICAgICAgICAgZGF0YSA9IHZhbGlkYXRlRW50aXR5KGRhdGEsIHRoaXMuc2NoZW1hKVxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgdGhpcy5pbnN0YW5jZUNsYXNzKHRoaXMsIGRhdGEpXG4gICAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTGlzdCBhbGwgZXhpc3RpbmcgRW50aXRpZXMgd2l0aCB0aGlzIEVudGl0eSB0eXBlLCBmaWx0ZXJlZCBieSB0aGUgZ2l2ZW5cbiAgICAgKiBwYXJhbXMuXG4gICAgICpcbiAgICAgKiBJZiB0aGVyZSBhcmUgYSBsYXJnZSBudW1iZXIgb2YgRW50aXR5TW9kZWwgb2YgdGhpcyB0eXBlLCB0aGlzIG1ldGhvZFxuICAgICAqIGNhbiBiZSBleHRyZW1lbHkgc2xvdy4gSW4gdGhlc2UgY2FzZXMsIHVzZSBpdGVyYXRlKCkgaW5zdGVhZC5cbiAgICAgKi9cbiAgICBhc3luYyBsaXN0KHBhcmFtczogUXVlcnlQYXJhbXMgPSB7fSk6IFByb21pc2U8RW50aXR5W10+IHtcbiAgICAgICAgcmV0dXJuIGxpc3RFbnRpdGllcyh0aGlzLnVzZXIsIHRoaXMudHlwZSwgcGFyYW1zKS5tYXAoKGRhdGEpID0+IHtcbiAgICAgICAgICAgIGRhdGEgPSB2YWxpZGF0ZUVudGl0eShkYXRhLCB0aGlzLnNjaGVtYSlcbiAgICAgICAgICAgIHJldHVybiBuZXcgdGhpcy5pbnN0YW5jZUNsYXNzKHRoaXMsIGRhdGEpXG4gICAgICAgIH0pXG4gICAgfVxufVxuXG4vKipcbiAqIEV4Y2VwdGlvbiBmb3Igd3JvbmcgYXR0cmlidXRlIGxvb2t1cHMgb24gRW50aXR5IGRhdGEuXG4gKi9cbmV4cG9ydCBjbGFzcyBBdHRyaWJ1dGVFcnJvciBleHRlbmRzIEV4dGVuZGFibGVFcnJvciB7XG4gICAgYXR0cmlidXRlOiBzdHJpbmdcbiAgICBlbnRpdHk6IEVudGl0eVxuXG4gICAgY29uc3RydWN0b3IoYXR0cmlidXRlOiBzdHJpbmcsIGVudGl0eTogRW50aXR5KSB7XG4gICAgICAgIHN1cGVyKGBObyBhdHRyaWJ1dGUgY2FsbGVkICcke2F0dHJpYnV0ZX0nIGZvdW5kIG9uIEVudGl0eWBcbiAgICAgICAgICAgICsgYCAke2VudGl0eS50b1N0cmluZygpfWApXG4gICAgICAgIHRoaXMuYXR0cmlidXRlID0gYXR0cmlidXRlXG4gICAgICAgIHRoaXMuZW50aXR5ID0gZW50aXR5XG4gICAgfVxufVxuXG50eXBlIHJlbGF0ZWRSZWZzID0ge1xuICAgIFtrZXk6IHN0cmluZ106IHt8XG4gICAgICAgIG1vZGVsOiBFbnRpdHlNb2RlbCxcbiAgICAgICAgcmVsYXRlZE5hbWU/OiBzdHJpbmcsXG4gICAgfH1cbn1cblxuLyoqXG4gKiBCYXNlIGNsYXNzIGZvciBhbiBFbnRpdHkgaW4gdGhlIEdvb2VlIGVjb3N5c3RlbS5cbiAqL1xuZXhwb3J0IGNsYXNzIEVudGl0eSB7XG4gICAgbW9kZWw6IEVudGl0eU1vZGVsXG4gICAgX2RhdGE6IEltbXV0YWJsZS5NYXA8c3RyaW5nLCAqPlxuICAgIF9yZWxhdGVkUmVmczogcmVsYXRlZFJlZnNcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBtb2RlbDogRW50aXR5TW9kZWwsXG4gICAgICAgIGRhdGE6IEVudGl0eUpzb24sXG4gICAgICAgIHJlbGF0ZWRSZWZzOiByZWxhdGVkUmVmcyA9IHt9XG4gICAgKSB7XG4gICAgICAgIHRoaXMubW9kZWwgPSBtb2RlbFxuICAgICAgICB0aGlzLl9kYXRhID0gSW1tdXRhYmxlLk1hcChkYXRhKVxuICAgICAgICB0aGlzLl9yZWxhdGVkUmVmcyA9IHJlbGF0ZWRSZWZzXG4gICAgfVxuXG4gICAgZ2V0IGlkKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiB0aGlzLl9kYXRhLmdldCgnaWQnKVxuICAgIH1cblxuICAgIHRvU3RyaW5nKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiBgPCR7Xy51cHBlckZpcnN0KHRoaXMubW9kZWwudHlwZSl9ICR7dGhpcy5pZH0+YFxuICAgIH1cbiAgICAvL1xuICAgIC8vIF9idWlsZEF0dHJHZXR0ZXJzKCkge1xuICAgIC8vICAgICBfLmZvck93bih0aGlzLl9yZWxhdGVkUmVmcywgKHJlZkRhdGEsIGtleSkgPT4ge1xuICAgIC8vICAgICAgICAgaWYgKHJlZkRhdGEubWFueSlcbiAgICAvLyAgICAgICAgICAgICB0aGlzW2tleV0gPSAoKSA9PiB0aGlzLl9nZXRNYW55UmVsYXRlZChrZXkpXG4gICAgLy8gICAgICAgICBlbHNlXG4gICAgLy8gICAgICAgICAgICAgdGhpc1trZXldID0gKCkgPT4gdGhpcy5fZ2V0UmVsYXRlZChrZXksIHRoaXMuX2RhdGEuZ2V0KGtleSkpXG4gICAgLy8gICAgIH0pXG4gICAgLy8gfVxuXG4gICAgX2dldFZhbHVlKGtleTogc3RyaW5nKTogKiB7XG4gICAgICAgIHJldHVybiB0aGlzLl9kYXRhLmdldChrZXkpXG4gICAgfVxuXG4gICAgX2dldFJlbGF0ZWQoa2V5OiBzdHJpbmcsIGlkOiBzdHJpbmcpOiBQcm9taXNlPEVudGl0eT4ge1xuICAgICAgICBjb25zdCBtb2RlbCA9IHRoaXMuX3JlbGF0ZWRSZWZzW2tleV0ubW9kZWxcbiAgICAgICAgcmV0dXJuIG1vZGVsLmdldChpZClcbiAgICB9XG5cbiAgICBfZ2V0TWFueVJlbGF0ZWQoa2V5OiBzdHJpbmcpOiBJdGVyYXRvcjxQcm9taXNlPEVudGl0eT4+IHtcbiAgICAgICAgY29uc3QgeyBtb2RlbCwgcmVsYXRlZE5hbWUgfSA9IHRoaXMuX3JlbGF0ZWRSZWZzW2tleV1cblxuICAgICAgICBpZiAoIXJlbGF0ZWROYW1lKVxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICAgICAgICAgIGBObyBtYW55IHJlbGF0aW9uc2hpcCBvbiBrZXkgJyR7a2V5fSdgXG4gICAgICAgICAgICAgICAgKyBgIGZvciBFbnRpdHkgJHt0aGlzLnRvU3RyaW5nKCl9YClcblxuICAgICAgICByZXR1cm4gbW9kZWwuaXRlcmF0ZSh7XG4gICAgICAgICAgICBbcmVsYXRlZE5hbWVdOiB0aGlzLmlkLFxuICAgICAgICB9KVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBFbnRpdHkgZGF0YSBhcyBKUyBvYmplY3QuXG4gICAgICpcbiAgICAgKiBHaXZlbiBubyBhcmd1bWVudHMsIHJldHVybnMgdGhlIHdob2xlIGRhdGEgb2JqZWN0LiBFbHNlLCByZXR1cm5zIG9ubHlcbiAgICAgKiB0aGUgZmllbGRzIGdpdmVuLlxuICAgICAqIFRPRE86IEFkZCB2YWxpZGF0aW9uIGZvciBtaXNzaW5nIHZhbHVlcy5cbiAgICAgKi9cbiAgICBhc3luYyB2YWx1ZXMoKTogUHJvbWlzZTx7IFtrZXk6IHN0cmluZ106ICogfT4ge1xuICAgICAgICAvLyBGaWx0ZXIgdG8gdGhlIGdpdmVuIGZpZWxkc1xuICAgICAgICBsZXQgc2VxID0gdGhpcy5fZGF0YS50b1NlcSgpXG4gICAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoKVxuICAgICAgICAgICAgc2VxID0gc2VxLmZpbHRlcigodmFsLCBrZXkpID0+IF8uaW5jbHVkZXMoYXJndW1lbnRzLCBrZXkpKVxuXG4gICAgICAgIC8vIEZldGNoIGRhdGEgZm9yIHJlbGF0ZWQgZmllbGRzXG4gICAgICAgIHJldHVybiBQcm9taXNlLnByb3BzKFxuICAgICAgICAgICAgc2VxLm1hcCgodmFsLCBrZXkpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoa2V5IGluIHRoaXMuX3JlbGF0ZWRSZWZzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9yZWxhdGVkUmVmc1trZXldLm1hbnkpXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fZ2V0TWFueVJlbGF0ZWQoa2V5KVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fZ2V0UmVsYXRlZChrZXksIHZhbClcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh2YWwpXG4gICAgICAgICAgICB9KS50b09iamVjdCgpXG4gICAgICAgIClcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBMaWtlIGB2YWx1ZXMoKWAsIGJ1dCByZXR1cm5zIG9ubHkgdGhlIHZhbHVlcywgYXMgYW4gYXJyYXkuXG4gICAgICpcbiAgICAgKiBJZiBubyBhcmdzIGFyZSBnaXZlbiwgcmV0dXJucyBhbiBlbXB0eSBhcnJheS5cbiAgICAgKi9cbiAgICBhc3luYyB2YWx1ZXNMaXN0KCk6IFByb21pc2U8QXJyYXk8Kj4+IHtcbiAgICAgICAgcmV0dXJuIGF3YWl0IFByb21pc2UubWFwKGFyZ3VtZW50cywgKGtleSkgPT4ge1xuICAgICAgICAgICAgaWYgKCF0aGlzLl9kYXRhLmhhcyhrZXkpKVxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBBdHRyaWJ1dGVFcnJvcihrZXksIHRoaXMpXG5cbiAgICAgICAgICAgIGlmIChrZXkgaW4gdGhpcy5fcmVsYXRlZFJlZnMpIHtcbiAgICAgICAgICAgICAgICBjb25zdCByZWxhdGVkTmFtZSA9IHRoaXMuX3JlbGF0ZWRSZWZzW2tleV0ucmVsYXRlZE5hbWVcblxuICAgICAgICAgICAgICAgIGlmIChyZWxhdGVkTmFtZSlcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2dldE1hbnlSZWxhdGVkKGtleSwgcmVsYXRlZE5hbWUpXG5cbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fZ2V0UmVsYXRlZChrZXksIHRoaXMuX2RhdGEuZ2V0KGtleSkpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fZGF0YS5nZXQoa2V5KVxuXG4gICAgICAgIH0pLmNhdGNoKChlcnIpID0+IHsgdGhyb3cgZXJyIH0pICAvLyBUT0RPOiBkZXRlcm1pbmUgaWYgaSBuZWVkIHRoaXNcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgYSBkYXRhIGF0dHJpYnV0ZSBvZiB0aGlzIEVudGl0eS5cbiAgICAgKi9cbiAgICBhc3luYyBnZXQoa2V5OiBzdHJpbmcpOiBQcm9taXNlPCo+IHtcbiAgICAgICAgaWYgKCF0aGlzLl9kYXRhLmhhcyhrZXkpKVxuICAgICAgICAgICAgdGhyb3cgbmV3IEF0dHJpYnV0ZUVycm9yKGtleSwgdGhpcylcblxuICAgICAgICByZXR1cm4gKGF3YWl0IHRoaXMudmFsdWVzKGtleSkpWzBdXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVhZCB0aGUgbGF0ZXN0IGRhdGEgZm9yIHRoaXMgRW50aXR5LlxuICAgICAqL1xuICAgIGFzeW5jIHJlYWQoKTogUHJvbWlzZTxFbnRpdHk+IHtcbiAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlYWRFbnRpdHkoXG4gICAgICAgICAgICB0aGlzLm1vZGVsLnVzZXIsIHRoaXMubW9kZWwudHlwZSwgdGhpcy5pZClcbiAgICAgICAgdGhpcy5fZGF0YSA9IEltbXV0YWJsZS5NYXAoXG4gICAgICAgICAgICB2YWxpZGF0ZUVudGl0eShkYXRhLCB0aGlzLm1vZGVsLnNjaGVtYSkpXG4gICAgICAgIHJldHVybiB0aGlzXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVXBkYXRlIHRoaXMgRW50aXR5IHdpdGggdGhlIGdpdmVuIGRhdGEsIGVsc2Ugd2l0aCBgdGhpcy5fZGF0YWAuXG4gICAgICovXG4gICAgYXN5bmMgdXBkYXRlKGRhdGE6IEpzb25PYmplY3QpOiBQcm9taXNlPEVudGl0eT4ge1xuICAgICAgICBkYXRhID0gdmFsaWRhdGVFbnRpdHkoZGF0YSwgdGhpcy5tb2RlbC5zY2hlbWEpXG4gICAgICAgIGRhdGEgPSBhd2FpdCB1cGRhdGVFbnRpdHkoXG4gICAgICAgICAgICB0aGlzLm1vZGVsLnVzZXIsIHRoaXMubW9kZWwudHlwZSwgdGhpcy5pZCwgZGF0YSlcblxuICAgICAgICBpZiAodGhpcy5fZGF0YSAhPT0gZGF0YSlcbiAgICAgICAgICAgIHRoaXMuX2RhdGEgPSB0aGlzLl9kYXRhLm1lcmdlRGVlcChkYXRhKVxuICAgICAgICByZXR1cm4gdGhpc1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFBlcm1hbmVudGx5IGRlbGV0ZSB0aGlzIEVudGl0eS5cbiAgICAgKi9cbiAgICBhc3luYyBkZXN0cm95KCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBhd2FpdCBkZWxldGVFbnRpdHkoXG4gICAgICAgICAgICB0aGlzLm1vZGVsLnVzZXIsIHRoaXMubW9kZWwudHlwZSwgdGhpcy5pZClcbiAgICAgICAgZGVsZXRlIHRoaXNcbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IEVudGl0eVxuIl19",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "base.js"
      ],
      "names": [
        "_",
        "Immutable",
        "EntityModel",
        "user",
        "entityType",
        "schema",
        "instanceClass",
        "type",
        "data",
        "created",
        "id",
        "params",
        "promise",
        "then",
        "map",
        "AttributeError",
        "attribute",
        "entity",
        "toString",
        "Entity",
        "model",
        "relatedRefs",
        "_data",
        "Map",
        "_relatedRefs",
        "upperFirst",
        "key",
        "get",
        "relatedName",
        "Error",
        "iterate",
        "seq",
        "toSeq",
        "arguments",
        "length",
        "filter",
        "val",
        "includes",
        "props",
        "many",
        "_getManyRelated",
        "_getRelated",
        "resolve",
        "toObject",
        "has",
        "catch",
        "err",
        "values",
        "mergeDeep"
      ],
      "mappings": "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",
      "file": "base.js",
      "sourceRoot": "/Users/dtr/gooee/ecmascript-sdk/src/entities",
      "sourcesContent": [
        "/* @flow */\nimport * as _ from 'lodash'\nimport * as Immutable from 'immutable'\nimport ExtendableError from 'es6-error'\nimport Promise from 'bluebird'\n\nimport type {\n    JsonObject,\n    EntityType,\n    EntitySchema,\n    EntityJson,\n    QueryParams,\n} from '../types'\nimport type User from '../auth'\n\nimport {\n    validateEntity,\n    readEntity,\n    createEntity,\n    updateEntity,\n    listEntities,\n    iterEntities,\n    deleteEntity,\n} from './core'\n\n/**\n * Base class representing an Entity type as a whole.\n *\n * Provides functions for creating an Entity and retrieving multiple Entity's\n * of the given type.\n */\nexport class EntityModel {\n    user: User\n    type: EntityType\n    schema: EntitySchema\n    instanceClass: Class<Entity>\n\n    constructor(\n        user: User,\n        entityType: EntityType,\n        schema: EntitySchema,\n        instanceClass: Class<Entity>\n    ) {\n        this.user = user\n        this.type = entityType\n        this.schema = schema\n        this.instanceClass = instanceClass\n    }\n\n    /**\n     * Create an Entity with the given data.\n     */\n    async create(data: JsonObject): Promise<Entity> {\n        let created = await createEntity(this.user, this.type, data)\n        created = validateEntity(created, this.schema)\n        return new this.instanceClass(this, created)\n    }\n\n    /**\n     * Get the Entity with the given ID.\n     */\n    async get(id: string): Promise<Entity> {\n        let data = await readEntity(this.user, this.type, id)\n        data = validateEntity(data, this.schema)\n        return new this.instanceClass(this, data)\n    }\n\n    /**\n     * Iterate over all existing Entities with this Entity type, filtered by\n     * the given params.\n     */\n    * iterate(params: QueryParams = {}): Iterator<Promise<Entity>> {\n        for (const promise of iterEntities(this.user, this.type, params)) {\n            yield promise.then((data) => {\n                data = validateEntity(data, this.schema)\n                return new this.instanceClass(this, data)\n            })\n        }\n    }\n\n    /**\n     * List all existing Entities with this Entity type, filtered by the given\n     * params.\n     *\n     * If there are a large number of EntityModel of this type, this method\n     * can be extremely slow. In these cases, use iterate() instead.\n     */\n    async list(params: QueryParams = {}): Promise<Entity[]> {\n        return listEntities(this.user, this.type, params).map((data) => {\n            data = validateEntity(data, this.schema)\n            return new this.instanceClass(this, data)\n        })\n    }\n}\n\n/**\n * Exception for wrong attribute lookups on Entity data.\n */\nexport class AttributeError extends ExtendableError {\n    attribute: string\n    entity: Entity\n\n    constructor(attribute: string, entity: Entity) {\n        super(`No attribute called '${attribute}' found on Entity`\n            + ` ${entity.toString()}`)\n        this.attribute = attribute\n        this.entity = entity\n    }\n}\n\ntype relatedRefs = {\n    [key: string]: {|\n        model: EntityModel,\n        relatedName?: string,\n    |}\n}\n\n/**\n * Base class for an Entity in the Gooee ecosystem.\n */\nexport class Entity {\n    model: EntityModel\n    _data: Immutable.Map<string, *>\n    _relatedRefs: relatedRefs\n\n    constructor(\n        model: EntityModel,\n        data: EntityJson,\n        relatedRefs: relatedRefs = {}\n    ) {\n        this.model = model\n        this._data = Immutable.Map(data)\n        this._relatedRefs = relatedRefs\n    }\n\n    get id(): string {\n        return this._data.get('id')\n    }\n\n    toString(): string {\n        return `<${_.upperFirst(this.model.type)} ${this.id}>`\n    }\n    //\n    // _buildAttrGetters() {\n    //     _.forOwn(this._relatedRefs, (refData, key) => {\n    //         if (refData.many)\n    //             this[key] = () => this._getManyRelated(key)\n    //         else\n    //             this[key] = () => this._getRelated(key, this._data.get(key))\n    //     })\n    // }\n\n    _getValue(key: string): * {\n        return this._data.get(key)\n    }\n\n    _getRelated(key: string, id: string): Promise<Entity> {\n        const model = this._relatedRefs[key].model\n        return model.get(id)\n    }\n\n    _getManyRelated(key: string): Iterator<Promise<Entity>> {\n        const { model, relatedName } = this._relatedRefs[key]\n\n        if (!relatedName)\n            throw new Error(\n                `No many relationship on key '${key}'`\n                + ` for Entity ${this.toString()}`)\n\n        return model.iterate({\n            [relatedName]: this.id,\n        })\n    }\n\n    /**\n     * Get Entity data as JS object.\n     *\n     * Given no arguments, returns the whole data object. Else, returns only\n     * the fields given.\n     * TODO: Add validation for missing values.\n     */\n    async values(): Promise<{ [key: string]: * }> {\n        // Filter to the given fields\n        let seq = this._data.toSeq()\n        if (arguments.length)\n            seq = seq.filter((val, key) => _.includes(arguments, key))\n\n        // Fetch data for related fields\n        return Promise.props(\n            seq.map((val, key) => {\n                if (key in this._relatedRefs) {\n                    if (this._relatedRefs[key].many)\n                        return this._getManyRelated(key)\n                    return this._getRelated(key, val)\n                }\n                return Promise.resolve(val)\n            }).toObject()\n        )\n    }\n\n    /**\n     * Like `values()`, but returns only the values, as an array.\n     *\n     * If no args are given, returns an empty array.\n     */\n    async valuesList(): Promise<Array<*>> {\n        return await Promise.map(arguments, (key) => {\n            if (!this._data.has(key))\n                throw new AttributeError(key, this)\n\n            if (key in this._relatedRefs) {\n                const relatedName = this._relatedRefs[key].relatedName\n\n                if (relatedName)\n                    return this._getManyRelated(key, relatedName)\n\n                return this._getRelated(key, this._data.get(key))\n            }\n            return this._data.get(key)\n\n        }).catch((err) => { throw err })  // TODO: determine if i need this\n    }\n\n    /**\n     * Get a data attribute of this Entity.\n     */\n    async get(key: string): Promise<*> {\n        if (!this._data.has(key))\n            throw new AttributeError(key, this)\n\n        return (await this.values(key))[0]\n    }\n\n    /**\n     * Read the latest data for this Entity.\n     */\n    async read(): Promise<Entity> {\n        const data = await readEntity(\n            this.model.user, this.model.type, this.id)\n        this._data = Immutable.Map(\n            validateEntity(data, this.model.schema))\n        return this\n    }\n\n    /**\n     * Update this Entity with the given data, else with `this._data`.\n     */\n    async update(data: JsonObject): Promise<Entity> {\n        data = validateEntity(data, this.model.schema)\n        data = await updateEntity(\n            this.model.user, this.model.type, this.id, data)\n\n        if (this._data !== data)\n            this._data = this._data.mergeDeep(data)\n        return this\n    }\n\n    /**\n     * Permanently delete this Entity.\n     */\n    async destroy(): Promise<void> {\n        await deleteEntity(\n            this.model.user, this.model.type, this.id)\n        delete this\n    }\n}\n\nexport default Entity\n"
      ]
    },
    "mtime": 1476987256000
  },
  "{\"filename\":\"/Users/dtr/gooee/ecmascript-sdk/src/entities/core.js\",\"env\":{},\"retainLines\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"presets\":[],\"plugins\":[[[],null],[[],null],[[],null],[[],{\"loose\":false,\"spec\":false}],[[],null],[[],null],[[],{\"spec\":false}],[[],null],[[],{\"loose\":false}],[[],null],[[],null],[[],null],[[],{\"loose\":false}],[[],{\"loose\":false}],[[],null],[[],null],[[],null],[[],{\"loose\":false}],[[],null],[[],{\"loose\":false}],[[],null],[[],null],[[],{\"loose\":false}],[[],{\"async\":false,\"asyncGenerators\":false}]],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"minified\":false,\"sourceRoot\":\"/Users/dtr/gooee/ecmascript-sdk/src/entities\",\"babelrc\":true,\"sourceType\":\"module\",\"moduleIds\":false,\"passPerPreset\":false,\"parserOpts\":false,\"generatorOpts\":false}:6.17.0": {
    "metadata": {
      "usedHelpers": [
        "toConsumableArray",
        "interopRequireDefault",
        "interopRequireWildcard",
        "typeof"
      ],
      "marked": [],
      "modules": {
        "imports": [
          {
            "source": "babel-regenerator-runtime",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "regeneratorRuntime"
              }
            ]
          },
          {
            "source": "lodash",
            "imported": [
              "*"
            ],
            "specifiers": [
              {
                "kind": "namespace",
                "local": "_"
              }
            ]
          },
          {
            "source": "../types",
            "imported": [
              "EntityJson",
              "EntityResponse",
              "EntitySchema",
              "EntityType",
              "JsonObject",
              "JsonResponse",
              "QueryParams"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "EntityJson",
                "local": "EntityJson"
              },
              {
                "kind": "named",
                "imported": "EntityResponse",
                "local": "EntityResponse"
              },
              {
                "kind": "named",
                "imported": "EntitySchema",
                "local": "EntitySchema"
              },
              {
                "kind": "named",
                "imported": "EntityType",
                "local": "EntityType"
              },
              {
                "kind": "named",
                "imported": "JsonObject",
                "local": "JsonObject"
              },
              {
                "kind": "named",
                "imported": "JsonResponse",
                "local": "JsonResponse"
              },
              {
                "kind": "named",
                "imported": "QueryParams",
                "local": "QueryParams"
              }
            ]
          },
          {
            "source": "../auth",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "User"
              }
            ]
          },
          {
            "source": "../api",
            "imported": [
              "*"
            ],
            "specifiers": [
              {
                "kind": "namespace",
                "local": "api"
              }
            ]
          },
          {
            "source": "../schema",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "Joi"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "validateEntity",
            "data",
            "schema",
            "readEntity",
            "user",
            "entityType",
            "id",
            "updateEntity",
            "user",
            "entityType",
            "id",
            "data",
            "createEntity",
            "user",
            "entityType",
            "data",
            "deleteEntity",
            "user",
            "entityType",
            "id",
            "listEntities",
            "user",
            "entityType",
            "params",
            "iterEntities",
            "user",
            "entityType",
            "params"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "validateEntity",
              "exported": "validateEntity"
            },
            {
              "kind": "local",
              "local": "data",
              "exported": "data"
            },
            {
              "kind": "local",
              "local": "schema",
              "exported": "schema"
            },
            {
              "kind": "local",
              "local": "readEntity",
              "exported": "readEntity"
            },
            {
              "kind": "local",
              "local": "user",
              "exported": "user"
            },
            {
              "kind": "local",
              "local": "entityType",
              "exported": "entityType"
            },
            {
              "kind": "local",
              "local": "id",
              "exported": "id"
            },
            {
              "kind": "local",
              "local": "updateEntity",
              "exported": "updateEntity"
            },
            {
              "kind": "local",
              "local": "user",
              "exported": "user"
            },
            {
              "kind": "local",
              "local": "entityType",
              "exported": "entityType"
            },
            {
              "kind": "local",
              "local": "id",
              "exported": "id"
            },
            {
              "kind": "local",
              "local": "data",
              "exported": "data"
            },
            {
              "kind": "local",
              "local": "createEntity",
              "exported": "createEntity"
            },
            {
              "kind": "local",
              "local": "user",
              "exported": "user"
            },
            {
              "kind": "local",
              "local": "entityType",
              "exported": "entityType"
            },
            {
              "kind": "local",
              "local": "data",
              "exported": "data"
            },
            {
              "kind": "local",
              "local": "deleteEntity",
              "exported": "deleteEntity"
            },
            {
              "kind": "local",
              "local": "user",
              "exported": "user"
            },
            {
              "kind": "local",
              "local": "entityType",
              "exported": "entityType"
            },
            {
              "kind": "local",
              "local": "id",
              "exported": "id"
            },
            {
              "kind": "local",
              "local": "listEntities",
              "exported": "listEntities"
            },
            {
              "kind": "local",
              "local": "user",
              "exported": "user"
            },
            {
              "kind": "local",
              "local": "entityType",
              "exported": "entityType"
            },
            {
              "kind": "local",
              "local": "params",
              "exported": "params"
            },
            {
              "kind": "local",
              "local": "iterEntities",
              "exported": "iterEntities"
            },
            {
              "kind": "local",
              "local": "user",
              "exported": "user"
            },
            {
              "kind": "local",
              "local": "entityType",
              "exported": "entityType"
            },
            {
              "kind": "local",
              "local": "params",
              "exported": "params"
            }
          ]
        }
      }
    },
    "options": {
      "filename": "/Users/dtr/gooee/ecmascript-sdk/src/entities/core.js",
      "filenameRelative": "/Users/dtr/gooee/ecmascript-sdk/src/entities/core.js",
      "env": {},
      "retainLines": false,
      "highlightCode": true,
      "suppressDeprecationMessages": false,
      "presets": [],
      "plugins": [
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false,
            "spec": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "spec": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          {
            "async": false,
            "asyncGenerators": false
          }
        ]
      ],
      "ignore": [],
      "code": true,
      "metadata": true,
      "ast": false,
      "comments": true,
      "compact": "auto",
      "minified": false,
      "sourceMaps": "both",
      "sourceMapTarget": "core.js",
      "sourceFileName": "core.js",
      "sourceRoot": "/Users/dtr/gooee/ecmascript-sdk/src/entities",
      "babelrc": false,
      "sourceType": "module",
      "moduleRoot": "/Users/dtr/gooee/ecmascript-sdk/src/entities",
      "moduleIds": false,
      "passPerPreset": false,
      "parserOpts": false,
      "generatorOpts": false,
      "basename": "core"
    },
    "ignored": false,
    "code": "'use strict';\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.validateEntity = validateEntity;\nexports.readEntity = readEntity;\nexports.updateEntity = updateEntity;\nexports.createEntity = createEntity;\nexports.deleteEntity = deleteEntity;\nexports.listEntities = listEntities;\nexports.iterEntities = iterEntities;\n\nvar _babelRegeneratorRuntime = require('babel-regenerator-runtime');\n\nvar _babelRegeneratorRuntime2 = _interopRequireDefault(_babelRegeneratorRuntime);\n\nvar _lodash = require('lodash');\n\nvar _ = _interopRequireWildcard(_lodash);\n\nvar _api = require('../api');\n\nvar api = _interopRequireWildcard(_api);\n\nvar _schema = require('../schema');\n\nvar _schema2 = _interopRequireDefault(_schema);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nFunction.prototype.$asyncbind = function $asyncbind(self, catcher) {\n    'use strict';\n\n    if (!Function.prototype.$asyncbind) {\n        Object.defineProperty(Function.prototype, '$asyncbind', {\n            value: $asyncbind,\n            enumerable: false,\n            configurable: true,\n            writable: true\n        });\n    }\n\n    if (!$asyncbind.trampoline) {\n        $asyncbind.trampoline = function trampoline(t, x, s, e) {\n            return function b(q) {\n                while (q) {\n                    if (q.then) return q.then(b, e);\n\n                    try {\n                        if (q.pop) {\n                            if (q.length) return q.pop() ? x.call(t) : q;\n                            q = s;\n                        } else q = q.call(t);\n                    } catch (r) {\n                        return e(r);\n                    }\n                }\n            };\n        };\n    }\n\n    if (!$asyncbind.LazyThenable) {\n        $asyncbind.LazyThenable = function () {\n            function isThenable(obj) {\n                return obj && obj instanceof Object && typeof obj.then === 'function';\n            }\n\n            function resolution(p, r, how) {\n                try {\n                    var x = how ? how(r) : r;\n                    if (p === x) return p.reject(new TypeError('Promise resolution loop'));\n\n                    if (isThenable(x)) {\n                        x.then(function (y) {\n                            resolution(p, y);\n                        }, function (e) {\n                            p.reject(e);\n                        });\n                    } else {\n                        p.resolve(x);\n                    }\n                } catch (ex) {\n                    p.reject(ex);\n                }\n            }\n\n            function Chained() {}\n\n            ;\n            Chained.prototype = {\n                resolve: _unchained,\n                reject: _unchained,\n                then: thenChain\n            };\n\n            function _unchained(v) {}\n\n            function thenChain(res, rej) {\n                this.resolve = res;\n                this.reject = rej;\n            }\n\n            function then(res, rej) {\n                var chain = new Chained();\n\n                try {\n                    this._resolver(function (value) {\n                        return isThenable(value) ? value.then(res, rej) : resolution(chain, value, res);\n                    }, function (ex) {\n                        resolution(chain, ex, rej);\n                    });\n                } catch (ex) {\n                    resolution(chain, ex, rej);\n                }\n\n                return chain;\n            }\n\n            function Thenable(resolver) {\n                this._resolver = resolver;\n                this.then = then;\n            }\n\n            ;\n\n            Thenable.resolve = function (v) {\n                return Thenable.isThenable(v) ? v : {\n                    then: function then(resolve) {\n                        return resolve(v);\n                    }\n                };\n            };\n\n            Thenable.isThenable = isThenable;\n            return Thenable;\n        }();\n\n        $asyncbind.EagerThenable = $asyncbind.Thenable = ($asyncbind.EagerThenableFactory = function (tick) {\n            tick = tick || (typeof process === 'undefined' ? 'undefined' : _typeof(process)) === 'object' && process.nextTick || typeof setImmediate === 'function' && setImmediate || function (f) {\n                setTimeout(f, 0);\n            };\n\n            var soon = function () {\n                var fq = [],\n                    fqStart = 0,\n                    bufferSize = 1024;\n\n                function callQueue() {\n                    while (fq.length - fqStart) {\n                        fq[fqStart]();\n                        fq[fqStart++] = undefined;\n\n                        if (fqStart === bufferSize) {\n                            fq.splice(0, bufferSize);\n                            fqStart = 0;\n                        }\n                    }\n                }\n\n                return function (fn) {\n                    fq.push(fn);\n                    if (fq.length - fqStart === 1) tick(callQueue);\n                };\n            }();\n\n            function Zousan(func) {\n                if (func) {\n                    var me = this;\n                    func(function (arg) {\n                        me.resolve(arg);\n                    }, function (arg) {\n                        me.reject(arg);\n                    });\n                }\n            }\n\n            Zousan.prototype = {\n                resolve: function resolve(value) {\n                    if (this.state !== undefined) return;\n                    if (value === this) return this.reject(new TypeError('Attempt to resolve promise with self'));\n                    var me = this;\n\n                    if (value && (typeof value === 'function' || (typeof value === 'undefined' ? 'undefined' : _typeof(value)) === 'object')) {\n                        try {\n                            var first = 0;\n                            var then = value.then;\n\n                            if (typeof then === 'function') {\n                                then.call(value, function (ra) {\n                                    if (!first++) {\n                                        me.resolve(ra);\n                                    }\n                                }, function (rr) {\n                                    if (!first++) {\n                                        me.reject(rr);\n                                    }\n                                });\n                                return;\n                            }\n                        } catch (e) {\n                            if (!first) this.reject(e);\n                            return;\n                        }\n                    }\n\n                    this.state = STATE_FULFILLED;\n                    this.v = value;\n                    if (me.c) soon(function () {\n                        for (var n = 0, l = me.c.length; n < l; n++) {\n                            STATE_FULFILLED(me.c[n], value);\n                        }\n                    });\n                },\n                reject: function reject(reason) {\n                    if (this.state !== undefined) return;\n                    this.state = STATE_REJECTED;\n                    this.v = reason;\n                    var clients = this.c;\n                    if (clients) soon(function () {\n                        for (var n = 0, l = clients.length; n < l; n++) {\n                            STATE_REJECTED(clients[n], reason);\n                        }\n                    });\n                },\n                then: function then(onF, onR) {\n                    var p = new Zousan();\n                    var client = {\n                        y: onF,\n                        n: onR,\n                        p: p\n                    };\n\n                    if (this.state === undefined) {\n                        if (this.c) this.c.push(client);else this.c = [client];\n                    } else {\n                        var s = this.state,\n                            a = this.v;\n                        soon(function () {\n                            s(client, a);\n                        });\n                    }\n\n                    return p;\n                }\n            };\n\n            function STATE_FULFILLED(c, arg) {\n                if (typeof c.y === 'function') {\n                    try {\n                        var yret = c.y.call(undefined, arg);\n                        c.p.resolve(yret);\n                    } catch (err) {\n                        c.p.reject(err);\n                    }\n                } else c.p.resolve(arg);\n            }\n\n            function STATE_REJECTED(c, reason) {\n                if (typeof c.n === 'function') {\n                    try {\n                        var yret = c.n.call(undefined, reason);\n                        c.p.resolve(yret);\n                    } catch (err) {\n                        c.p.reject(err);\n                    }\n                } else c.p.reject(reason);\n            }\n\n            Zousan.resolve = function (val) {\n                if (val && val instanceof Zousan) return val;\n                var z = new Zousan();\n                z.resolve(val);\n                return z;\n            };\n\n            Zousan.reject = function (err) {\n                if (err && err instanceof Zousan) return err;\n                var z = new Zousan();\n                z.reject(err);\n                return z;\n            };\n\n            Zousan.version = '2.3.2-nodent';\n            return Zousan;\n        })();\n    }\n\n    var resolver = this;\n\n    switch (catcher) {\n        case true:\n            return new $asyncbind.Thenable(boundThen);\n\n        case 0:\n            return new $asyncbind.LazyThenable(boundThen);\n\n        case undefined:\n            boundThen.then = boundThen;\n            return boundThen;\n\n        default:\n            return function () {\n                try {\n                    return resolver.apply(self, arguments);\n                } catch (ex) {\n                    return catcher(ex);\n                }\n            };\n    }\n\n    function boundThen() {\n        return resolver.apply(self, arguments);\n    }\n};\n\nvar _marked = [iterEntities].map(_babelRegeneratorRuntime2.default.mark);\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n// eslint-disable-next-line no-unused-vars\n\n\n/**\n * Validate entity data against a Joi schema, and sanitizes/formats it.\n */\nfunction validateEntity(data, schema) {\n    var result = _schema2.default.validate(data, schema, { convert: false });\n    if (result.error) throw result.error;\n    return data;\n}\n\n/**\n * Get the current state of an entity.\n */\nfunction readEntity(user, entityType, id) {\n    return new Promise(function ($return, $error) {\n        var url, response;\n\n        url = api.getEntityUrl(entityType, id);\n        return user.get(url).then(function ($await_3) {\n            response = $await_3;\n\n            return $return(api.validateResponse(200, response).body);\n        }.$asyncbind(this, $error), $error);\n    }.$asyncbind(this));\n}\n\n/**\n * Update an entity with the given data.\n */\nfunction updateEntity(user, entityType, id, data) {\n    return new Promise(function ($return, $error) {\n        var url, response;\n\n        url = api.getEntityUrl(entityType, id);\n        return user.patch(url, data).then(function ($await_4) {\n            response = $await_4;\n\n            return $return(api.validateResponse(200, response).body);\n        }.$asyncbind(this, $error), $error);\n    }.$asyncbind(this));\n}\n\n/**\n * Create a new Entity.\n */\nfunction createEntity(user, entityType, data) {\n    return new Promise(function ($return, $error) {\n        var url, response;\n\n        url = api.getEntityUrl(entityType);\n        return user.post(url, data).then(function ($await_5) {\n            response = $await_5;\n\n            return $return(api.validateResponse(201, response).body);\n        }.$asyncbind(this, $error), $error);\n    }.$asyncbind(this));\n}\n\n/**\n * Delete an Entity permanently.\n */\nfunction deleteEntity(user, entityType, id) {\n    return new Promise(function ($return, $error) {\n        var url, response;\n\n        url = api.getEntityUrl(entityType, id);\n        return user.del(url).then(function ($await_6) {\n            response = $await_6;\n            api.validateResponse(204, response);\n            return $return();\n        }.$asyncbind(this, $error), $error);\n    }.$asyncbind(this));\n}\n\nfunction _fetchEntities(user, entityType, params) {\n    return new Promise(function ($return, $error) {\n        var url, response;\n\n        url = api.getEntityUrl(entityType, null, params);\n        return user.get(url).then(function ($await_7) {\n            response = $await_7;\n            return $return(api.validateResponse(200, response));\n        }.$asyncbind(this, $error), $error);\n    }.$asyncbind(this));\n}\n\n/**\n * List all the entities of the given type.\n */\nfunction listEntities(user, entityType) {\n    var $args = arguments;return new Promise(function ($return, $error) {\n        var params, resultCount, results, response;\n        params = $args.length > 2 && $args[2] !== undefined ? $args[2] : {};\n\n        resultCount = Infinity;\n        results = [];\n\n        params.limit = 100;\n        params.offset = 0;\n\n        return Function.$asyncbind.trampoline(this, $Loop_1_exit, $Loop_1, $error)($Loop_1);\n        function $Loop_1() {\n            if (params.offset <= resultCount) {\n                return _fetchEntities(user, entityType, params).then(function ($await_8) {\n                    response = $await_8;\n\n                    resultCount = _.toNumber(response.headers.get('x-result-count'));\n                    params.offset += params.limit;\n\n                    results.push.apply(results, _toConsumableArray(response.body));\n                    return $Loop_1;\n                }.$asyncbind(this, $error), $error);\n            } else return [1];\n        }\n\n        function $Loop_1_exit() {\n\n            return $return(results);\n        }\n    }.$asyncbind(this));\n}\n\n/**\n * Iterate over all entities of the given time.\n *\n * You can change the starting point by setting params.offset, and change\n * the chunk size of each fetch with params.limit. Chunk size is 30 by default.\n * Note that editing this will only affect performance.\n */\nfunction iterEntities(user, entityType) {\n    var params = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var allEntities, resultCount, index;\n    return _babelRegeneratorRuntime2.default.wrap(function iterEntities$(_context) {\n        while (1) {\n            switch (_context.prev = _context.next) {\n                case 0:\n                    params.offset = params.offset || 0;\n                    params.limit = params.limit || 30;\n\n                    allEntities = [];\n                    resultCount = Infinity;\n                    index = 0;\n\n                case 5:\n                    if (!(index < resultCount)) {\n                        _context.next = 16;\n                        break;\n                    }\n\n                    if (!(index <= params.offset)) {\n                        _context.next = 11;\n                        break;\n                    }\n\n                    _context.next = 9;\n                    return _fetchEntities(user, entityType, params).then(function (response) {\n                        if (resultCount === Infinity) resultCount = _.toNumber(response.headers.get('x-result-count'));\n\n                        params.offset += params.limit;\n\n                        allEntities.push.apply(allEntities, _toConsumableArray(response.body));\n                        return allEntities[index];\n                    });\n\n                case 9:\n                    _context.next = 13;\n                    break;\n\n                case 11:\n                    _context.next = 13;\n                    return Promise.resolve(allEntities[index]);\n\n                case 13:\n\n                    index += 1;\n                    _context.next = 5;\n                    break;\n\n                case 16:\n                case 'end':\n                    return _context.stop();\n            }\n        }\n    }, _marked[0], this);\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvcmUuanMiXSwibmFtZXMiOlsidmFsaWRhdGVFbnRpdHkiLCJyZWFkRW50aXR5IiwidXBkYXRlRW50aXR5IiwiY3JlYXRlRW50aXR5IiwiZGVsZXRlRW50aXR5IiwibGlzdEVudGl0aWVzIiwiaXRlckVudGl0aWVzIiwiXyIsImFwaSIsImRhdGEiLCJzY2hlbWEiLCJyZXN1bHQiLCJ2YWxpZGF0ZSIsImNvbnZlcnQiLCJlcnJvciIsInVzZXIiLCJlbnRpdHlUeXBlIiwiaWQiLCJ1cmwiLCJnZXRFbnRpdHlVcmwiLCJnZXQiLCJyZXNwb25zZSIsInZhbGlkYXRlUmVzcG9uc2UiLCJib2R5IiwicGF0Y2giLCJwb3N0IiwiZGVsIiwiX2ZldGNoRW50aXRpZXMiLCJwYXJhbXMiLCJyZXN1bHRDb3VudCIsIkluZmluaXR5IiwicmVzdWx0cyIsImxpbWl0Iiwib2Zmc2V0IiwidG9OdW1iZXIiLCJoZWFkZXJzIiwicHVzaCIsImFsbEVudGl0aWVzIiwiaW5kZXgiLCJ0aGVuIiwiUHJvbWlzZSIsInJlc29sdmUiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7UUFzQmdCQSxjLEdBQUFBLGM7UUFhTUMsVSxHQUFBQSxVO1FBY0FDLFksR0FBQUEsWTtRQWVBQyxZLEdBQUFBLFk7UUFjQUMsWSxHQUFBQSxZO1FBdUJBQyxZLEdBQUFBLFk7UUErQkxDLFksR0FBQUEsWTs7QUFsSWpCOzs7O0FBQ0E7O0lBQVlDLEM7O0FBYVo7O0lBQVlDLEc7O0FBQ1o7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7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Q1ksTUFBakMsRUFDRFcsSUFEQyxDQUNJLFVBQUNsQixRQUFELEVBQWM7QUFDaEIsNEJBQUlRLGdCQUFnQkMsUUFBcEIsRUFDSUQsY0FBY3RCLEVBQUUyQixRQUFGLENBQ1ZiLFNBQVNjLE9BQVQsQ0FBaUJmLEdBQWpCLENBQXFCLGdCQUFyQixDQURVLENBQWQ7O0FBR0pRLCtCQUFPSyxNQUFQLElBQWlCTCxPQUFPSSxLQUF4Qjs7QUFFQUssb0NBQVlELElBQVosdUNBQW9CZixTQUFTRSxJQUE3QjtBQUNBLCtCQUFPYyxZQUFZQyxLQUFaLENBQVA7QUFDSCxxQkFWQyxDQWRYOztBQUFBO0FBQUE7QUFBQTs7QUFBQTtBQUFBO0FBQUEsMkJBMEJXRSxRQUFRQyxPQUFSLENBQWdCSixZQUFZQyxLQUFaLENBQWhCLENBMUJYOztBQUFBOztBQTZCQ0EsNkJBQVMsQ0FBVDtBQTdCRDtBQUFBOztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBIiwiZmlsZSI6ImNvcmUuanMiLCJzb3VyY2VSb290IjoiL1VzZXJzL2R0ci9nb29lZS9lY21hc2NyaXB0LXNkay9zcmMvZW50aXRpZXMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiBAZmxvdyAqL1xuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXVudXNlZC12YXJzXG5pbXBvcnQgcmVnZW5lcmF0b3JSdW50aW1lIGZyb20gJ2JhYmVsLXJlZ2VuZXJhdG9yLXJ1bnRpbWUnXG5pbXBvcnQgKiBhcyBfIGZyb20gJ2xvZGFzaCdcblxuaW1wb3J0IHR5cGUge1xuICAgIEVudGl0eUpzb24sXG4gICAgRW50aXR5UmVzcG9uc2UsXG4gICAgRW50aXR5U2NoZW1hLFxuICAgIEVudGl0eVR5cGUsXG4gICAgSnNvbk9iamVjdCxcbiAgICBKc29uUmVzcG9uc2UsXG4gICAgUXVlcnlQYXJhbXMsXG59IGZyb20gJy4uL3R5cGVzJ1xuaW1wb3J0IHR5cGUgVXNlciBmcm9tICcuLi9hdXRoJ1xuXG5pbXBvcnQgKiBhcyBhcGkgZnJvbSAnLi4vYXBpJ1xuaW1wb3J0IEpvaSBmcm9tICAnLi4vc2NoZW1hJ1xuXG4vKipcbiAqIFZhbGlkYXRlIGVudGl0eSBkYXRhIGFnYWluc3QgYSBKb2kgc2NoZW1hLCBhbmQgc2FuaXRpemVzL2Zvcm1hdHMgaXQuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZUVudGl0eShcbiAgICBkYXRhOiBFbnRpdHlKc29uLFxuICAgIHNjaGVtYTogRW50aXR5U2NoZW1hXG4pOiBFbnRpdHlKc29uIHtcbiAgICBjb25zdCByZXN1bHQgPSBKb2kudmFsaWRhdGUoZGF0YSwgc2NoZW1hLCB7IGNvbnZlcnQ6IGZhbHNlIH0pXG4gICAgaWYgKHJlc3VsdC5lcnJvcilcbiAgICAgICAgdGhyb3cgcmVzdWx0LmVycm9yXG4gICAgcmV0dXJuIGRhdGFcbn1cblxuLyoqXG4gKiBHZXQgdGhlIGN1cnJlbnQgc3RhdGUgb2YgYW4gZW50aXR5LlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVhZEVudGl0eShcbiAgICB1c2VyOiBVc2VyLFxuICAgIGVudGl0eVR5cGU6IEVudGl0eVR5cGUsXG4gICAgaWQ6IHN0cmluZ1xuKTogUHJvbWlzZTxFbnRpdHlKc29uPiB7XG4gICAgY29uc3QgdXJsID0gYXBpLmdldEVudGl0eVVybChlbnRpdHlUeXBlLCBpZClcbiAgICBjb25zdCByZXNwb25zZTogRW50aXR5UmVzcG9uc2UgPSBhd2FpdCB1c2VyLmdldCh1cmwpXG5cbiAgICByZXR1cm4gYXBpLnZhbGlkYXRlUmVzcG9uc2UoMjAwLCByZXNwb25zZSkuYm9keVxufVxuXG4vKipcbiAqIFVwZGF0ZSBhbiBlbnRpdHkgd2l0aCB0aGUgZ2l2ZW4gZGF0YS5cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUVudGl0eShcbiAgICB1c2VyOiBVc2VyLFxuICAgIGVudGl0eVR5cGU6IEVudGl0eVR5cGUsXG4gICAgaWQ6IHN0cmluZyxcbiAgICBkYXRhOiBKc29uT2JqZWN0XG4pOiBQcm9taXNlPEVudGl0eUpzb24+IHtcbiAgICBjb25zdCB1cmwgPSBhcGkuZ2V0RW50aXR5VXJsKGVudGl0eVR5cGUsIGlkKVxuICAgIGNvbnN0IHJlc3BvbnNlOiBFbnRpdHlSZXNwb25zZSA9IGF3YWl0IHVzZXIucGF0Y2godXJsLCBkYXRhKVxuXG4gICAgcmV0dXJuIGFwaS52YWxpZGF0ZVJlc3BvbnNlKDIwMCwgcmVzcG9uc2UpLmJvZHlcbn1cblxuLyoqXG4gKiBDcmVhdGUgYSBuZXcgRW50aXR5LlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlRW50aXR5KFxuICB1c2VyOiBVc2VyLFxuICBlbnRpdHlUeXBlOiBFbnRpdHlUeXBlLFxuICBkYXRhOiBKc29uT2JqZWN0XG4pOiBQcm9taXNlPEVudGl0eUpzb24+IHtcbiAgICBjb25zdCB1cmwgPSBhcGkuZ2V0RW50aXR5VXJsKGVudGl0eVR5cGUpXG4gICAgY29uc3QgcmVzcG9uc2U6IEVudGl0eVJlc3BvbnNlID0gYXdhaXQgdXNlci5wb3N0KHVybCwgZGF0YSlcblxuICAgIHJldHVybiBhcGkudmFsaWRhdGVSZXNwb25zZSgyMDEsIHJlc3BvbnNlKS5ib2R5XG59XG5cbi8qKlxuICogRGVsZXRlIGFuIEVudGl0eSBwZXJtYW5lbnRseS5cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZUVudGl0eShcbiAgICB1c2VyOiBVc2VyLFxuICAgIGVudGl0eVR5cGU6IEVudGl0eVR5cGUsXG4gICAgaWQ6IHN0cmluZ1xuKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgdXJsID0gYXBpLmdldEVudGl0eVVybChlbnRpdHlUeXBlLCBpZClcbiAgICBjb25zdCByZXNwb25zZTogSnNvblJlc3BvbnNlID0gYXdhaXQgdXNlci5kZWwodXJsKVxuICAgIGFwaS52YWxpZGF0ZVJlc3BvbnNlKDIwNCwgcmVzcG9uc2UpXG59XG5cbmFzeW5jIGZ1bmN0aW9uIF9mZXRjaEVudGl0aWVzKFxuICAgIHVzZXI6IFVzZXIsXG4gICAgZW50aXR5VHlwZTogRW50aXR5VHlwZSxcbiAgICBwYXJhbXM6IFF1ZXJ5UGFyYW1zXG4pOiBQcm9taXNlPEpzb25SZXNwb25zZT4ge1xuICAgIGNvbnN0IHVybCA9IGFwaS5nZXRFbnRpdHlVcmwoZW50aXR5VHlwZSwgbnVsbCwgcGFyYW1zKVxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdXNlci5nZXQodXJsKVxuICAgIHJldHVybiBhcGkudmFsaWRhdGVSZXNwb25zZSgyMDAsIHJlc3BvbnNlKVxufVxuXG4vKipcbiAqIExpc3QgYWxsIHRoZSBlbnRpdGllcyBvZiB0aGUgZ2l2ZW4gdHlwZS5cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxpc3RFbnRpdGllcyhcbiAgdXNlcjogVXNlcixcbiAgZW50aXR5VHlwZTogRW50aXR5VHlwZSxcbiAgcGFyYW1zOiBRdWVyeVBhcmFtcyA9IHt9XG4pOiBQcm9taXNlPEVudGl0eUpzb25bXT4ge1xuICAgIGxldCByZXN1bHRDb3VudCA9IEluZmluaXR5XG4gICAgY29uc3QgcmVzdWx0cyA9IFtdXG5cbiAgICBwYXJhbXMubGltaXQgPSAxMDBcbiAgICBwYXJhbXMub2Zmc2V0ID0gMFxuXG4gICAgd2hpbGUgKHBhcmFtcy5vZmZzZXQgPD0gcmVzdWx0Q291bnQpIHtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPVxuICAgICAgICAgICAgYXdhaXQgX2ZldGNoRW50aXRpZXModXNlciwgZW50aXR5VHlwZSwgcGFyYW1zKVxuXG4gICAgICAgIHJlc3VsdENvdW50ID0gXy50b051bWJlcihyZXNwb25zZS5oZWFkZXJzLmdldCgneC1yZXN1bHQtY291bnQnKSlcbiAgICAgICAgcGFyYW1zLm9mZnNldCArPSBwYXJhbXMubGltaXRcblxuICAgICAgICByZXN1bHRzLnB1c2goLi4ucmVzcG9uc2UuYm9keSlcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzdWx0c1xufVxuXG4vKipcbiAqIEl0ZXJhdGUgb3ZlciBhbGwgZW50aXRpZXMgb2YgdGhlIGdpdmVuIHRpbWUuXG4gKlxuICogWW91IGNhbiBjaGFuZ2UgdGhlIHN0YXJ0aW5nIHBvaW50IGJ5IHNldHRpbmcgcGFyYW1zLm9mZnNldCwgYW5kIGNoYW5nZVxuICogdGhlIGNodW5rIHNpemUgb2YgZWFjaCBmZXRjaCB3aXRoIHBhcmFtcy5saW1pdC4gQ2h1bmsgc2l6ZSBpcyAzMCBieSBkZWZhdWx0LlxuICogTm90ZSB0aGF0IGVkaXRpbmcgdGhpcyB3aWxsIG9ubHkgYWZmZWN0IHBlcmZvcm1hbmNlLlxuICovXG5leHBvcnQgZnVuY3Rpb24qIGl0ZXJFbnRpdGllcyhcbiAgICB1c2VyOiBVc2VyLFxuICAgIGVudGl0eVR5cGU6IEVudGl0eVR5cGUsXG4gICAgcGFyYW1zOiBRdWVyeVBhcmFtcyA9IHt9XG4pOiBJdGVyYXRvcjxQcm9taXNlPEVudGl0eUpzb24+PiB7XG4gICAgcGFyYW1zLm9mZnNldCA9IHBhcmFtcy5vZmZzZXQgfHwgMFxuICAgIHBhcmFtcy5saW1pdCA9IHBhcmFtcy5saW1pdCB8fCAzMFxuXG4gICAgY29uc3QgYWxsRW50aXRpZXMgPSBbXVxuICAgIGxldCByZXN1bHRDb3VudCA9IEluZmluaXR5XG4gICAgbGV0IGluZGV4ID0gMFxuXG4gICAgd2hpbGUgKGluZGV4IDwgcmVzdWx0Q291bnQpIHtcbiAgICAgICAgaWYgKGluZGV4IDw9IHBhcmFtcy5vZmZzZXQpIHtcbiAgICAgICAgICAgIHlpZWxkIF9mZXRjaEVudGl0aWVzKHVzZXIsIGVudGl0eVR5cGUsIHBhcmFtcylcbiAgICAgICAgICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdENvdW50ID09PSBJbmZpbml0eSlcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdENvdW50ID0gXy50b051bWJlcihcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNwb25zZS5oZWFkZXJzLmdldCgneC1yZXN1bHQtY291bnQnKSlcblxuICAgICAgICAgICAgICAgICAgICBwYXJhbXMub2Zmc2V0ICs9IHBhcmFtcy5saW1pdFxuXG4gICAgICAgICAgICAgICAgICAgIGFsbEVudGl0aWVzLnB1c2goLi4ucmVzcG9uc2UuYm9keSlcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFsbEVudGl0aWVzW2luZGV4XVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB5aWVsZCBQcm9taXNlLnJlc29sdmUoYWxsRW50aXRpZXNbaW5kZXhdKVxuICAgICAgICB9XG5cbiAgICAgICAgaW5kZXggKz0gMVxuICAgIH1cbn1cbiJdfQ==",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "core.js"
      ],
      "names": [
        "validateEntity",
        "readEntity",
        "updateEntity",
        "createEntity",
        "deleteEntity",
        "listEntities",
        "iterEntities",
        "_",
        "api",
        "data",
        "schema",
        "result",
        "validate",
        "convert",
        "error",
        "user",
        "entityType",
        "id",
        "url",
        "getEntityUrl",
        "get",
        "response",
        "validateResponse",
        "body",
        "patch",
        "post",
        "del",
        "_fetchEntities",
        "params",
        "resultCount",
        "Infinity",
        "results",
        "limit",
        "offset",
        "toNumber",
        "headers",
        "push",
        "allEntities",
        "index",
        "then",
        "Promise",
        "resolve"
      ],
      "mappings": "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",
      "file": "core.js",
      "sourceRoot": "/Users/dtr/gooee/ecmascript-sdk/src/entities",
      "sourcesContent": [
        "/* @flow */\n// eslint-disable-next-line no-unused-vars\nimport regeneratorRuntime from 'babel-regenerator-runtime'\nimport * as _ from 'lodash'\n\nimport type {\n    EntityJson,\n    EntityResponse,\n    EntitySchema,\n    EntityType,\n    JsonObject,\n    JsonResponse,\n    QueryParams,\n} from '../types'\nimport type User from '../auth'\n\nimport * as api from '../api'\nimport Joi from  '../schema'\n\n/**\n * Validate entity data against a Joi schema, and sanitizes/formats it.\n */\nexport function validateEntity(\n    data: EntityJson,\n    schema: EntitySchema\n): EntityJson {\n    const result = Joi.validate(data, schema, { convert: false })\n    if (result.error)\n        throw result.error\n    return data\n}\n\n/**\n * Get the current state of an entity.\n */\nexport async function readEntity(\n    user: User,\n    entityType: EntityType,\n    id: string\n): Promise<EntityJson> {\n    const url = api.getEntityUrl(entityType, id)\n    const response: EntityResponse = await user.get(url)\n\n    return api.validateResponse(200, response).body\n}\n\n/**\n * Update an entity with the given data.\n */\nexport async function updateEntity(\n    user: User,\n    entityType: EntityType,\n    id: string,\n    data: JsonObject\n): Promise<EntityJson> {\n    const url = api.getEntityUrl(entityType, id)\n    const response: EntityResponse = await user.patch(url, data)\n\n    return api.validateResponse(200, response).body\n}\n\n/**\n * Create a new Entity.\n */\nexport async function createEntity(\n  user: User,\n  entityType: EntityType,\n  data: JsonObject\n): Promise<EntityJson> {\n    const url = api.getEntityUrl(entityType)\n    const response: EntityResponse = await user.post(url, data)\n\n    return api.validateResponse(201, response).body\n}\n\n/**\n * Delete an Entity permanently.\n */\nexport async function deleteEntity(\n    user: User,\n    entityType: EntityType,\n    id: string\n): Promise<void> {\n    const url = api.getEntityUrl(entityType, id)\n    const response: JsonResponse = await user.del(url)\n    api.validateResponse(204, response)\n}\n\nasync function _fetchEntities(\n    user: User,\n    entityType: EntityType,\n    params: QueryParams\n): Promise<JsonResponse> {\n    const url = api.getEntityUrl(entityType, null, params)\n    const response = await user.get(url)\n    return api.validateResponse(200, response)\n}\n\n/**\n * List all the entities of the given type.\n */\nexport async function listEntities(\n  user: User,\n  entityType: EntityType,\n  params: QueryParams = {}\n): Promise<EntityJson[]> {\n    let resultCount = Infinity\n    const results = []\n\n    params.limit = 100\n    params.offset = 0\n\n    while (params.offset <= resultCount) {\n        const response =\n            await _fetchEntities(user, entityType, params)\n\n        resultCount = _.toNumber(response.headers.get('x-result-count'))\n        params.offset += params.limit\n\n        results.push(...response.body)\n    }\n\n    return results\n}\n\n/**\n * Iterate over all entities of the given time.\n *\n * You can change the starting point by setting params.offset, and change\n * the chunk size of each fetch with params.limit. Chunk size is 30 by default.\n * Note that editing this will only affect performance.\n */\nexport function* iterEntities(\n    user: User,\n    entityType: EntityType,\n    params: QueryParams = {}\n): Iterator<Promise<EntityJson>> {\n    params.offset = params.offset || 0\n    params.limit = params.limit || 30\n\n    const allEntities = []\n    let resultCount = Infinity\n    let index = 0\n\n    while (index < resultCount) {\n        if (index <= params.offset) {\n            yield _fetchEntities(user, entityType, params)\n                .then((response) => {\n                    if (resultCount === Infinity)\n                        resultCount = _.toNumber(\n                            response.headers.get('x-result-count'))\n\n                    params.offset += params.limit\n\n                    allEntities.push(...response.body)\n                    return allEntities[index]\n                })\n        } else {\n            yield Promise.resolve(allEntities[index])\n        }\n\n        index += 1\n    }\n}\n"
      ]
    },
    "mtime": 1476984416000
  },
  "{\"filename\":\"/Users/dtr/gooee/ecmascript-sdk/src/schema.js\",\"env\":{},\"retainLines\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"presets\":[],\"plugins\":[[[],null],[[],null],[[],null],[[],{\"loose\":false,\"spec\":false}],[[],null],[[],null],[[],{\"spec\":false}],[[],null],[[],{\"loose\":false}],[[],null],[[],null],[[],null],[[],{\"loose\":false}],[[],{\"loose\":false}],[[],null],[[],null],[[],null],[[],{\"loose\":false}],[[],null],[[],{\"loose\":false}],[[],null],[[],null],[[],{\"loose\":false}],[[],{\"async\":false,\"asyncGenerators\":false}]],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"minified\":false,\"sourceRoot\":\"/Users/dtr/gooee/ecmascript-sdk/src\",\"babelrc\":true,\"sourceType\":\"module\",\"moduleIds\":false,\"passPerPreset\":false,\"parserOpts\":false,\"generatorOpts\":false}:6.17.0": {
    "metadata": {
      "usedHelpers": [
        "interopRequireDefault"
      ],
      "marked": [],
      "modules": {
        "imports": [
          {
            "source": "joi-dataURI",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "Joi_dataURI"
              }
            ]
          }
        ],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      }
    },
    "options": {
      "filename": "/Users/dtr/gooee/ecmascript-sdk/src/schema.js",
      "filenameRelative": "/Users/dtr/gooee/ecmascript-sdk/src/schema.js",
      "env": {},
      "retainLines": false,
      "highlightCode": true,
      "suppressDeprecationMessages": false,
      "presets": [],
      "plugins": [
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false,
            "spec": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "spec": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          {
            "async": false,
            "asyncGenerators": false
          }
        ]
      ],
      "ignore": [],
      "code": true,
      "metadata": true,
      "ast": false,
      "comments": true,
      "compact": "auto",
      "minified": false,
      "sourceMaps": "both",
      "sourceMapTarget": "schema.js",
      "sourceFileName": "schema.js",
      "sourceRoot": "/Users/dtr/gooee/ecmascript-sdk/src",
      "babelrc": false,
      "sourceType": "module",
      "moduleRoot": "/Users/dtr/gooee/ecmascript-sdk/src",
      "moduleIds": false,
      "passPerPreset": false,
      "parserOpts": false,
      "generatorOpts": false,
      "basename": "schema"
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _joiDataURI = require('joi-dataURI');\n\nvar _joiDataURI2 = _interopRequireDefault(_joiDataURI);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar Joi = (0, _joiDataURI2.default)();\n\nJoi.uuidArray = function () {\n    return Joi.array().items(Joi.string().uuid());\n};\nJoi.base64Image = function () {\n    return Joi.dataURI().base64().mediatype('text/plain');\n};\nJoi.tagsArray = function () {\n    return Joi.array().items(Joi.string().max(50)).allow(null);\n};\n\nJoi.commissionState = function () {\n    return Joi.string().only('pending', 'provisioned', 'site_provisioned', 'commissioned');\n};\n\n// Schema for location data.\nJoi.locationObject = function () {\n    return Joi.object().keys({\n        // TODO: is any of this required? docs don't say\n        addr1: Joi.string().max(100),\n        addr2: Joi.string().max(100), // TODO: required?\n        city: Joi.string().max(100),\n        state: Joi.string().max(100),\n        postal_code: Joi.string().max(50),\n        country: Joi.string().max(100),\n        country_code: Joi.string().length(2),\n        phone_number: Joi.string().max(20),\n        district: Joi.string().max(100),\n        lat: Joi.number(),\n        lng: Joi.number()\n    });\n};\n\n// Count object schema, used in fields like 'deviceCount'.\nJoi.countObject = function () {\n    return Joi.object().keys({\n        total: Joi.number().integer().min(0),\n        online: Joi.number().integer().min(0)\n    });\n};\n\n// Base schema for entity Meta.\nJoi.baseMeta = function () {\n    return Joi.object().keys({\n        name: Joi.string().empty(null),\n        display_name: Joi.string().empty(null),\n        value: Joi.any().not(null).required(),\n        // TODO: only available on certain objects (docs are vague)\n        groups: Joi.array().items(Joi.string()),\n        unit_of_measure: Joi.string().allow(null),\n        modified: Joi.string()\n    }).or('name', 'display_name');\n};\n\n// Product Meta schema.\nJoi.productMeta = function () {\n    return Joi.baseMeta().keys({\n        inheritance_type: Joi.string().only('none', 'aggregation')\n    });\n};\n\n// Base schema for \"object\" entities, i.e. those with a UUID, created/modified\n// dates, name, and description.\nJoi.baseObjectEntity = function () {\n    return Joi.object().keys({\n        id: Joi.string().uuid().required(),\n        // TODO: parse these into real dates (with momentjs)\n        created: Joi.string(),\n        modified: Joi.string(),\n        name: Joi.string().max(100).required(),\n        description: Joi.string().allow('')\n    });\n};\n\n// Base schema for entities in the logical chain -- Customer, Building, Space.\n// Connected Products are not included.\nJoi.logicalEntity = function () {\n    return Joi.baseObjectEntity().keys({\n        device_count: Joi.countObject(),\n        gateway_count: Joi.countObject(),\n        micro_gateway_count: Joi.countObject(),\n        scope_context: Joi.string().max(32),\n        data_service_id: Joi.string().allow(null),\n        tags: Joi.tagsArray()\n    });\n};\n\nexports.default = Joi;\nmodule.exports = exports['default'];\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjaGVtYS5qcyJdLCJuYW1lcyI6WyJKb2kiLCJ1dWlkQXJyYXkiLCJhcnJheSIsIml0ZW1zIiwic3RyaW5nIiwidXVpZCIsImJhc2U2NEltYWdlIiwiZGF0YVVSSSIsImJhc2U2NCIsIm1lZGlhdHlwZSIsInRhZ3NBcnJheSIsIm1heCIsImFsbG93IiwiY29tbWlzc2lvblN0YXRlIiwib25seSIsImxvY2F0aW9uT2JqZWN0Iiwib2JqZWN0Iiwia2V5cyIsImFkZHIxIiwiYWRkcjIiLCJjaXR5Iiwic3RhdGUiLCJwb3N0YWxfY29kZSIsImNvdW50cnkiLCJjb3VudHJ5X2NvZGUiLCJsZW5ndGgiLCJwaG9uZV9udW1iZXIiLCJkaXN0cmljdCIsImxhdCIsIm51bWJlciIsImxuZyIsImNvdW50T2JqZWN0IiwidG90YWwiLCJpbnRlZ2VyIiwibWluIiwib25saW5lIiwiYmFzZU1ldGEiLCJuYW1lIiwiZW1wdHkiLCJkaXNwbGF5X25hbWUiLCJ2YWx1ZSIsImFueSIsIm5vdCIsInJlcXVpcmVkIiwiZ3JvdXBzIiwidW5pdF9vZl9tZWFzdXJlIiwibW9kaWZpZWQiLCJvciIsInByb2R1Y3RNZXRhIiwiaW5oZXJpdGFuY2VfdHlwZSIsImJhc2VPYmplY3RFbnRpdHkiLCJpZCIsImNyZWF0ZWQiLCJkZXNjcmlwdGlvbiIsImxvZ2ljYWxFbnRpdHkiLCJkZXZpY2VfY291bnQiLCJnYXRld2F5X2NvdW50IiwibWljcm9fZ2F0ZXdheV9jb3VudCIsInNjb3BlX2NvbnRleHQiLCJkYXRhX3NlcnZpY2VfaWQiLCJ0YWdzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTs7Ozs7O0FBQ0EsSUFBTUEsTUFBTSwyQkFBWjs7QUFFQUEsSUFBSUMsU0FBSixHQUFnQjtBQUFBLFdBQU1ELElBQUlFLEtBQUosR0FBWUMsS0FBWixDQUFrQkgsSUFBSUksTUFBSixHQUFhQyxJQUFiLEVBQWxCLENBQU47QUFBQSxDQUFoQjtBQUNBTCxJQUFJTSxXQUFKLEdBQWtCO0FBQUEsV0FBTU4sSUFB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TUFBbEIsRUFBMEIsYUFBMUI7QUFESyxLQUFwQixDQUFQO0FBR0gsQ0FKRDs7QUFNQTtBQUNBO0FBQ0FkLElBQUlrRCxnQkFBSixHQUF1QixZQUFNO0FBQ3pCLFdBQU9sRCxJQUFJZ0IsTUFBSixHQUFhQyxJQUFiLENBQWtCO0FBQ3JCa0MsWUFBSW5ELElBQUlJLE1BQUosR0FBYUMsSUFBYixHQUFvQnNDLFFBQXBCLEVBRGlCO0FBRXJCO0FBQ0FTLGlCQUFTcEQsSUFBSUksTUFBSixFQUhZO0FBSXJCMEMsa0JBQVU5QyxJQUFJSSxNQUFKLEVBSlc7QUFLckJpQyxjQUFNckMsSUFBSUksTUFBSixHQUFhTyxHQUFiLENBQWlCLEdBQWpCLEVBQXNCZ0MsUUFBdEIsRUFMZTtBQU1yQlUscUJBQWFyRCxJQUFJSSxNQUFKLEdBQWFRLEtBQWIsQ0FBbUIsRUFBbkI7QUFOUSxLQUFsQixDQUFQO0FBUUgsQ0FURDs7QUFXQTtBQUNBO0FBQ0FaLElBQUlzRCxhQUFKLEdBQW9CLFlBQU07QUFDdEIsV0FBT3RELElBQUlrRCxnQkFBSixHQUF1QmpDLElBQXZCLENBQTRCO0FBQy9Cc0Msc0JBQWN2RCxJQUFJK0IsV0FBSixFQURpQjtBQUUvQnlCLHVCQUFleEQsSUFBSStCLFdBQUosRUFGZ0I7QUFHL0IwQiw2QkFBcUJ6RCxJQUFJK0IsV0FBSixFQUhVO0FBSS9CMkIsdUJBQWUxRCxJQUFJSSxNQUFKLEdBQWFPLEdBQWIsQ0FBaUIsRUFBakIsQ0FKZ0I7QUFLL0JnRCx5QkFBaUIzRCxJQUFJSSxNQUFKLEdBQWFRLEtBQWIsQ0FBbUIsSUFBbkIsQ0FMYztBQU0vQmdELGNBQU01RCxJQUFJVSxTQUFKO0FBTnlCLEtBQTVCLENBQVA7QUFTSCxDQVZEOztrQkFZZVYsRyIsImZpbGUiOiJzY2hlbWEuanMiLCJzb3VyY2VSb290IjoiL1VzZXJzL2R0ci9nb29lZS9lY21hc2NyaXB0LXNkay9zcmMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgSm9pX2RhdGFVUkkgZnJvbSAnam9pLWRhdGFVUkknXG5jb25zdCBKb2kgPSBKb2lfZGF0YVVSSSgpXG5cbkpvaS51dWlkQXJyYXkgPSAoKSA9PiBKb2kuYXJyYXkoKS5pdGVtcyhKb2kuc3RyaW5nKCkudXVpZCgpKVxuSm9pLmJhc2U2NEltYWdlID0gKCkgPT4gSm9pLmRhdGFVUkkoKS5iYXNlNjQoKS5tZWRpYXR5cGUoJ3RleHQvcGxhaW4nKVxuSm9pLnRhZ3NBcnJheSA9ICgpID0+IEpvaS5hcnJheSgpLml0ZW1zKEpvaS5zdHJpbmcoKS5tYXgoNTApKS5hbGxvdyhudWxsKVxuXG5Kb2kuY29tbWlzc2lvblN0YXRlID0gKCkgPT4gSm9pLnN0cmluZygpLm9ubHkoXG4gICAgJ3BlbmRpbmcnLCAncHJvdmlzaW9uZWQnLCAnc2l0ZV9wcm92aXNpb25lZCcsICdjb21taXNzaW9uZWQnKVxuXG4vLyBTY2hlbWEgZm9yIGxvY2F0aW9uIGRhdGEuXG5Kb2kubG9jYXRpb25PYmplY3QgPSAoKSA9PiB7XG4gICAgcmV0dXJuIEpvaS5vYmplY3QoKS5rZXlzKHtcbiAgICAgICAgLy8gVE9ETzogaXMgYW55IG9mIHRoaXMgcmVxdWlyZWQ/IGRvY3MgZG9uJ3Qgc2F5XG4gICAgICAgIGFkZHIxOiBKb2kuc3RyaW5nKCkubWF4KDEwMCksXG4gICAgICAgIGFkZHIyOiBKb2kuc3RyaW5nKCkubWF4KDEwMCksIC8vIFRPRE86IHJlcXVpcmVkP1xuICAgICAgICBjaXR5OiBKb2kuc3RyaW5nKCkubWF4KDEwMCksXG4gICAgICAgIHN0YXRlOiBKb2kuc3RyaW5nKCkubWF4KDEwMCksXG4gICAgICAgIHBvc3RhbF9jb2RlOiBKb2kuc3RyaW5nKCkubWF4KDUwKSxcbiAgICAgICAgY291bnRyeTogSm9pLnN0cmluZygpLm1heCgxMDApLFxuICAgICAgICBjb3VudHJ5X2NvZGU6IEpvaS5zdHJpbmcoKS5sZW5ndGgoMiksXG4gICAgICAgIHBob25lX251bWJlcjogSm9pLnN0cmluZygpLm1heCgyMCksXG4gICAgICAgIGRpc3RyaWN0OiBKb2kuc3RyaW5nKCkubWF4KDEwMCksXG4gICAgICAgIGxhdDogSm9pLm51bWJlcigpLFxuICAgICAgICBsbmc6IEpvaS5udW1iZXIoKSxcbiAgICB9KVxufVxuXG4vLyBDb3VudCBvYmplY3Qgc2NoZW1hLCB1c2VkIGluIGZpZWxkcyBsaWtlICdkZXZpY2VDb3VudCcuXG5Kb2kuY291bnRPYmplY3QgPSAoKSA9PiB7XG4gICAgcmV0dXJuIEpvaS5vYmplY3QoKS5rZXlzKHtcbiAgICAgICAgdG90YWw6IEpvaS5udW1iZXIoKS5pbnRlZ2VyKCkubWluKDApLFxuICAgICAgICBvbmxpbmU6IEpvaS5udW1iZXIoKS5pbnRlZ2VyKCkubWluKDApLFxuICAgIH0pXG59XG5cbi8vIEJhc2Ugc2NoZW1hIGZvciBlbnRpdHkgTWV0YS5cbkpvaS5iYXNlTWV0YSA9ICgpID0+IHtcbiAgICByZXR1cm4gSm9pLm9iamVjdCgpLmtleXMoe1xuICAgICAgICBuYW1lOiBKb2kuc3RyaW5nKCkuZW1wdHkobnVsbCksXG4gICAgICAgIGRpc3BsYXlfbmFtZTogSm9pLnN0cmluZygpLmVtcHR5KG51bGwpLFxuICAgICAgICB2YWx1ZTogSm9pLmFueSgpLm5vdChudWxsKS5yZXF1aXJlZCgpLFxuICAgICAgICAvLyBUT0RPOiBvbmx5IGF2YWlsYWJsZSBvbiBjZXJ0YWluIG9iamVjdHMgKGRvY3MgYXJlIHZhZ3VlKVxuICAgICAgICBncm91cHM6IEpvaS5hcnJheSgpLml0ZW1zKEpvaS5zdHJpbmcoKSksXG4gICAgICAgIHVuaXRfb2ZfbWVhc3VyZTogSm9pLnN0cmluZygpLmFsbG93KG51bGwpLFxuICAgICAgICBtb2RpZmllZDogSm9pLnN0cmluZygpLFxuICAgIH0pLm9yKCduYW1lJywgJ2Rpc3BsYXlfbmFtZScpXG59XG5cbi8vIFByb2R1Y3QgTWV0YSBzY2hlbWEuXG5Kb2kucHJvZHVjdE1ldGEgPSAoKSA9PiB7XG4gICAgcmV0dXJuIEpvaS5iYXNlTWV0YSgpLmtleXMoe1xuICAgICAgICBpbmhlcml0YW5jZV90eXBlOiBKb2kuc3RyaW5nKCkub25seSgnbm9uZScsICdhZ2dyZWdhdGlvbicpLFxuICAgIH0pXG59XG5cbi8vIEJhc2Ugc2NoZW1hIGZvciBcIm9iamVjdFwiIGVudGl0aWVzLCBpLmUuIHRob3NlIHdpdGggYSBVVUlELCBjcmVhdGVkL21vZGlmaWVkXG4vLyBkYXRlcywgbmFtZSwgYW5kIGRlc2NyaXB0aW9uLlxuSm9pLmJhc2VPYmplY3RFbnRpdHkgPSAoKSA9PiB7XG4gICAgcmV0dXJuIEpvaS5vYmplY3QoKS5rZXlzKHtcbiAgICAgICAgaWQ6IEpvaS5zdHJpbmcoKS51dWlkKCkucmVxdWlyZWQoKSxcbiAgICAgICAgLy8gVE9ETzogcGFyc2UgdGhlc2UgaW50byByZWFsIGRhdGVzICh3aXRoIG1vbWVudGpzKVxuICAgICAgICBjcmVhdGVkOiBKb2kuc3RyaW5nKCksXG4gICAgICAgIG1vZGlmaWVkOiBKb2kuc3RyaW5nKCksXG4gICAgICAgIG5hbWU6IEpvaS5zdHJpbmcoKS5tYXgoMTAwKS5yZXF1aXJlZCgpLFxuICAgICAgICBkZXNjcmlwdGlvbjogSm9pLnN0cmluZygpLmFsbG93KCcnKSxcbiAgICB9KVxufVxuXG4vLyBCYXNlIHNjaGVtYSBmb3IgZW50aXRpZXMgaW4gdGhlIGxvZ2ljYWwgY2hhaW4gLS0gQ3VzdG9tZXIsIEJ1aWxkaW5nLCBTcGFjZS5cbi8vIENvbm5lY3RlZCBQcm9kdWN0cyBhcmUgbm90IGluY2x1ZGVkLlxuSm9pLmxvZ2ljYWxFbnRpdHkgPSAoKSA9PiB7XG4gICAgcmV0dXJuIEpvaS5iYXNlT2JqZWN0RW50aXR5KCkua2V5cyh7XG4gICAgICAgIGRldmljZV9jb3VudDogSm9pLmNvdW50T2JqZWN0KCksXG4gICAgICAgIGdhdGV3YXlfY291bnQ6IEpvaS5jb3VudE9iamVjdCgpLFxuICAgICAgICBtaWNyb19nYXRld2F5X2NvdW50OiBKb2kuY291bnRPYmplY3QoKSxcbiAgICAgICAgc2NvcGVfY29udGV4dDogSm9pLnN0cmluZygpLm1heCgzMiksXG4gICAgICAgIGRhdGFfc2VydmljZV9pZDogSm9pLnN0cmluZygpLmFsbG93KG51bGwpLFxuICAgICAgICB0YWdzOiBKb2kudGFnc0FycmF5KCksXG4gICAgfSlcblxufVxuXG5leHBvcnQgZGVmYXVsdCBKb2lcbiJdfQ==",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "schema.js"
      ],
      "names": [
        "Joi",
        "uuidArray",
        "array",
        "items",
        "string",
        "uuid",
        "base64Image",
        "dataURI",
        "base64",
        "mediatype",
        "tagsArray",
        "max",
        "allow",
        "commissionState",
        "only",
        "locationObject",
        "object",
        "keys",
        "addr1",
        "addr2",
        "city",
        "state",
        "postal_code",
        "country",
        "country_code",
        "length",
        "phone_number",
        "district",
        "lat",
        "number",
        "lng",
        "countObject",
        "total",
        "integer",
        "min",
        "online",
        "baseMeta",
        "name",
        "empty",
        "display_name",
        "value",
        "any",
        "not",
        "required",
        "groups",
        "unit_of_measure",
        "modified",
        "or",
        "productMeta",
        "inheritance_type",
        "baseObjectEntity",
        "id",
        "created",
        "description",
        "logicalEntity",
        "device_count",
        "gateway_count",
        "micro_gateway_count",
        "scope_context",
        "data_service_id",
        "tags"
      ],
      "mappings": "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",
      "file": "schema.js",
      "sourceRoot": "/Users/dtr/gooee/ecmascript-sdk/src",
      "sourcesContent": [
        "import Joi_dataURI from 'joi-dataURI'\nconst Joi = Joi_dataURI()\n\nJoi.uuidArray = () => Joi.array().items(Joi.string().uuid())\nJoi.base64Image = () => Joi.dataURI().base64().mediatype('text/plain')\nJoi.tagsArray = () => Joi.array().items(Joi.string().max(50)).allow(null)\n\nJoi.commissionState = () => Joi.string().only(\n    'pending', 'provisioned', 'site_provisioned', 'commissioned')\n\n// Schema for location data.\nJoi.locationObject = () => {\n    return Joi.object().keys({\n        // TODO: is any of this required? docs don't say\n        addr1: Joi.string().max(100),\n        addr2: Joi.string().max(100), // TODO: required?\n        city: Joi.string().max(100),\n        state: Joi.string().max(100),\n        postal_code: Joi.string().max(50),\n        country: Joi.string().max(100),\n        country_code: Joi.string().length(2),\n        phone_number: Joi.string().max(20),\n        district: Joi.string().max(100),\n        lat: Joi.number(),\n        lng: Joi.number(),\n    })\n}\n\n// Count object schema, used in fields like 'deviceCount'.\nJoi.countObject = () => {\n    return Joi.object().keys({\n        total: Joi.number().integer().min(0),\n        online: Joi.number().integer().min(0),\n    })\n}\n\n// Base schema for entity Meta.\nJoi.baseMeta = () => {\n    return Joi.object().keys({\n        name: Joi.string().empty(null),\n        display_name: Joi.string().empty(null),\n        value: Joi.any().not(null).required(),\n        // TODO: only available on certain objects (docs are vague)\n        groups: Joi.array().items(Joi.string()),\n        unit_of_measure: Joi.string().allow(null),\n        modified: Joi.string(),\n    }).or('name', 'display_name')\n}\n\n// Product Meta schema.\nJoi.productMeta = () => {\n    return Joi.baseMeta().keys({\n        inheritance_type: Joi.string().only('none', 'aggregation'),\n    })\n}\n\n// Base schema for \"object\" entities, i.e. those with a UUID, created/modified\n// dates, name, and description.\nJoi.baseObjectEntity = () => {\n    return Joi.object().keys({\n        id: Joi.string().uuid().required(),\n        // TODO: parse these into real dates (with momentjs)\n        created: Joi.string(),\n        modified: Joi.string(),\n        name: Joi.string().max(100).required(),\n        description: Joi.string().allow(''),\n    })\n}\n\n// Base schema for entities in the logical chain -- Customer, Building, Space.\n// Connected Products are not included.\nJoi.logicalEntity = () => {\n    return Joi.baseObjectEntity().keys({\n        device_count: Joi.countObject(),\n        gateway_count: Joi.countObject(),\n        micro_gateway_count: Joi.countObject(),\n        scope_context: Joi.string().max(32),\n        data_service_id: Joi.string().allow(null),\n        tags: Joi.tagsArray(),\n    })\n\n}\n\nexport default Joi\n"
      ]
    },
    "mtime": 1476978970000
  },
  "{\"filename\":\"/Users/dtr/gooee/ecmascript-sdk/src/entities/customer.js\",\"env\":{},\"retainLines\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"presets\":[],\"plugins\":[[[],null],[[],null],[[],null],[[],{\"loose\":false,\"spec\":false}],[[],null],[[],null],[[],{\"spec\":false}],[[],null],[[],{\"loose\":false}],[[],null],[[],null],[[],null],[[],{\"loose\":false}],[[],{\"loose\":false}],[[],null],[[],null],[[],null],[[],{\"loose\":false}],[[],null],[[],{\"loose\":false}],[[],null],[[],null],[[],{\"loose\":false}],[[],{\"async\":false,\"asyncGenerators\":false}]],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"minified\":false,\"sourceRoot\":\"/Users/dtr/gooee/ecmascript-sdk/src/entities\",\"babelrc\":true,\"sourceType\":\"module\",\"moduleIds\":false,\"passPerPreset\":false,\"parserOpts\":false,\"generatorOpts\":false}:6.17.0": {
    "metadata": {
      "usedHelpers": [
        "inherits",
        "possibleConstructorReturn",
        "classCallCheck",
        "interopRequireDefault"
      ],
      "marked": [],
      "modules": {
        "imports": [
          {
            "source": "../types",
            "imported": [
              "EntityJson"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "EntityJson",
                "local": "EntityJson"
              }
            ]
          },
          {
            "source": "./base",
            "imported": [
              "Entity",
              "EntityModel"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "Entity",
                "local": "Entity"
              },
              {
                "kind": "named",
                "imported": "EntityModel",
                "local": "EntityModel"
              }
            ]
          },
          {
            "source": "../entities",
            "imported": [
              "Buildings",
              "Manufacturers"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "Buildings",
                "local": "Buildings"
              },
              {
                "kind": "named",
                "imported": "Manufacturers",
                "local": "Manufacturers"
              }
            ]
          },
          {
            "source": "../auth",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "User"
              }
            ]
          },
          {
            "source": "../schema",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "Joi"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "CustomerModel",
            "Customer"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "CustomerModel",
              "exported": "CustomerModel"
            },
            {
              "kind": "local",
              "local": "Customer",
              "exported": "Customer"
            }
          ]
        }
      }
    },
    "options": {
      "filename": "/Users/dtr/gooee/ecmascript-sdk/src/entities/customer.js",
      "filenameRelative": "/Users/dtr/gooee/ecmascript-sdk/src/entities/customer.js",
      "env": {},
      "retainLines": false,
      "highlightCode": true,
      "suppressDeprecationMessages": false,
      "presets": [],
      "plugins": [
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false,
            "spec": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "spec": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          {
            "async": false,
            "asyncGenerators": false
          }
        ]
      ],
      "ignore": [],
      "code": true,
      "metadata": true,
      "ast": false,
      "comments": true,
      "compact": "auto",
      "minified": false,
      "sourceMaps": "both",
      "sourceMapTarget": "customer.js",
      "sourceFileName": "customer.js",
      "sourceRoot": "/Users/dtr/gooee/ecmascript-sdk/src/entities",
      "babelrc": false,
      "sourceType": "module",
      "moduleRoot": "/Users/dtr/gooee/ecmascript-sdk/src/entities",
      "moduleIds": false,
      "passPerPreset": false,
      "parserOpts": false,
      "generatorOpts": false,
      "basename": "customer"
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.Customer = exports.CustomerModel = undefined;\n\nvar _base = require('./base');\n\nvar _entities = require('../entities');\n\nvar _auth = require('../auth');\n\nvar _auth2 = _interopRequireDefault(_auth);\n\nvar _schema = require('../schema');\n\nvar _schema2 = _interopRequireDefault(_schema);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar schema = _schema2.default.logicalEntity().keys({\n    manufacturers: _schema2.default.uuidArray().required(),\n    organizational_unit: _schema2.default.string().uuid().allow(null),\n    customer_sites: _schema2.default.uuidArray(),\n    buildings: _schema2.default.uuidArray(),\n    logo: _schema2.default.base64Image().allow(null),\n    preferences: _schema2.default.object().keys({\n        color1: _schema2.default.string().max(16),\n        color2: _schema2.default.string().max(16),\n        color3: _schema2.default.string().max(16),\n        color4: _schema2.default.string().max(16)\n    }).allow(null),\n    location: _schema2.default.locationObject().allow(null)\n});\n\nvar CustomerModel = exports.CustomerModel = function (_EntityModel) {\n    _inherits(CustomerModel, _EntityModel);\n\n    function CustomerModel(user) {\n        _classCallCheck(this, CustomerModel);\n\n        return _possibleConstructorReturn(this, (CustomerModel.__proto__ || Object.getPrototypeOf(CustomerModel)).call(this, user, 'customer', schema, Customer));\n    }\n\n    return CustomerModel;\n}(_base.EntityModel);\n\nvar Customer = exports.Customer = function (_Entity) {\n    _inherits(Customer, _Entity);\n\n    function Customer(model, data) {\n        _classCallCheck(this, Customer);\n\n        return _possibleConstructorReturn(this, (Customer.__proto__ || Object.getPrototypeOf(Customer)).call(this, model, data, {\n            'buildings': {\n                model: (0, _entities.Buildings)(model.user),\n                relatedName: 'customer'\n            },\n            'manufacturers': {\n                model: (0, _entities.Manufacturers)(model.user),\n                relatedName: 'customers'\n            }\n        }));\n    }\n\n    return Customer;\n}(_base.Entity);\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImN1c3RvbWVyLmpzIl0sIm5hbWVzIjpbInNjaGVtYSIsImxvZ2ljYWxFbnRpdHkiLCJrZXlzIiwibWFudWZhY3R1cmVycyIsInV1aWRBcnJheSIsInJlcXVpcmVkIiwib3JnYW5pemF0aW9uYWxfdW5pdCIsInN0cmluZyIsInV1aWQiLCJhbGxvdyIsImN1c3RvbWVyX3NpdGVzIiwiYnVpbGRpbmdzIiwibG9nbyIsImJhc2U2NEltYWdlIiwicHJlZmVyZW5jZXMiLCJvYmplY3QiLCJjb2xvcjEiLCJtYXgiLCJjb2xvcjIiLCJjb2xvcjMiLCJjb2xvcjQiLCJsb2NhdGlvbiIsImxvY2F0aW9uT2JqZWN0IiwiQ3VzdG9tZXJNb2RlbCIsInVzZXIiLCJDdXN0b21lciIsIm1vZGVsIiwiZGF0YSIsInJlbGF0ZWROYW1lIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBR0E7O0FBQ0E7O0FBQ0E7Ozs7QUFDQTs7Ozs7Ozs7Ozs7O0FBRUEsSUFBTUEsU0FBUyxpQkFBSUMsYUFBSixHQUFvQkMsSUFBcEIsQ0FBeUI7QUFDcENDLG1CQUFlLGlCQUFJQyxTQUFKLEdBQWdCQyxRQUFoQixFQURxQjtBQUVwQ0MseUJBQXFCLGlCQUFJQyxNQUFKLEdBQWFDLElBQWIsR0FBb0JDLEtBQXBCLENBQTBCLElBQTFCLENBRmU7QUFHcENDLG9CQUFnQixpQkFBSU4sU0FBSixFQUhvQjtBQUlwQ08sZUFBVyxpQkFBSVAsU0FBSixFQUp5QjtBQUtwQ1EsVUFBTSxpQkFBSUMsV0FBSixHQUFrQkosS0FBbEIsQ0FBd0IsSUFBeEIsQ0FMOEI7QUFNcENLLGlCQUFhLGlCQUFJQyxNQUFKLEdBQWFiLElBQWIsQ0FBa0I7QUFDM0JjLGdCQUFRLGlCQUFJVCxNQUFKLEdBQWFVLEdBQWIsQ0FBaUIsRUFBakIsQ0FEbUI7QUFFM0JDLGdCQUFRLGlCQUFJWCxNQUFKLEdBQWFVLEdBQWIsQ0FBaUIsRUFBakIsQ0FGbUI7QUFHM0JFLGdCQUFRLGlCQUFJWixNQUFKLEdBQWFVLEdBQWIsQ0FBaUIsRUFBakIsQ0FIbUI7QUFJM0JHLGdCQUFRLGlCQUFJYixNQUFKLEdBQWFVLEdBQWIsQ0FBaUIsRUFBakI7QUFKbUIsS0FBbEIsRUFLVlIsS0FMVSxDQUtKLElBTEksQ0FOdUI7QUFZcENZLGNBQVUsaUJBQUlDLGNBQUosR0FBcUJiLEtBQXJCLENBQTJCLElBQTNCO0FBWjBCLENBQXpCLENBQWY7O0lBZWFjLGEsV0FBQUEsYTs7O0FBRVQsMkJBQVlDLElBQVosRUFBd0I7QUFBQTs7QUFBQSw2SEFDZEEsSUFEYyxFQUNSLFVBRFEsRUFDSXhCLE1BREosRUFDWXlCLFFBRFo7QUFFdkI7Ozs7O0lBR1FBLFEsV0FBQUEsUTs7O0FBRVQsc0JBQVlDLEtBQVosRUFBa0NDLElBQWxDLEVBQW9EO0FBQUE7O0FBQUEsbUhBQzFDRCxLQUQwQyxFQUNuQ0MsSUFEbUMsRUFDN0I7QUFDZix5QkFBYTtBQUNURCx1QkFBTyx5QkFBVUEsTUFBTUYsSUFBaEIsQ0FERTtBQUVUSSw2QkFBYTtBQUZKLGFBREU7QUFLZiw2QkFBaUI7QUFDYkYsdUJBQU8sNkJBQWNBLE1BQU1GLElBQXBCLENBRE07QUFFYkksNkJBQWE7QUFGQTtBQUxGLFNBRDZCO0FBV25EIiwiZmlsZSI6ImN1c3RvbWVyLmpzIiwic291cmNlUm9vdCI6Ii9Vc2Vycy9kdHIvZ29vZWUvZWNtYXNjcmlwdC1zZGsvc3JjL2VudGl0aWVzIiwic291cmNlc0NvbnRlbnQiOlsiLyogQGZsb3cgKi9cbmltcG9ydCB0eXBlIHsgRW50aXR5SnNvbiB9IGZyb20gJy4uL3R5cGVzJ1xuXG5pbXBvcnQgeyBFbnRpdHksIEVudGl0eU1vZGVsIH0gZnJvbSAnLi9iYXNlJ1xuaW1wb3J0IHsgQnVpbGRpbmdzLCBNYW51ZmFjdHVyZXJzIH0gZnJvbSAnLi4vZW50aXRpZXMnXG5pbXBvcnQgVXNlciBmcm9tICcuLi9hdXRoJ1xuaW1wb3J0IEpvaSBmcm9tICcuLi9zY2hlbWEnXG5cbmNvbnN0IHNjaGVtYSA9IEpvaS5sb2dpY2FsRW50aXR5KCkua2V5cyh7XG4gICAgbWFudWZhY3R1cmVyczogSm9pLnV1aWRBcnJheSgpLnJlcXVpcmVkKCksXG4gICAgb3JnYW5pemF0aW9uYWxfdW5pdDogSm9pLnN0cmluZygpLnV1aWQoKS5hbGxvdyhudWxsKSxcbiAgICBjdXN0b21lcl9zaXRlczogSm9pLnV1aWRBcnJheSgpLFxuICAgIGJ1aWxkaW5nczogSm9pLnV1aWRBcnJheSgpLFxuICAgIGxvZ286IEpvaS5iYXNlNjRJbWFnZSgpLmFsbG93KG51bGwpLFxuICAgIHByZWZlcmVuY2VzOiBKb2kub2JqZWN0KCkua2V5cyh7XG4gICAgICAgIGNvbG9yMTogSm9pLnN0cmluZygpLm1heCgxNiksXG4gICAgICAgIGNvbG9yMjogSm9pLnN0cmluZygpLm1heCgxNiksXG4gICAgICAgIGNvbG9yMzogSm9pLnN0cmluZygpLm1heCgxNiksXG4gICAgICAgIGNvbG9yNDogSm9pLnN0cmluZygpLm1heCgxNiksXG4gICAgfSkuYWxsb3cobnVsbCksXG4gICAgbG9jYXRpb246IEpvaS5sb2NhdGlvbk9iamVjdCgpLmFsbG93KG51bGwpLFxufSlcblxuZXhwb3J0IGNsYXNzIEN1c3RvbWVyTW9kZWwgZXh0ZW5kcyBFbnRpdHlNb2RlbCB7XG5cbiAgICBjb25zdHJ1Y3Rvcih1c2VyOiBVc2VyKSB7XG4gICAgICAgIHN1cGVyKHVzZXIsICdjdXN0b21lcicsIHNjaGVtYSwgQ3VzdG9tZXIpXG4gICAgfVxufVxuXG5leHBvcnQgY2xhc3MgQ3VzdG9tZXIgZXh0ZW5kcyBFbnRpdHkge1xuXG4gICAgY29uc3RydWN0b3IobW9kZWw6IEN1c3RvbWVyTW9kZWwsIGRhdGE6IEVudGl0eUpzb24pIHtcbiAgICAgICAgc3VwZXIobW9kZWwsIGRhdGEsIHtcbiAgICAgICAgICAgICdidWlsZGluZ3MnOiB7XG4gICAgICAgICAgICAgICAgbW9kZWw6IEJ1aWxkaW5ncyhtb2RlbC51c2VyKSxcbiAgICAgICAgICAgICAgICByZWxhdGVkTmFtZTogJ2N1c3RvbWVyJyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAnbWFudWZhY3R1cmVycyc6IHtcbiAgICAgICAgICAgICAgICBtb2RlbDogTWFudWZhY3R1cmVycyhtb2RlbC51c2VyKSxcbiAgICAgICAgICAgICAgICByZWxhdGVkTmFtZTogJ2N1c3RvbWVycycsXG4gICAgICAgICAgICB9LFxuICAgICAgICB9KVxuICAgIH1cbn1cbiJdfQ==",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "customer.js"
      ],
      "names": [
        "schema",
        "logicalEntity",
        "keys",
        "manufacturers",
        "uuidArray",
        "required",
        "organizational_unit",
        "string",
        "uuid",
        "allow",
        "customer_sites",
        "buildings",
        "logo",
        "base64Image",
        "preferences",
        "object",
        "color1",
        "max",
        "color2",
        "color3",
        "color4",
        "location",
        "locationObject",
        "CustomerModel",
        "user",
        "Customer",
        "model",
        "data",
        "relatedName"
      ],
      "mappings": ";;;;;;;AAGA;;AACA;;AACA;;;;AACA;;;;;;;;;;;;AAEA,IAAMA,SAAS,iBAAIC,aAAJ,GAAoBC,IAApB,CAAyB;AACpCC,mBAAe,iBAAIC,SAAJ,GAAgBC,QAAhB,EADqB;AAEpCC,yBAAqB,iBAAIC,MAAJ,GAAaC,IAAb,GAAoBC,KAApB,CAA0B,IAA1B,CAFe;AAGpCC,oBAAgB,iBAAIN,SAAJ,EAHoB;AAIpCO,eAAW,iBAAIP,SAAJ,EAJyB;AAKpCQ,UAAM,iBAAIC,WAAJ,GAAkBJ,KAAlB,CAAwB,IAAxB,CAL8B;AAMpCK,iBAAa,iBAAIC,MAAJ,GAAab,IAAb,CAAkB;AAC3Bc,gBAAQ,iBAAIT,MAAJ,GAAaU,GAAb,CAAiB,EAAjB,CADmB;AAE3BC,gBAAQ,iBAAIX,MAAJ,GAAaU,GAAb,CAAiB,EAAjB,CAFmB;AAG3BE,gBAAQ,iBAAIZ,MAAJ,GAAaU,GAAb,CAAiB,EAAjB,CAHmB;AAI3BG,gBAAQ,iBAAIb,MAAJ,GAAaU,GAAb,CAAiB,EAAjB;AAJmB,KAAlB,EAKVR,KALU,CAKJ,IALI,CANuB;AAYpCY,cAAU,iBAAIC,cAAJ,GAAqBb,KAArB,CAA2B,IAA3B;AAZ0B,CAAzB,CAAf;;IAeac,a,WAAAA,a;;;AAET,2BAAYC,IAAZ,EAAwB;AAAA;;AAAA,6HACdA,IADc,EACR,UADQ,EACIxB,MADJ,EACYyB,QADZ;AAEvB;;;;;IAGQA,Q,WAAAA,Q;;;AAET,sBAAYC,KAAZ,EAAkCC,IAAlC,EAAoD;AAAA;;AAAA,mHAC1CD,KAD0C,EACnCC,IADmC,EAC7B;AACf,yBAAa;AACTD,uBAAO,yBAAUA,MAAMF,IAAhB,CADE;AAETI,6BAAa;AAFJ,aADE;AAKf,6BAAiB;AACbF,uBAAO,6BAAcA,MAAMF,IAApB,CADM;AAEbI,6BAAa;AAFA;AALF,SAD6B;AAWnD",
      "file": "customer.js",
      "sourceRoot": "/Users/dtr/gooee/ecmascript-sdk/src/entities",
      "sourcesContent": [
        "/* @flow */\nimport type { EntityJson } from '../types'\n\nimport { Entity, EntityModel } from './base'\nimport { Buildings, Manufacturers } from '../entities'\nimport User from '../auth'\nimport Joi from '../schema'\n\nconst schema = Joi.logicalEntity().keys({\n    manufacturers: Joi.uuidArray().required(),\n    organizational_unit: Joi.string().uuid().allow(null),\n    customer_sites: Joi.uuidArray(),\n    buildings: Joi.uuidArray(),\n    logo: Joi.base64Image().allow(null),\n    preferences: Joi.object().keys({\n        color1: Joi.string().max(16),\n        color2: Joi.string().max(16),\n        color3: Joi.string().max(16),\n        color4: Joi.string().max(16),\n    }).allow(null),\n    location: Joi.locationObject().allow(null),\n})\n\nexport class CustomerModel extends EntityModel {\n\n    constructor(user: User) {\n        super(user, 'customer', schema, Customer)\n    }\n}\n\nexport class Customer extends Entity {\n\n    constructor(model: CustomerModel, data: EntityJson) {\n        super(model, data, {\n            'buildings': {\n                model: Buildings(model.user),\n                relatedName: 'customer',\n            },\n            'manufacturers': {\n                model: Manufacturers(model.user),\n                relatedName: 'customers',\n            },\n        })\n    }\n}\n"
      ]
    },
    "mtime": 1476973980000
  },
  "{\"filename\":\"/Users/dtr/gooee/ecmascript-sdk/src/entities/device.js\",\"env\":{},\"retainLines\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"presets\":[],\"plugins\":[[[],null],[[],null],[[],null],[[],{\"loose\":false,\"spec\":false}],[[],null],[[],null],[[],{\"spec\":false}],[[],null],[[],{\"loose\":false}],[[],null],[[],null],[[],null],[[],{\"loose\":false}],[[],{\"loose\":false}],[[],null],[[],null],[[],null],[[],{\"loose\":false}],[[],null],[[],{\"loose\":false}],[[],null],[[],null],[[],{\"loose\":false}],[[],{\"async\":false,\"asyncGenerators\":false}]],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"minified\":false,\"sourceRoot\":\"/Users/dtr/gooee/ecmascript-sdk/src/entities\",\"babelrc\":true,\"sourceType\":\"module\",\"moduleIds\":false,\"passPerPreset\":false,\"parserOpts\":false,\"generatorOpts\":false}:6.17.0": {
    "metadata": {
      "usedHelpers": [
        "inherits",
        "possibleConstructorReturn",
        "classCallCheck",
        "interopRequireDefault"
      ],
      "marked": [],
      "modules": {
        "imports": [
          {
            "source": "../types",
            "imported": [
              "EntityJson"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "EntityJson",
                "local": "EntityJson"
              }
            ]
          },
          {
            "source": "./base",
            "imported": [
              "Entity",
              "EntityModel"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "Entity",
                "local": "Entity"
              },
              {
                "kind": "named",
                "imported": "EntityModel",
                "local": "EntityModel"
              }
            ]
          },
          {
            "source": "../entities",
            "imported": [
              "Spaces"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "Spaces",
                "local": "Spaces"
              }
            ]
          },
          {
            "source": "../auth",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "User"
              }
            ]
          },
          {
            "source": "../schema",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "Joi"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "DeviceModel",
            "Device"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "DeviceModel",
              "exported": "DeviceModel"
            },
            {
              "kind": "local",
              "local": "Device",
              "exported": "Device"
            }
          ]
        }
      }
    },
    "options": {
      "filename": "/Users/dtr/gooee/ecmascript-sdk/src/entities/device.js",
      "filenameRelative": "/Users/dtr/gooee/ecmascript-sdk/src/entities/device.js",
      "env": {},
      "retainLines": false,
      "highlightCode": true,
      "suppressDeprecationMessages": false,
      "presets": [],
      "plugins": [
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false,
            "spec": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "spec": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          {
            "async": false,
            "asyncGenerators": false
          }
        ]
      ],
      "ignore": [],
      "code": true,
      "metadata": true,
      "ast": false,
      "comments": true,
      "compact": "auto",
      "minified": false,
      "sourceMaps": "both",
      "sourceMapTarget": "device.js",
      "sourceFileName": "device.js",
      "sourceRoot": "/Users/dtr/gooee/ecmascript-sdk/src/entities",
      "babelrc": false,
      "sourceType": "module",
      "moduleRoot": "/Users/dtr/gooee/ecmascript-sdk/src/entities",
      "moduleIds": false,
      "passPerPreset": false,
      "parserOpts": false,
      "generatorOpts": false,
      "basename": "device"
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.Device = exports.DeviceModel = undefined;\n\nvar _base = require('./base');\n\nvar _entities = require('../entities');\n\nvar _auth = require('../auth');\n\nvar _auth2 = _interopRequireDefault(_auth);\n\nvar _schema = require('../schema');\n\nvar _schema2 = _interopRequireDefault(_schema);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n// Device Meta schema.\nvar deviceMetaSchema = function deviceMetaSchema() {\n    return _schema2.default.baseMeta().keys({\n        modified: _schema2.default.forbidden(),\n        timestamp: _schema2.default.string()\n    });\n};\n\nvar schema = _schema2.default.baseObjectEntity().keys({\n    type: _schema2.default.string().only('bulb', 'gateway', 'micro_gateway', 'misc', 'sensor', 'switch', 'wim').required(),\n    commission_state: _schema2.default.commissionState(),\n    // TODO: this is a date\n    commissioned_date: _schema2.default.string().allow(null),\n    sku: _schema2.default.string().allow(null),\n    gooee_sku: _schema2.default.string().allow(null),\n    product: _schema2.default.string().uuid().allow(null),\n    parent_device: _schema2.default.string().uuid().allow(null).when('type', { is: 'gateway', then: _schema2.default.only(null) }),\n    child_devices: _schema2.default.uuidArray(),\n    spaces: _schema2.default.uuidArray(),\n    connected_products: _schema2.default.uuidArray(),\n    // TODO: come back to this after doing service profiles\n    service_profile: _schema2.default.string().max(100).allow(null),\n    device_count: _schema2.default.countObject(),\n    micro_gateway_count: _schema2.default.countObject(),\n    euid: _schema2.default.string().max(128).allow(null),\n    sensor_capabilities: _schema2.default.number().integer().allow(null),\n    network_address: _schema2.default.number().integer().allow(null),\n    meta: _schema2.default.array().items(deviceMetaSchema()),\n    custom_fields: _schema2.default.object().allow(null),\n    data_service_id: _schema2.default.string().allow(null),\n    scope_context: _schema2.default.string().max(32),\n    tags: _schema2.default.tagsArray()\n});\n\nvar DeviceModel = exports.DeviceModel = function (_EntityModel) {\n    _inherits(DeviceModel, _EntityModel);\n\n    function DeviceModel(user) {\n        _classCallCheck(this, DeviceModel);\n\n        return _possibleConstructorReturn(this, (DeviceModel.__proto__ || Object.getPrototypeOf(DeviceModel)).call(this, user, 'device', schema, Device));\n    }\n\n    return DeviceModel;\n}(_base.EntityModel);\n\nvar Device = exports.Device = function (_Entity) {\n    _inherits(Device, _Entity);\n\n    function Device(model, data) {\n        _classCallCheck(this, Device);\n\n        return _possibleConstructorReturn(this, (Device.__proto__ || Object.getPrototypeOf(Device)).call(this, model, data, {\n            'parent_device': {\n                model: new DeviceModel(model.user)\n            },\n            'child_devices': {\n                model: new DeviceModel(model.user),\n                relatedName: 'parent_device'\n            },\n            'spaces': {\n                model: (0, _entities.Spaces)(model.user),\n                relatedName: 'devices'\n            }\n        }));\n    }\n\n    return Device;\n}(_base.Entity);\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRldmljZS5qcyJdLCJuYW1lcyI6WyJkZXZpY2VNZXRhU2NoZW1hIiwiYmFzZU1ldGEiLCJrZXlzIiwibW9kaWZpZWQiLCJmb3JiaWRkZW4iLCJ0aW1lc3RhbXAiLCJzdHJpbmciLCJzY2hlbWEiLCJiYXNlT2JqZWN0RW50aXR5IiwidHlwZSIsIm9ubHkiLCJyZXF1aXJlZCIsImNvbW1pc3Npb25fc3RhdGUiLCJjb21taXNzaW9uU3RhdGUiLCJjb21taXNzaW9uZWRfZGF0ZSIsImFsbG93Iiwic2t1IiwiZ29vZWVfc2t1IiwicHJvZHVjdCIsInV1aWQiLCJwYXJlbnRfZGV2aWNlIiwid2hlbiIsImlzIiwidGhlbiIsImNoaWxkX2RldmljZXMiLCJ1dWlkQXJyYXkiLCJzcGFjZXMiLCJjb25uZWN0ZWRfcHJvZHVjdHMiLCJzZXJ2aWNlX3Byb2ZpbGUiLCJtYXgiLCJkZXZpY2VfY291bnQiLCJjb3VudE9iamVjdCIsIm1pY3JvX2dhdGV3YXlfY291bnQiLCJldWlkIiwic2Vuc29yX2NhcGFiaWxpdGllcyIsIm51bWJlciIsImludGVnZXIiLCJuZXR3b3JrX2FkZHJlc3MiLCJtZXRhIiwiYXJyYXkiLCJpdGVtcyIsImN1c3RvbV9maWVsZHMiLCJvYmplY3QiLCJkYXRhX3NlcnZpY2VfaWQiLCJzY29wZV9jb250ZXh0IiwidGFncyIsInRhZ3NBcnJheSIsIkRldmljZU1vZGVsIiwidXNlciIsIkRldmljZSIsIm1vZGVsIiwiZGF0YSIsInJlbGF0ZWROYW1lIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBR0E7O0FBQ0E7O0FBQ0E7Ozs7QUFDQTs7Ozs7Ozs7Ozs7O0FBRUE7QUFDQSxJQUFNQSxtQkFBbUIsU0FBbkJBLGdCQUFtQixHQUFNO0FBQzNCLFdBQU8saUJBQUlDLFFBQUosR0FBZUMsSUFBZixDQUFvQjtBQUN2QkMsa0JBQVUsaUJBQUlDLFNBQUosRUFEYTtBQUV2QkMsbUJBQVcsaUJBQUlDLE1BQUo7QUFGWSxLQUFwQixDQUFQO0FBSUgsQ0FMRDs7QUFPQSxJQUFNQyxTQUFTLGlCQUFJQyxnQkFBSixHQUF1Qk4sSUFBdkIsQ0FBNEI7QUFDdkNPLFVBQU0saUJBQUlILE1BQUosR0FBYUksSUFBYixDQUNGLE1BREUsRUFDTSxTQUROLEVBQ2lCLGVBRGpCLEVBQ2tDLE1BRGxDLEVBQzBDLFFBRDFDLEVBQ29ELFFBRHBELEVBQzhELEtBRDlELEVBRUpDLFFBRkksRUFEaUM7QUFJdkNDLHNCQUFrQixpQkFBSUMsZUFBSixFQUpxQjtBQUt2QztBQUNBQyx1QkFBbUIsaUJBQUlSLE1BQUosR0FBYVMsS0FBYixDQUFtQixJQUFuQixDQU5vQjtBQU92Q0MsU0FBSyxpQkFBSVYsTUFBSixHQUFhUyxLQUFiLENBQW1CLElBQW5CLENBUGtDO0FBUXZDRSxlQUFXLGlCQUFJWCxNQUFKLEdBQWFTLEtBQWIsQ0FBbUIsSUFBbkIsQ0FSNEI7QUFTdkNHLGFBQVMsaUJBQUlaLE1BQUosR0FBYWEsSUFBYixHQUFvQkosS0FBcEIsQ0FBMEIsSUFBMUIsQ0FUOEI7QUFVdkNLLG1CQUFlLGlCQUFJZCxNQUFKLEdBQWFhLElBQWIsR0FBb0JKLEtBQXBCLENBQTBCLElBQTFCLEVBQWdDTSxJQUFoQyxDQUNYLE1BRFcsRUFDSCxFQUFFQyxJQUFJLFNBQU4sRUFBaUJDLE1BQU0saUJBQUliLElBQUosQ0FBUyxJQUFULENBQXZCLEVBREcsQ0FWd0I7QUFhdkNjLG1CQUFlLGlCQUFJQyxTQUFKLEVBYndCO0FBY3ZDQyxZQUFRLGlCQUFJRCxTQUFKLEVBZCtCO0FBZXZDRSx3QkFBb0IsaUJBQUlGLFNBQUosRUFmbUI7QUFnQnZDO0FBQ0FHLHFCQUFpQixpQkFBSXRCLE1BQUosR0FBYXVCLEdBQWIsQ0FBaUIsR0FBakIsRUFBc0JkLEtBQXRCLENBQTRCLElBQTVCLENBakJzQjtBQWtCdkNlLGtCQUFjLGlCQUFJQyxXQUFKLEVBbEJ5QjtBQW1CdkNDLHlCQUFxQixpQkFBSUQsV0FBSixFQW5Ca0I7QUFvQnZDRSxVQUFNLGlCQUFJM0IsTUFBSixHQUFhdUIsR0FBYixDQUFpQixHQUFqQixFQUFzQmQsS0FBdEIsQ0FBNEIsSUFBNUIsQ0FwQmlDO0FBcUJ2Q21CLHlCQUFxQixpQkFBSUMsTUFBSixHQUFhQyxPQUFiLEdBQXVCckIsS0FBdkIsQ0FBNkIsSUFBN0IsQ0FyQmtCO0FBc0J2Q3NCLHFCQUFpQixpQkFBSUYsTUFBSixHQUFhQyxPQUFiLEdBQXVCckIsS0FBdkIsQ0FBNkIsSUFBN0IsQ0F0QnNCO0FBdUJ2Q3VCLFVBQU0saUJBQUlDLEtBQUosR0FBWUMsS0FBWixDQUFrQnhDLGtCQUFsQixDQXZCaUM7QUF3QnZDeUMsbUJBQWUsaUJBQUlDLE1BQUosR0FBYTNCLEtBQWIsQ0FBbUIsSUFBbkIsQ0F4QndCO0FBeUJ2QzRCLHFCQUFpQixpQkFBSXJDLE1BQUosR0FBYVMsS0FBYixDQUFtQixJQUFuQixDQXpCc0I7QUEwQnZDNkIsbUJBQWUsaUJBQUl0QyxNQUFKLEdBQWF1QixHQUFiLENBQWlCLEVBQWpCLENBMUJ3QjtBQTJCdkNnQixVQUFNLGlCQUFJQyxTQUFKO0FBM0JpQyxDQUE1QixDQUFmOztJQThCYUMsVyxXQUFBQSxXOzs7QUFFVCx5QkFBWUMsSUFBWixFQUF3QjtBQUFBOztBQUFBLHlIQUNkQSxJQURjLEVBQ1IsUUFEUSxFQUNFekMsTUFERixFQUNVMEMsTUFEVjtBQUV2Qjs7Ozs7SUFHUUEsTSxXQUFBQSxNOzs7QUFFVCxvQkFBWUMsS0FBWixFQUFnQ0MsSUFBaEMsRUFBa0Q7QUFBQTs7QUFBQSwrR0FDeENELEtBRHdDLEVBQ2pDQyxJQURpQyxFQUMzQjtBQUNmLDZCQUFpQjtBQUNiRCx1QkFBTyxJQUFJSCxXQUFKLENBQWdCRyxNQUFNRixJQUF0QjtBQURNLGFBREY7QUFJZiw2QkFBaUI7QUFDYkUsdUJBQU8sSUFBSUgsV0FBSixDQUFnQkcsTUFBTUYsSUFBdEIsQ0FETTtBQUViSSw2QkFBYTtBQUZBLGFBSkY7QUFRZixzQkFBVTtBQUNORix1QkFBTyxzQkFBT0EsTUFBTUYsSUFBYixDQUREO0FBRU5JLDZCQUFhO0FBRlA7QUFSSyxTQUQyQjtBQWNqRCIsImZpbGUiOiJkZXZpY2UuanMiLCJzb3VyY2VSb290IjoiL1VzZXJzL2R0ci9nb29lZS9lY21hc2NyaXB0LXNkay9zcmMvZW50aXRpZXMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiBAZmxvdyAqL1xuaW1wb3J0IHR5cGUgeyBFbnRpdHlKc29uIH0gZnJvbSAnLi4vdHlwZXMnXG5cbmltcG9ydCB7IEVudGl0eSwgRW50aXR5TW9kZWwgfSBmcm9tICcuL2Jhc2UnXG5pbXBvcnQgeyBTcGFjZXMgfSBmcm9tICcuLi9lbnRpdGllcydcbmltcG9ydCBVc2VyIGZyb20gJy4uL2F1dGgnXG5pbXBvcnQgSm9pIGZyb20gJy4uL3NjaGVtYSdcblxuLy8gRGV2aWNlIE1ldGEgc2NoZW1hLlxuY29uc3QgZGV2aWNlTWV0YVNjaGVtYSA9ICgpID0+IHtcbiAgICByZXR1cm4gSm9pLmJhc2VNZXRhKCkua2V5cyh7XG4gICAgICAgIG1vZGlmaWVkOiBKb2kuZm9yYmlkZGVuKCksXG4gICAgICAgIHRpbWVzdGFtcDogSm9pLnN0cmluZygpLFxuICAgIH0pXG59XG5cbmNvbnN0IHNjaGVtYSA9IEpvaS5iYXNlT2JqZWN0RW50aXR5KCkua2V5cyh7XG4gICAgdHlwZTogSm9pLnN0cmluZygpLm9ubHkoXG4gICAgICAgICdidWxiJywgJ2dhdGV3YXknLCAnbWljcm9fZ2F0ZXdheScsICdtaXNjJywgJ3NlbnNvcicsICdzd2l0Y2gnLCAnd2ltJ1xuICAgICkucmVxdWlyZWQoKSxcbiAgICBjb21taXNzaW9uX3N0YXRlOiBKb2kuY29tbWlzc2lvblN0YXRlKCksXG4gICAgLy8gVE9ETzogdGhpcyBpcyBhIGRhdGVcbiAgICBjb21taXNzaW9uZWRfZGF0ZTogSm9pLnN0cmluZygpLmFsbG93KG51bGwpLFxuICAgIHNrdTogSm9pLnN0cmluZygpLmFsbG93KG51bGwpLFxuICAgIGdvb2VlX3NrdTogSm9pLnN0cmluZygpLmFsbG93KG51bGwpLFxuICAgIHByb2R1Y3Q6IEpvaS5zdHJpbmcoKS51dWlkKCkuYWxsb3cobnVsbCksXG4gICAgcGFyZW50X2RldmljZTogSm9pLnN0cmluZygpLnV1aWQoKS5hbGxvdyhudWxsKS53aGVuKFxuICAgICAgICAndHlwZScsIHsgaXM6ICdnYXRld2F5JywgdGhlbjogSm9pLm9ubHkobnVsbCkgfVxuICAgICksXG4gICAgY2hpbGRfZGV2aWNlczogSm9pLnV1aWRBcnJheSgpLFxuICAgIHNwYWNlczogSm9pLnV1aWRBcnJheSgpLFxuICAgIGNvbm5lY3RlZF9wcm9kdWN0czogSm9pLnV1aWRBcnJheSgpLFxuICAgIC8vIFRPRE86IGNvbWUgYmFjayB0byB0aGlzIGFmdGVyIGRvaW5nIHNlcnZpY2UgcHJvZmlsZXNcbiAgICBzZXJ2aWNlX3Byb2ZpbGU6IEpvaS5zdHJpbmcoKS5tYXgoMTAwKS5hbGxvdyhudWxsKSxcbiAgICBkZXZpY2VfY291bnQ6IEpvaS5jb3VudE9iamVjdCgpLFxuICAgIG1pY3JvX2dhdGV3YXlfY291bnQ6IEpvaS5jb3VudE9iamVjdCgpLFxuICAgIGV1aWQ6IEpvaS5zdHJpbmcoKS5tYXgoMTI4KS5hbGxvdyhudWxsKSxcbiAgICBzZW5zb3JfY2FwYWJpbGl0aWVzOiBKb2kubnVtYmVyKCkuaW50ZWdlcigpLmFsbG93KG51bGwpLFxuICAgIG5ldHdvcmtfYWRkcmVzczogSm9pLm51bWJlcigpLmludGVnZXIoKS5hbGxvdyhudWxsKSxcbiAgICBtZXRhOiBKb2kuYXJyYXkoKS5pdGVtcyhkZXZpY2VNZXRhU2NoZW1hKCkpLFxuICAgIGN1c3RvbV9maWVsZHM6IEpvaS5vYmplY3QoKS5hbGxvdyhudWxsKSxcbiAgICBkYXRhX3NlcnZpY2VfaWQ6IEpvaS5zdHJpbmcoKS5hbGxvdyhudWxsKSxcbiAgICBzY29wZV9jb250ZXh0OiBKb2kuc3RyaW5nKCkubWF4KDMyKSxcbiAgICB0YWdzOiBKb2kudGFnc0FycmF5KCksXG59KVxuXG5leHBvcnQgY2xhc3MgRGV2aWNlTW9kZWwgZXh0ZW5kcyBFbnRpdHlNb2RlbCB7XG5cbiAgICBjb25zdHJ1Y3Rvcih1c2VyOiBVc2VyKSB7XG4gICAgICAgIHN1cGVyKHVzZXIsICdkZXZpY2UnLCBzY2hlbWEsIERldmljZSlcbiAgICB9XG59XG5cbmV4cG9ydCBjbGFzcyBEZXZpY2UgZXh0ZW5kcyBFbnRpdHkge1xuXG4gICAgY29uc3RydWN0b3IobW9kZWw6IERldmljZU1vZGVsLCBkYXRhOiBFbnRpdHlKc29uKSB7XG4gICAgICAgIHN1cGVyKG1vZGVsLCBkYXRhLCB7XG4gICAgICAgICAgICAncGFyZW50X2RldmljZSc6IHtcbiAgICAgICAgICAgICAgICBtb2RlbDogbmV3IERldmljZU1vZGVsKG1vZGVsLnVzZXIpLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICdjaGlsZF9kZXZpY2VzJzoge1xuICAgICAgICAgICAgICAgIG1vZGVsOiBuZXcgRGV2aWNlTW9kZWwobW9kZWwudXNlciksXG4gICAgICAgICAgICAgICAgcmVsYXRlZE5hbWU6ICdwYXJlbnRfZGV2aWNlJyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAnc3BhY2VzJzoge1xuICAgICAgICAgICAgICAgIG1vZGVsOiBTcGFjZXMobW9kZWwudXNlciksXG4gICAgICAgICAgICAgICAgcmVsYXRlZE5hbWU6ICdkZXZpY2VzJyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pXG4gICAgfVxufVxuIl19",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "device.js"
      ],
      "names": [
        "deviceMetaSchema",
        "baseMeta",
        "keys",
        "modified",
        "forbidden",
        "timestamp",
        "string",
        "schema",
        "baseObjectEntity",
        "type",
        "only",
        "required",
        "commission_state",
        "commissionState",
        "commissioned_date",
        "allow",
        "sku",
        "gooee_sku",
        "product",
        "uuid",
        "parent_device",
        "when",
        "is",
        "then",
        "child_devices",
        "uuidArray",
        "spaces",
        "connected_products",
        "service_profile",
        "max",
        "device_count",
        "countObject",
        "micro_gateway_count",
        "euid",
        "sensor_capabilities",
        "number",
        "integer",
        "network_address",
        "meta",
        "array",
        "items",
        "custom_fields",
        "object",
        "data_service_id",
        "scope_context",
        "tags",
        "tagsArray",
        "DeviceModel",
        "user",
        "Device",
        "model",
        "data",
        "relatedName"
      ],
      "mappings": ";;;;;;;AAGA;;AACA;;AACA;;;;AACA;;;;;;;;;;;;AAEA;AACA,IAAMA,mBAAmB,SAAnBA,gBAAmB,GAAM;AAC3B,WAAO,iBAAIC,QAAJ,GAAeC,IAAf,CAAoB;AACvBC,kBAAU,iBAAIC,SAAJ,EADa;AAEvBC,mBAAW,iBAAIC,MAAJ;AAFY,KAApB,CAAP;AAIH,CALD;;AAOA,IAAMC,SAAS,iBAAIC,gBAAJ,GAAuBN,IAAvB,CAA4B;AACvCO,UAAM,iBAAIH,MAAJ,GAAaI,IAAb,CACF,MADE,EACM,SADN,EACiB,eADjB,EACkC,MADlC,EAC0C,QAD1C,EACoD,QADpD,EAC8D,KAD9D,EAEJC,QAFI,EADiC;AAIvCC,sBAAkB,iBAAIC,eAAJ,EAJqB;AAKvC;AACAC,uBAAmB,iBAAIR,MAAJ,GAAaS,KAAb,CAAmB,IAAnB,CANoB;AAOvCC,SAAK,iBAAIV,MAAJ,GAAaS,KAAb,CAAmB,IAAnB,CAPkC;AAQvCE,eAAW,iBAAIX,MAAJ,GAAaS,KAAb,CAAmB,IAAnB,CAR4B;AASvCG,aAAS,iBAAIZ,MAAJ,GAAaa,IAAb,GAAoBJ,KAApB,CAA0B,IAA1B,CAT8B;AAUvCK,mBAAe,iBAAId,MAAJ,GAAaa,IAAb,GAAoBJ,KAApB,CAA0B,IAA1B,EAAgCM,IAAhC,CACX,MADW,EACH,EAAEC,IAAI,SAAN,EAAiBC,MAAM,iBAAIb,IAAJ,CAAS,IAAT,CAAvB,EADG,CAVwB;AAavCc,mBAAe,iBAAIC,SAAJ,EAbwB;AAcvCC,YAAQ,iBAAID,SAAJ,EAd+B;AAevCE,wBAAoB,iBAAIF,SAAJ,EAfmB;AAgBvC;AACAG,qBAAiB,iBAAItB,MAAJ,GAAauB,GAAb,CAAiB,GAAjB,EAAsBd,KAAtB,CAA4B,IAA5B,CAjBsB;AAkBvCe,kBAAc,iBAAIC,WAAJ,EAlByB;AAmBvCC,yBAAqB,iBAAID,WAAJ,EAnBkB;AAoBvCE,UAAM,iBAAI3B,MAAJ,GAAauB,GAAb,CAAiB,GAAjB,EAAsBd,KAAtB,CAA4B,IAA5B,CApBiC;AAqBvCmB,yBAAqB,iBAAIC,MAAJ,GAAaC,OAAb,GAAuBrB,KAAvB,CAA6B,IAA7B,CArBkB;AAsBvCsB,qBAAiB,iBAAIF,MAAJ,GAAaC,OAAb,GAAuBrB,KAAvB,CAA6B,IAA7B,CAtBsB;AAuBvCuB,UAAM,iBAAIC,KAAJ,GAAYC,KAAZ,CAAkBxC,kBAAlB,CAvBiC;AAwBvCyC,mBAAe,iBAAIC,MAAJ,GAAa3B,KAAb,CAAmB,IAAnB,CAxBwB;AAyBvC4B,qBAAiB,iBAAIrC,MAAJ,GAAaS,KAAb,CAAmB,IAAnB,CAzBsB;AA0BvC6B,mBAAe,iBAAItC,MAAJ,GAAauB,GAAb,CAAiB,EAAjB,CA1BwB;AA2BvCgB,UAAM,iBAAIC,SAAJ;AA3BiC,CAA5B,CAAf;;IA8BaC,W,WAAAA,W;;;AAET,yBAAYC,IAAZ,EAAwB;AAAA;;AAAA,yHACdA,IADc,EACR,QADQ,EACEzC,MADF,EACU0C,MADV;AAEvB;;;;;IAGQA,M,WAAAA,M;;;AAET,oBAAYC,KAAZ,EAAgCC,IAAhC,EAAkD;AAAA;;AAAA,+GACxCD,KADwC,EACjCC,IADiC,EAC3B;AACf,6BAAiB;AACbD,uBAAO,IAAIH,WAAJ,CAAgBG,MAAMF,IAAtB;AADM,aADF;AAIf,6BAAiB;AACbE,uBAAO,IAAIH,WAAJ,CAAgBG,MAAMF,IAAtB,CADM;AAEbI,6BAAa;AAFA,aAJF;AAQf,sBAAU;AACNF,uBAAO,sBAAOA,MAAMF,IAAb,CADD;AAENI,6BAAa;AAFP;AARK,SAD2B;AAcjD",
      "file": "device.js",
      "sourceRoot": "/Users/dtr/gooee/ecmascript-sdk/src/entities",
      "sourcesContent": [
        "/* @flow */\nimport type { EntityJson } from '../types'\n\nimport { Entity, EntityModel } from './base'\nimport { Spaces } from '../entities'\nimport User from '../auth'\nimport Joi from '../schema'\n\n// Device Meta schema.\nconst deviceMetaSchema = () => {\n    return Joi.baseMeta().keys({\n        modified: Joi.forbidden(),\n        timestamp: Joi.string(),\n    })\n}\n\nconst schema = Joi.baseObjectEntity().keys({\n    type: Joi.string().only(\n        'bulb', 'gateway', 'micro_gateway', 'misc', 'sensor', 'switch', 'wim'\n    ).required(),\n    commission_state: Joi.commissionState(),\n    // TODO: this is a date\n    commissioned_date: Joi.string().allow(null),\n    sku: Joi.string().allow(null),\n    gooee_sku: Joi.string().allow(null),\n    product: Joi.string().uuid().allow(null),\n    parent_device: Joi.string().uuid().allow(null).when(\n        'type', { is: 'gateway', then: Joi.only(null) }\n    ),\n    child_devices: Joi.uuidArray(),\n    spaces: Joi.uuidArray(),\n    connected_products: Joi.uuidArray(),\n    // TODO: come back to this after doing service profiles\n    service_profile: Joi.string().max(100).allow(null),\n    device_count: Joi.countObject(),\n    micro_gateway_count: Joi.countObject(),\n    euid: Joi.string().max(128).allow(null),\n    sensor_capabilities: Joi.number().integer().allow(null),\n    network_address: Joi.number().integer().allow(null),\n    meta: Joi.array().items(deviceMetaSchema()),\n    custom_fields: Joi.object().allow(null),\n    data_service_id: Joi.string().allow(null),\n    scope_context: Joi.string().max(32),\n    tags: Joi.tagsArray(),\n})\n\nexport class DeviceModel extends EntityModel {\n\n    constructor(user: User) {\n        super(user, 'device', schema, Device)\n    }\n}\n\nexport class Device extends Entity {\n\n    constructor(model: DeviceModel, data: EntityJson) {\n        super(model, data, {\n            'parent_device': {\n                model: new DeviceModel(model.user),\n            },\n            'child_devices': {\n                model: new DeviceModel(model.user),\n                relatedName: 'parent_device',\n            },\n            'spaces': {\n                model: Spaces(model.user),\n                relatedName: 'devices',\n            },\n        })\n    }\n}\n"
      ]
    },
    "mtime": 1476978438000
  },
  "{\"filename\":\"/Users/dtr/gooee/ecmascript-sdk/src/entities/manufacturer.js\",\"env\":{},\"retainLines\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"presets\":[],\"plugins\":[[[],null],[[],null],[[],null],[[],{\"loose\":false,\"spec\":false}],[[],null],[[],null],[[],{\"spec\":false}],[[],null],[[],{\"loose\":false}],[[],null],[[],null],[[],null],[[],{\"loose\":false}],[[],{\"loose\":false}],[[],null],[[],null],[[],null],[[],{\"loose\":false}],[[],null],[[],{\"loose\":false}],[[],null],[[],null],[[],{\"loose\":false}],[[],{\"async\":false,\"asyncGenerators\":false}]],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"minified\":false,\"sourceRoot\":\"/Users/dtr/gooee/ecmascript-sdk/src/entities\",\"babelrc\":true,\"sourceType\":\"module\",\"moduleIds\":false,\"passPerPreset\":false,\"parserOpts\":false,\"generatorOpts\":false}:6.17.0": {
    "metadata": {
      "usedHelpers": [
        "inherits",
        "possibleConstructorReturn",
        "classCallCheck",
        "createClass",
        "interopRequireDefault"
      ],
      "marked": [],
      "modules": {
        "imports": [
          {
            "source": "bluebird",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "Promise"
              }
            ]
          },
          {
            "source": "../types",
            "imported": [
              "EntityJson"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "EntityJson",
                "local": "EntityJson"
              }
            ]
          },
          {
            "source": "../auth",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "User"
              }
            ]
          },
          {
            "source": "./base",
            "imported": [
              "Entity",
              "EntityModel"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "Entity",
                "local": "Entity"
              },
              {
                "kind": "named",
                "imported": "EntityModel",
                "local": "EntityModel"
              }
            ]
          },
          {
            "source": "../entities",
            "imported": [
              "Customers"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "Customers",
                "local": "Customers"
              }
            ]
          },
          {
            "source": "../schema",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "Joi"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "ManufacturerModel",
            "Manufacturer"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "ManufacturerModel",
              "exported": "ManufacturerModel"
            },
            {
              "kind": "local",
              "local": "Manufacturer",
              "exported": "Manufacturer"
            }
          ]
        }
      }
    },
    "options": {
      "filename": "/Users/dtr/gooee/ecmascript-sdk/src/entities/manufacturer.js",
      "filenameRelative": "/Users/dtr/gooee/ecmascript-sdk/src/entities/manufacturer.js",
      "env": {},
      "retainLines": false,
      "highlightCode": true,
      "suppressDeprecationMessages": false,
      "presets": [],
      "plugins": [
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false,
            "spec": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "spec": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          {
            "async": false,
            "asyncGenerators": false
          }
        ]
      ],
      "ignore": [],
      "code": true,
      "metadata": true,
      "ast": false,
      "comments": true,
      "compact": "auto",
      "minified": false,
      "sourceMaps": "both",
      "sourceMapTarget": "manufacturer.js",
      "sourceFileName": "manufacturer.js",
      "sourceRoot": "/Users/dtr/gooee/ecmascript-sdk/src/entities",
      "babelrc": false,
      "sourceType": "module",
      "moduleRoot": "/Users/dtr/gooee/ecmascript-sdk/src/entities",
      "moduleIds": false,
      "passPerPreset": false,
      "parserOpts": false,
      "generatorOpts": false,
      "basename": "manufacturer"
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.Manufacturer = exports.ManufacturerModel = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _bluebird = require('bluebird');\n\nvar _bluebird2 = _interopRequireDefault(_bluebird);\n\nvar _auth = require('../auth');\n\nvar _auth2 = _interopRequireDefault(_auth);\n\nvar _base = require('./base');\n\nvar _entities = require('../entities');\n\nvar _schema = require('../schema');\n\nvar _schema2 = _interopRequireDefault(_schema);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar schema = _schema2.default.baseObjectEntity().keys({\n    location: _schema2.default.locationObject().allow(null),\n    products: _schema2.default.uuidArray(),\n    customers: _schema2.default.uuidArray(),\n    users: _schema2.default.uuidArray(),\n    logo: _schema2.default.base64Image().allow(null),\n    organizational_units: _schema2.default.uuidArray(),\n    devices_total: _schema2.default.number().integer(),\n    scope_context: _schema2.default.string().max(32),\n    tags: _schema2.default.tagsArray()\n});\n\nvar ManufacturerModel = exports.ManufacturerModel = function (_EntityModel) {\n    _inherits(ManufacturerModel, _EntityModel);\n\n    function ManufacturerModel(user) {\n        _classCallCheck(this, ManufacturerModel);\n\n        return _possibleConstructorReturn(this, (ManufacturerModel.__proto__ || Object.getPrototypeOf(ManufacturerModel)).call(this, user, 'manufacturer', schema, Manufacturer));\n    }\n\n    return ManufacturerModel;\n}(_base.EntityModel);\n\nvar Manufacturer = exports.Manufacturer = function (_Entity) {\n    _inherits(Manufacturer, _Entity);\n\n    function Manufacturer(model, data) {\n        _classCallCheck(this, Manufacturer);\n\n        return _possibleConstructorReturn(this, (Manufacturer.__proto__ || Object.getPrototypeOf(Manufacturer)).call(this, model, data, {\n            'customers': {\n                model: (0, _entities.Customers)(model.user),\n                relatedName: 'manufacturers'\n            }\n        }));\n    }\n\n    _createClass(Manufacturer, [{\n        key: 'customers',\n        value: function customers() {\n            return this._getManyRelated('customers');\n        }\n    }]);\n\n    return Manufacturer;\n}(_base.Entity);\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1hbnVmYWN0dXJlci5qcyJdLCJuYW1lcyI6WyJzY2hlbWEiLCJiYXNlT2JqZWN0RW50aXR5Iiwia2V5cyIsImxvY2F0aW9uIiwibG9jYXRpb25PYmplY3QiLCJhbGxvdyIsInByb2R1Y3RzIiwidXVpZEFycmF5IiwiY3VzdG9tZXJzIiwidXNlcnMiLCJsb2dvIiwiYmFzZTY0SW1hZ2UiLCJvcmdhbml6YXRpb25hbF91bml0cyIsImRldmljZXNfdG90YWwiLCJudW1iZXIiLCJpbnRlZ2VyIiwic2NvcGVfY29udGV4dCIsInN0cmluZyIsIm1heCIsInRhZ3MiLCJ0YWdzQXJyYXkiLCJNYW51ZmFjdHVyZXJNb2RlbCIsInVzZXIiLCJNYW51ZmFjdHVyZXIiLCJtb2RlbCIsImRhdGEiLCJyZWxhdGVkTmFtZSIsIl9nZXRNYW55UmVsYXRlZCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQ0E7Ozs7QUFJQTs7OztBQUNBOztBQUNBOztBQUNBOzs7Ozs7Ozs7Ozs7QUFFQSxJQUFNQSxTQUFTLGlCQUFJQyxnQkFBSixHQUF1QkMsSUFBdkIsQ0FBNEI7QUFDdkNDLGNBQVUsaUJBQUlDLGNBQUosR0FBcUJDLEtBQXJCLENBQTJCLElBQTNCLENBRDZCO0FBRXZDQyxjQUFVLGlCQUFJQyxTQUFKLEVBRjZCO0FBR3ZDQyxlQUFXLGlCQUFJRCxTQUFKLEVBSDRCO0FBSXZDRSxXQUFPLGlCQUFJRixTQUFKLEVBSmdDO0FBS3ZDRyxVQUFNLGlCQUFJQyxXQUFKLEdBQWtCTixLQUFsQixDQUF3QixJQUF4QixDQUxpQztBQU12Q08sMEJBQXNCLGlCQUFJTCxTQUFKLEVBTmlCO0FBT3ZDTSxtQkFBZSxpQkFBSUMsTUFBSixHQUFhQyxPQUFiLEVBUHdCO0FBUXZDQyxtQkFBZSxpQkFBSUMsTUFBSixHQUFhQyxHQUFiLENBQWlCLEVBQWpCLENBUndCO0FBU3ZDQyxVQUFNLGlCQUFJQyxTQUFKO0FBVGlDLENBQTVCLENBQWY7O0lBWWFDLGlCLFdBQUFBLGlCOzs7QUFFVCwrQkFBWUMsSUFBWixFQUF3QjtBQUFBOztBQUFBLHFJQUNkQSxJQURjLEVBQ1IsY0FEUSxFQUNRdEIsTUFEUixFQUNnQnVCLFlBRGhCO0FBRXZCOzs7OztJQUdRQSxZLFdBQUFBLFk7OztBQUVULDBCQUFZQyxLQUFaLEVBQXNDQyxJQUF0QyxFQUF3RDtBQUFBOztBQUFBLDJIQUM5Q0QsS0FEOEMsRUFDdkNDLElBRHVDLEVBQ2pDO0FBQ2YseUJBQWE7QUFDVEQsdUJBQU8seUJBQVVBLE1BQU1GLElBQWhCLENBREU7QUFFVEksNkJBQWE7QUFGSjtBQURFLFNBRGlDO0FBT3ZEOzs7O29DQUVzQztBQUNuQyxtQkFBTyxLQUFLQyxlQUFMLENBQXFCLFdBQXJCLENBQVA7QUFDSCIsImZpbGUiOiJtYW51ZmFjdHVyZXIuanMiLCJzb3VyY2VSb290IjoiL1VzZXJzL2R0ci9nb29lZS9lY21hc2NyaXB0LXNkay9zcmMvZW50aXRpZXMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiBAZmxvdyAqL1xuaW1wb3J0IFByb21pc2UgZnJvbSAnYmx1ZWJpcmQnXG5cbmltcG9ydCB0eXBlIHsgRW50aXR5SnNvbiB9IGZyb20gJy4uL3R5cGVzJ1xuXG5pbXBvcnQgVXNlciBmcm9tICcuLi9hdXRoJ1xuaW1wb3J0IHsgRW50aXR5LCBFbnRpdHlNb2RlbCB9IGZyb20gJy4vYmFzZSdcbmltcG9ydCB7IEN1c3RvbWVycyB9IGZyb20gJy4uL2VudGl0aWVzJ1xuaW1wb3J0IEpvaSBmcm9tICcuLi9zY2hlbWEnXG5cbmNvbnN0IHNjaGVtYSA9IEpvaS5iYXNlT2JqZWN0RW50aXR5KCkua2V5cyh7XG4gICAgbG9jYXRpb246IEpvaS5sb2NhdGlvbk9iamVjdCgpLmFsbG93KG51bGwpLFxuICAgIHByb2R1Y3RzOiBKb2kudXVpZEFycmF5KCksXG4gICAgY3VzdG9tZXJzOiBKb2kudXVpZEFycmF5KCksXG4gICAgdXNlcnM6IEpvaS51dWlkQXJyYXkoKSxcbiAgICBsb2dvOiBKb2kuYmFzZTY0SW1hZ2UoKS5hbGxvdyhudWxsKSxcbiAgICBvcmdhbml6YXRpb25hbF91bml0czogSm9pLnV1aWRBcnJheSgpLFxuICAgIGRldmljZXNfdG90YWw6IEpvaS5udW1iZXIoKS5pbnRlZ2VyKCksXG4gICAgc2NvcGVfY29udGV4dDogSm9pLnN0cmluZygpLm1heCgzMiksXG4gICAgdGFnczogSm9pLnRhZ3NBcnJheSgpLFxufSlcblxuZXhwb3J0IGNsYXNzIE1hbnVmYWN0dXJlck1vZGVsIGV4dGVuZHMgRW50aXR5TW9kZWwge1xuXG4gICAgY29uc3RydWN0b3IodXNlcjogVXNlcikge1xuICAgICAgICBzdXBlcih1c2VyLCAnbWFudWZhY3R1cmVyJywgc2NoZW1hLCBNYW51ZmFjdHVyZXIpXG4gICAgfVxufVxuXG5leHBvcnQgY2xhc3MgTWFudWZhY3R1cmVyIGV4dGVuZHMgRW50aXR5IHtcblxuICAgIGNvbnN0cnVjdG9yKG1vZGVsOiBNYW51ZmFjdHVyZXJNb2RlbCwgZGF0YTogRW50aXR5SnNvbikge1xuICAgICAgICBzdXBlcihtb2RlbCwgZGF0YSwge1xuICAgICAgICAgICAgJ2N1c3RvbWVycyc6IHtcbiAgICAgICAgICAgICAgICBtb2RlbDogQ3VzdG9tZXJzKG1vZGVsLnVzZXIpLFxuICAgICAgICAgICAgICAgIHJlbGF0ZWROYW1lOiAnbWFudWZhY3R1cmVycycsXG4gICAgICAgICAgICB9LFxuICAgICAgICB9KVxuICAgIH1cblxuICAgIGN1c3RvbWVycygpOiBJdGVyYXRvcjxQcm9taXNlPEVudGl0eT4+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2dldE1hbnlSZWxhdGVkKCdjdXN0b21lcnMnKVxuICAgIH1cbn1cbiJdfQ==",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "manufacturer.js"
      ],
      "names": [
        "schema",
        "baseObjectEntity",
        "keys",
        "location",
        "locationObject",
        "allow",
        "products",
        "uuidArray",
        "customers",
        "users",
        "logo",
        "base64Image",
        "organizational_units",
        "devices_total",
        "number",
        "integer",
        "scope_context",
        "string",
        "max",
        "tags",
        "tagsArray",
        "ManufacturerModel",
        "user",
        "Manufacturer",
        "model",
        "data",
        "relatedName",
        "_getManyRelated"
      ],
      "mappings": ";;;;;;;;;AACA;;;;AAIA;;;;AACA;;AACA;;AACA;;;;;;;;;;;;AAEA,IAAMA,SAAS,iBAAIC,gBAAJ,GAAuBC,IAAvB,CAA4B;AACvCC,cAAU,iBAAIC,cAAJ,GAAqBC,KAArB,CAA2B,IAA3B,CAD6B;AAEvCC,cAAU,iBAAIC,SAAJ,EAF6B;AAGvCC,eAAW,iBAAID,SAAJ,EAH4B;AAIvCE,WAAO,iBAAIF,SAAJ,EAJgC;AAKvCG,UAAM,iBAAIC,WAAJ,GAAkBN,KAAlB,CAAwB,IAAxB,CALiC;AAMvCO,0BAAsB,iBAAIL,SAAJ,EANiB;AAOvCM,mBAAe,iBAAIC,MAAJ,GAAaC,OAAb,EAPwB;AAQvCC,mBAAe,iBAAIC,MAAJ,GAAaC,GAAb,CAAiB,EAAjB,CARwB;AASvCC,UAAM,iBAAIC,SAAJ;AATiC,CAA5B,CAAf;;IAYaC,iB,WAAAA,iB;;;AAET,+BAAYC,IAAZ,EAAwB;AAAA;;AAAA,qIACdA,IADc,EACR,cADQ,EACQtB,MADR,EACgBuB,YADhB;AAEvB;;;;;IAGQA,Y,WAAAA,Y;;;AAET,0BAAYC,KAAZ,EAAsCC,IAAtC,EAAwD;AAAA;;AAAA,2HAC9CD,KAD8C,EACvCC,IADuC,EACjC;AACf,yBAAa;AACTD,uBAAO,yBAAUA,MAAMF,IAAhB,CADE;AAETI,6BAAa;AAFJ;AADE,SADiC;AAOvD;;;;oCAEsC;AACnC,mBAAO,KAAKC,eAAL,CAAqB,WAArB,CAAP;AACH",
      "file": "manufacturer.js",
      "sourceRoot": "/Users/dtr/gooee/ecmascript-sdk/src/entities",
      "sourcesContent": [
        "/* @flow */\nimport Promise from 'bluebird'\n\nimport type { EntityJson } from '../types'\n\nimport User from '../auth'\nimport { Entity, EntityModel } from './base'\nimport { Customers } from '../entities'\nimport Joi from '../schema'\n\nconst schema = Joi.baseObjectEntity().keys({\n    location: Joi.locationObject().allow(null),\n    products: Joi.uuidArray(),\n    customers: Joi.uuidArray(),\n    users: Joi.uuidArray(),\n    logo: Joi.base64Image().allow(null),\n    organizational_units: Joi.uuidArray(),\n    devices_total: Joi.number().integer(),\n    scope_context: Joi.string().max(32),\n    tags: Joi.tagsArray(),\n})\n\nexport class ManufacturerModel extends EntityModel {\n\n    constructor(user: User) {\n        super(user, 'manufacturer', schema, Manufacturer)\n    }\n}\n\nexport class Manufacturer extends Entity {\n\n    constructor(model: ManufacturerModel, data: EntityJson) {\n        super(model, data, {\n            'customers': {\n                model: Customers(model.user),\n                relatedName: 'manufacturers',\n            },\n        })\n    }\n\n    customers(): Iterator<Promise<Entity>> {\n        return this._getManyRelated('customers')\n    }\n}\n"
      ]
    },
    "mtime": 1476973950000
  },
  "{\"filename\":\"/Users/dtr/gooee/ecmascript-sdk/src/entities/space.js\",\"env\":{},\"retainLines\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"presets\":[],\"plugins\":[[[],null],[[],null],[[],null],[[],{\"loose\":false,\"spec\":false}],[[],null],[[],null],[[],{\"spec\":false}],[[],null],[[],{\"loose\":false}],[[],null],[[],null],[[],null],[[],{\"loose\":false}],[[],{\"loose\":false}],[[],null],[[],null],[[],null],[[],{\"loose\":false}],[[],null],[[],{\"loose\":false}],[[],null],[[],null],[[],{\"loose\":false}],[[],{\"async\":false,\"asyncGenerators\":false}]],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"minified\":false,\"sourceRoot\":\"/Users/dtr/gooee/ecmascript-sdk/src/entities\",\"babelrc\":true,\"sourceType\":\"module\",\"moduleIds\":false,\"passPerPreset\":false,\"parserOpts\":false,\"generatorOpts\":false}:6.17.0": {
    "metadata": {
      "usedHelpers": [
        "inherits",
        "possibleConstructorReturn",
        "classCallCheck",
        "interopRequireDefault"
      ],
      "marked": [],
      "modules": {
        "imports": [
          {
            "source": "../types",
            "imported": [
              "EntityJson"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "EntityJson",
                "local": "EntityJson"
              }
            ]
          },
          {
            "source": "./base",
            "imported": [
              "Entity",
              "EntityModel"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "Entity",
                "local": "Entity"
              },
              {
                "kind": "named",
                "imported": "EntityModel",
                "local": "EntityModel"
              }
            ]
          },
          {
            "source": "../entities",
            "imported": [
              "Buildings"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "Buildings",
                "local": "Buildings"
              }
            ]
          },
          {
            "source": "../auth",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "User"
              }
            ]
          },
          {
            "source": "../schema",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "Joi"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "SpaceModel",
            "Space"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "SpaceModel",
              "exported": "SpaceModel"
            },
            {
              "kind": "local",
              "local": "Space",
              "exported": "Space"
            }
          ]
        }
      }
    },
    "options": {
      "filename": "/Users/dtr/gooee/ecmascript-sdk/src/entities/space.js",
      "filenameRelative": "/Users/dtr/gooee/ecmascript-sdk/src/entities/space.js",
      "env": {},
      "retainLines": false,
      "highlightCode": true,
      "suppressDeprecationMessages": false,
      "presets": [],
      "plugins": [
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false,
            "spec": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "spec": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          {
            "async": false,
            "asyncGenerators": false
          }
        ]
      ],
      "ignore": [],
      "code": true,
      "metadata": true,
      "ast": false,
      "comments": true,
      "compact": "auto",
      "minified": false,
      "sourceMaps": "both",
      "sourceMapTarget": "space.js",
      "sourceFileName": "space.js",
      "sourceRoot": "/Users/dtr/gooee/ecmascript-sdk/src/entities",
      "babelrc": false,
      "sourceType": "module",
      "moduleRoot": "/Users/dtr/gooee/ecmascript-sdk/src/entities",
      "moduleIds": false,
      "passPerPreset": false,
      "parserOpts": false,
      "generatorOpts": false,
      "basename": "space"
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.Space = exports.SpaceModel = undefined;\n\nvar _base = require('./base');\n\nvar _entities = require('../entities');\n\nvar _auth = require('../auth');\n\nvar _auth2 = _interopRequireDefault(_auth);\n\nvar _schema = require('../schema');\n\nvar _schema2 = _interopRequireDefault(_schema);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar schema = _schema2.default.logicalEntity().keys({\n    type: _schema2.default.string().only('floor', 'room', 'virtual').required(),\n    building: _schema2.default.string().uuid().allow(null).empty(null),\n    parent_space: _schema2.default.string().uuid().allow(null).empty(null),\n    child_spaces: _schema2.default.uuidArray(),\n    connected_products: _schema2.default.uuidArray(),\n    devices: _schema2.default.uuidArray(),\n    euid: _schema2.default.string().max(128),\n    service_profile: _schema2.default.string().uuid().allow(null),\n    last_activity: _schema2.default.string().allow(null),\n    meta: _schema2.default.array().items(_schema2.default.baseMeta()),\n    bg_image: _schema2.default.base64Image().allow(null),\n    scenes: _schema2.default.uuidArray()\n}).xor('building', 'parent_space');\n\nvar SpaceModel = exports.SpaceModel = function (_EntityModel) {\n    _inherits(SpaceModel, _EntityModel);\n\n    function SpaceModel(user) {\n        _classCallCheck(this, SpaceModel);\n\n        return _possibleConstructorReturn(this, (SpaceModel.__proto__ || Object.getPrototypeOf(SpaceModel)).call(this, user, 'space', schema, Space));\n    }\n\n    return SpaceModel;\n}(_base.EntityModel);\n\nvar Space = exports.Space = function (_Entity) {\n    _inherits(Space, _Entity);\n\n    function Space(model, data) {\n        _classCallCheck(this, Space);\n\n        return _possibleConstructorReturn(this, (Space.__proto__ || Object.getPrototypeOf(Space)).call(this, model, data, {\n            'building': {\n                model: (0, _entities.Buildings)(model.user)\n            },\n            'parent_space': {\n                model: new SpaceModel(model.user)\n            },\n            'child_spaces': {\n                model: new SpaceModel(model.user),\n                relatedName: 'parent_space'\n            }\n        }));\n    }\n\n    return Space;\n}(_base.Entity);\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNwYWNlLmpzIl0sIm5hbWVzIjpbInNjaGVtYSIsImxvZ2ljYWxFbnRpdHkiLCJrZXlzIiwidHlwZSIsInN0cmluZyIsIm9ubHkiLCJyZXF1aXJlZCIsImJ1aWxkaW5nIiwidXVpZCIsImFsbG93IiwiZW1wdHkiLCJwYXJlbnRfc3BhY2UiLCJjaGlsZF9zcGFjZXMiLCJ1dWlkQXJyYXkiLCJjb25uZWN0ZWRfcHJvZHVjdHMiLCJkZXZpY2VzIiwiZXVpZCIsIm1heCIsInNlcnZpY2VfcHJvZmlsZSIsImxhc3RfYWN0aXZpdHkiLCJtZXRhIiwiYXJyYXkiLCJpdGVtcyIsImJhc2VNZXRhIiwiYmdfaW1hZ2UiLCJiYXNlNjRJbWFnZSIsInNjZW5lcyIsInhvciIsIlNwYWNlTW9kZWwiLCJ1c2VyIiwiU3BhY2UiLCJtb2RlbCIsImRhdGEiLCJyZWxhdGVkTmFtZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUdBOztBQUNBOztBQUNBOzs7O0FBQ0E7Ozs7Ozs7Ozs7OztBQUVBLElBQU1BLFNBQVMsaUJBQUlDLGFBQUosR0FBb0JDLElBQXBCLENBQXlCO0FBQ3BDQyxVQUFNLGlCQUFJQyxNQUFKLEdBQWFDLElBQWIsQ0FBa0IsT0FBbEIsRUFBMkIsTUFBM0IsRUFBbUMsU0FBbkMsRUFBOENDLFFBQTlDLEVBRDhCO0FBRXBDQyxjQUFVLGlCQUFJSCxNQUFKLEdBQWFJLElBQWIsR0FBb0JDLEtBQXBCLENBQTBCLElBQTFCLEVBQWdDQyxLQUFoQyxDQUFzQyxJQUF0QyxDQUYwQjtBQUdwQ0Msa0JBQWMsaUJBQUlQLE1BQUosR0FBYUksSUFBYixHQUFvQkMsS0FBcEIsQ0FBMEIsSUFBMUIsRUFBZ0NDLEtBQWhDLENBQXNDLElBQXRDLENBSHNCO0FBSXBDRSxrQkFBYyxpQkFBSUMsU0FBSixFQUpzQjtBQUtwQ0Msd0JBQW9CLGlCQUFJRCxTQUFKLEVBTGdCO0FBTXBDRSxhQUFTLGlCQUFJRixTQUFKLEVBTjJCO0FBT3BDRyxVQUFNLGlCQUFJWixNQUFKLEdBQWFhLEdBQWIsQ0FBaUIsR0FBakIsQ0FQOEI7QUFRcENDLHFCQUFpQixpQkFBSWQsTUFBSixHQUFhSSxJQUFiLEdBQW9CQyxLQUFwQixDQUEwQixJQUExQixDQVJtQjtBQVNwQ1UsbUJBQWUsaUJBQUlmLE1BQUosR0FBYUssS0FBYixDQUFtQixJQUFuQixDQVRxQjtBQVVwQ1csVUFBTSxpQkFBSUMsS0FBSixHQUFZQyxLQUFaLENBQWtCLGlCQUFJQyxRQUFKLEVBQWxCLENBVjhCO0FBV3BDQyxjQUFVLGlCQUFJQyxXQUFKLEdBQWtCaEIsS0FBbEIsQ0FBd0IsSUFBeEIsQ0FYMEI7QUFZcENpQixZQUFRLGlCQUFJYixTQUFKO0FBWjRCLENBQXpCLEVBYVpjLEdBYlksQ0FhUixVQWJRLEVBYUksY0FiSixDQUFmOztJQWVhQyxVLFdBQUFBLFU7OztBQUVULHdCQUFZQyxJQUFaLEVBQXdCO0FBQUE7O0FBQUEsdUhBQ2RBLElBRGMsRUFDUixPQURRLEVBQ0M3QixNQURELEVBQ1M4QixLQURUO0FBRXZCOzs7OztJQUdRQSxLLFdBQUFBLEs7OztBQUVULG1CQUFZQyxLQUFaLEVBQStCQyxJQUEvQixFQUFpRDtBQUFBOztBQUFBLDZHQUN2Q0QsS0FEdUMsRUFDaENDLElBRGdDLEVBQzFCO0FBQ2Ysd0JBQVk7QUFDUkQsdUJBQU8seUJBQVVBLE1BQU1GLElBQWhCO0FBREMsYUFERztBQUlmLDRCQUFnQjtBQUNaRSx1QkFBTyxJQUFJSCxVQUFKLENBQWVHLE1BQU1GLElBQXJCO0FBREssYUFKRDtBQU9mLDRCQUFnQjtBQUNaRSx1QkFBTyxJQUFJSCxVQUFKLENBQWVHLE1BQU1GLElBQXJCLENBREs7QUFFWkksNkJBQWE7QUFGRDtBQVBELFNBRDBCO0FBYWhEIiwiZmlsZSI6InNwYWNlLmpzIiwic291cmNlUm9vdCI6Ii9Vc2Vycy9kdHIvZ29vZWUvZWNtYXNjcmlwdC1zZGsvc3JjL2VudGl0aWVzIiwic291cmNlc0NvbnRlbnQiOlsiLyogQGZsb3cgKi9cbmltcG9ydCB0eXBlIHsgRW50aXR5SnNvbiB9IGZyb20gJy4uL3R5cGVzJ1xuXG5pbXBvcnQgeyBFbnRpdHksIEVudGl0eU1vZGVsIH0gZnJvbSAnLi9iYXNlJ1xuaW1wb3J0IHsgQnVpbGRpbmdzIH0gZnJvbSAnLi4vZW50aXRpZXMnXG5pbXBvcnQgVXNlciBmcm9tICcuLi9hdXRoJ1xuaW1wb3J0IEpvaSBmcm9tICcuLi9zY2hlbWEnXG5cbmNvbnN0IHNjaGVtYSA9IEpvaS5sb2dpY2FsRW50aXR5KCkua2V5cyh7XG4gICAgdHlwZTogSm9pLnN0cmluZygpLm9ubHkoJ2Zsb29yJywgJ3Jvb20nLCAndmlydHVhbCcpLnJlcXVpcmVkKCksXG4gICAgYnVpbGRpbmc6IEpvaS5zdHJpbmcoKS51dWlkKCkuYWxsb3cobnVsbCkuZW1wdHkobnVsbCksXG4gICAgcGFyZW50X3NwYWNlOiBKb2kuc3RyaW5nKCkudXVpZCgpLmFsbG93KG51bGwpLmVtcHR5KG51bGwpLFxuICAgIGNoaWxkX3NwYWNlczogSm9pLnV1aWRBcnJheSgpLFxuICAgIGNvbm5lY3RlZF9wcm9kdWN0czogSm9pLnV1aWRBcnJheSgpLFxuICAgIGRldmljZXM6IEpvaS51dWlkQXJyYXkoKSxcbiAgICBldWlkOiBKb2kuc3RyaW5nKCkubWF4KDEyOCksXG4gICAgc2VydmljZV9wcm9maWxlOiBKb2kuc3RyaW5nKCkudXVpZCgpLmFsbG93KG51bGwpLFxuICAgIGxhc3RfYWN0aXZpdHk6IEpvaS5zdHJpbmcoKS5hbGxvdyhudWxsKSxcbiAgICBtZXRhOiBKb2kuYXJyYXkoKS5pdGVtcyhKb2kuYmFzZU1ldGEoKSksXG4gICAgYmdfaW1hZ2U6IEpvaS5iYXNlNjRJbWFnZSgpLmFsbG93KG51bGwpLFxuICAgIHNjZW5lczogSm9pLnV1aWRBcnJheSgpLFxufSkueG9yKCdidWlsZGluZycsICdwYXJlbnRfc3BhY2UnKVxuXG5leHBvcnQgY2xhc3MgU3BhY2VNb2RlbCBleHRlbmRzIEVudGl0eU1vZGVsIHtcblxuICAgIGNvbnN0cnVjdG9yKHVzZXI6IFVzZXIpIHtcbiAgICAgICAgc3VwZXIodXNlciwgJ3NwYWNlJywgc2NoZW1hLCBTcGFjZSlcbiAgICB9XG59XG5cbmV4cG9ydCBjbGFzcyBTcGFjZSBleHRlbmRzIEVudGl0eSB7XG5cbiAgICBjb25zdHJ1Y3Rvcihtb2RlbDogU3BhY2VNb2RlbCwgZGF0YTogRW50aXR5SnNvbikge1xuICAgICAgICBzdXBlcihtb2RlbCwgZGF0YSwge1xuICAgICAgICAgICAgJ2J1aWxkaW5nJzoge1xuICAgICAgICAgICAgICAgIG1vZGVsOiBCdWlsZGluZ3MobW9kZWwudXNlciksXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgJ3BhcmVudF9zcGFjZSc6IHtcbiAgICAgICAgICAgICAgICBtb2RlbDogbmV3IFNwYWNlTW9kZWwobW9kZWwudXNlciksXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgJ2NoaWxkX3NwYWNlcyc6IHtcbiAgICAgICAgICAgICAgICBtb2RlbDogbmV3IFNwYWNlTW9kZWwobW9kZWwudXNlciksXG4gICAgICAgICAgICAgICAgcmVsYXRlZE5hbWU6ICdwYXJlbnRfc3BhY2UnLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgfSlcbiAgICB9XG59XG4iXX0=",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "space.js"
      ],
      "names": [
        "schema",
        "logicalEntity",
        "keys",
        "type",
        "string",
        "only",
        "required",
        "building",
        "uuid",
        "allow",
        "empty",
        "parent_space",
        "child_spaces",
        "uuidArray",
        "connected_products",
        "devices",
        "euid",
        "max",
        "service_profile",
        "last_activity",
        "meta",
        "array",
        "items",
        "baseMeta",
        "bg_image",
        "base64Image",
        "scenes",
        "xor",
        "SpaceModel",
        "user",
        "Space",
        "model",
        "data",
        "relatedName"
      ],
      "mappings": ";;;;;;;AAGA;;AACA;;AACA;;;;AACA;;;;;;;;;;;;AAEA,IAAMA,SAAS,iBAAIC,aAAJ,GAAoBC,IAApB,CAAyB;AACpCC,UAAM,iBAAIC,MAAJ,GAAaC,IAAb,CAAkB,OAAlB,EAA2B,MAA3B,EAAmC,SAAnC,EAA8CC,QAA9C,EAD8B;AAEpCC,cAAU,iBAAIH,MAAJ,GAAaI,IAAb,GAAoBC,KAApB,CAA0B,IAA1B,EAAgCC,KAAhC,CAAsC,IAAtC,CAF0B;AAGpCC,kBAAc,iBAAIP,MAAJ,GAAaI,IAAb,GAAoBC,KAApB,CAA0B,IAA1B,EAAgCC,KAAhC,CAAsC,IAAtC,CAHsB;AAIpCE,kBAAc,iBAAIC,SAAJ,EAJsB;AAKpCC,wBAAoB,iBAAID,SAAJ,EALgB;AAMpCE,aAAS,iBAAIF,SAAJ,EAN2B;AAOpCG,UAAM,iBAAIZ,MAAJ,GAAaa,GAAb,CAAiB,GAAjB,CAP8B;AAQpCC,qBAAiB,iBAAId,MAAJ,GAAaI,IAAb,GAAoBC,KAApB,CAA0B,IAA1B,CARmB;AASpCU,mBAAe,iBAAIf,MAAJ,GAAaK,KAAb,CAAmB,IAAnB,CATqB;AAUpCW,UAAM,iBAAIC,KAAJ,GAAYC,KAAZ,CAAkB,iBAAIC,QAAJ,EAAlB,CAV8B;AAWpCC,cAAU,iBAAIC,WAAJ,GAAkBhB,KAAlB,CAAwB,IAAxB,CAX0B;AAYpCiB,YAAQ,iBAAIb,SAAJ;AAZ4B,CAAzB,EAaZc,GAbY,CAaR,UAbQ,EAaI,cAbJ,CAAf;;IAeaC,U,WAAAA,U;;;AAET,wBAAYC,IAAZ,EAAwB;AAAA;;AAAA,uHACdA,IADc,EACR,OADQ,EACC7B,MADD,EACS8B,KADT;AAEvB;;;;;IAGQA,K,WAAAA,K;;;AAET,mBAAYC,KAAZ,EAA+BC,IAA/B,EAAiD;AAAA;;AAAA,6GACvCD,KADuC,EAChCC,IADgC,EAC1B;AACf,wBAAY;AACRD,uBAAO,yBAAUA,MAAMF,IAAhB;AADC,aADG;AAIf,4BAAgB;AACZE,uBAAO,IAAIH,UAAJ,CAAeG,MAAMF,IAArB;AADK,aAJD;AAOf,4BAAgB;AACZE,uBAAO,IAAIH,UAAJ,CAAeG,MAAMF,IAArB,CADK;AAEZI,6BAAa;AAFD;AAPD,SAD0B;AAahD",
      "file": "space.js",
      "sourceRoot": "/Users/dtr/gooee/ecmascript-sdk/src/entities",
      "sourcesContent": [
        "/* @flow */\nimport type { EntityJson } from '../types'\n\nimport { Entity, EntityModel } from './base'\nimport { Buildings } from '../entities'\nimport User from '../auth'\nimport Joi from '../schema'\n\nconst schema = Joi.logicalEntity().keys({\n    type: Joi.string().only('floor', 'room', 'virtual').required(),\n    building: Joi.string().uuid().allow(null).empty(null),\n    parent_space: Joi.string().uuid().allow(null).empty(null),\n    child_spaces: Joi.uuidArray(),\n    connected_products: Joi.uuidArray(),\n    devices: Joi.uuidArray(),\n    euid: Joi.string().max(128),\n    service_profile: Joi.string().uuid().allow(null),\n    last_activity: Joi.string().allow(null),\n    meta: Joi.array().items(Joi.baseMeta()),\n    bg_image: Joi.base64Image().allow(null),\n    scenes: Joi.uuidArray(),\n}).xor('building', 'parent_space')\n\nexport class SpaceModel extends EntityModel {\n\n    constructor(user: User) {\n        super(user, 'space', schema, Space)\n    }\n}\n\nexport class Space extends Entity {\n\n    constructor(model: SpaceModel, data: EntityJson) {\n        super(model, data, {\n            'building': {\n                model: Buildings(model.user),\n            },\n            'parent_space': {\n                model: new SpaceModel(model.user),\n            },\n            'child_spaces': {\n                model: new SpaceModel(model.user),\n                relatedName: 'parent_space',\n            },\n        })\n    }\n}\n"
      ]
    },
    "mtime": 1476974425000
  }
}